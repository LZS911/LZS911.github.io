{"pageProps":{"post":{"title":"OSS服务","date":"2024-02-23","slug":"对象存储OSS","author":"Ai.Haibara","content":"<h2 id=\"什么是-oss\"><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#什么是-oss\"><span class=\"icon icon-link\"></span></a>什么是 OSS？</h2>\n<p><a href=\"https://help.aliyun.com/zh/oss/product-overview/what-is-oss\">阿里云 OSS 介绍</a></p>\n<h2 id=\"如何自己搭建一个-oss-服务\"><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#如何自己搭建一个-oss-服务\"><span class=\"icon icon-link\"></span></a>如何自己搭建一个 OSS 服务？</h2>\n<h3 id=\"minio\"><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#minio\"><span class=\"icon icon-link\"></span></a>MinIO</h3>\n<p><a href=\"https://zhuanlan.zhihu.com/p/103803549\">开源分布式对象存储-MinIO</a></p>\n<h3 id=\"使用-docker-部署-oss-服务\"><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#使用-docker-部署-oss-服务\"><span class=\"icon icon-link\"></span></a>使用 Docker 部署 OSS 服务</h3>\n<ol>\n<li>\n<p>先确定需要使用的 docker 镜像：<a href=\"https://hub.docker.com/r/bitnami/minio\">bitnami/minio</a></p>\n</li>\n<li>\n<p>编写 <code>docker-compose.yaml</code> 文件</p>\n<pre><code class=\"language-yaml\">version: \"2.4\"\n\nservices:\n  minio:\n    restart: always\n    image: \"bitnami/minio:latest\"\n    ports:\n        - \"9000:9000\"\n        - \"9001:9001\"\n    environment:\n        - TZ=Asia/Shanghai\n        - MINIO_ROOT_USER=liyu\n        - MINIO_ROOT_PASSWORD=liyu@911.com\n        - MINIO_PUBLIC_ADDRESS=http://47.115.219.196:9001/\n    container_name: liyu_minio\n    volumes:\n        - minio_data:/bitnami/minio/data\n\nvolumes:\n  minio_data:\n    driver: local\n</code></pre>\n</li>\n<li>\n<p>启动容器：<code>docker-compose -f docker-compose.yaml up --build -d --remove-orphans</code></p>\n</li>\n</ol>\n<h3 id=\"管理界面操作\"><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#管理界面操作\"><span class=\"icon icon-link\"></span></a>管理界面操作</h3>\n<h3 id=\"使用-sdk-操作\"><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#使用-sdk-操作\"><span class=\"icon icon-link\"></span></a>使用 sdk 操作</h3>\n<pre><code class=\"language-js\">const Minio = require('minio');\nconst fs = require('fs');\n\nconst minioClient = new Minio.Client({\n  endPoint: '47.115.219.196',\n  port: 9000,\n  useSSL: false,\n  accessKey: 'zgJ83Buz1v9Q7s060fTS',\n  secretKey: 'duysuG1vlfco6ozl8BtMkdY9Q3zm6fxDB02pRijT',\n});\n\nfunction put() {\n  minioClient.fPutObject(\n    'liyu-test',\n    'Union-put.svg',\n    './Union-get.svg',\n    function (err, etag) {\n      if (err) return console.log(err);\n      console.log('上传成功');\n    }\n  );\n}\n\nfunction get() {\n  minioClient.getObject('liyu-test', 'Union.svg', (err, stream) => {\n    if (err) return console.log(err);\n    stream.pipe(fs.createWriteStream('./Union-get.svg'));\n  });\n}\n\nfunction main() {\n  // get();\n\n  put();\n}\n\nmain();\n</code></pre>","theme":"fancy","tag":[null]}},"__N_SSG":true}