(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[502],{907:(e,t,a)=>{Promise.resolve().then(a.bind(a,1594))},1594:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>v});var r=a(5155),n=a(8923),l=a(2115),s=a(7660),o=a(9509),c=a(9641).Buffer;let i=new s.E({auth:o.env.NEXT_PUBLIC_GITHUB_TOKEN}),u=o.env.NEXT_PUBLIC_GITHUB_OWNER||"LZS911",d=o.env.NEXT_PUBLIC_REPO_NAME||"LZS911.github.io";async function g(e){let{title:t,content:a,path:r}=e;try{let{data:e}=await i.git.getRef({owner:u,repo:d,ref:"heads/main"}),n="algorithm-post-".concat(Date.now());await i.git.createRef({owner:u,repo:d,ref:"refs/heads/".concat(n),sha:e.object.sha}),await i.repos.createOrUpdateFileContents({owner:u,repo:d,path:r,message:"feat: ".concat(t),content:c.from(a).toString("base64"),branch:n});let{data:l}=await i.pulls.create({owner:u,repo:d,title:t,head:n,base:"main",body:"auto create pr"});return{url:l.html_url}}catch(e){throw console.error("创建 PR 失败:",e),Error("创建 PR 失败")}}var h=a(1928);let f=["arknights","awesome-green","channing-cyan","Chinese-red","condensed-night-purple","cyanosis","devui-blue","fancy","geek-black","github","greenwillow","healer-readable","hydrogen","juejin","jzman","mk-cute","nico","orange","qklhk-chocolate","scrolls-light","simplicity-green","smartblue","v-green","vue-pro","vuepress"];var m=a(3319);let b=(e,t,a,r)=>"---\ntitle: ".concat(e,"\nlayout: post\ndate: ").concat((0,m.GP)(new Date,"yyyy-MM-dd"),"\nimage:\nheaderImage: false\nstar: true\ncategory: ").concat(r,"\nauthor: LZS_911\ndescription: ").concat(r,"\nexcerpt: ''\ntheme: ").concat(a,"  \n---\n\n").concat(t,"\n");var p=a(9345),x=a.n(p);let y=["talk","project","blog"];function v(){let[e,t]=(0,l.useState)(""),[a,s]=(0,l.useState)(""),[o,c]=(0,l.useState)(y[0]),[i,u]=(0,l.useState)(f[0]),[d,m]=(0,l.useState)(!1),[p,v]=(0,l.useState)(null),[w,N]=(0,l.useState)(!1),j=(0,l.useRef)({title:"",content:"",theme:"",category:y[0]});(0,l.useEffect)(()=>{let e=localStorage.getItem("blog_draft");if(e)try{let{title:a,content:r,category:n,theme:l,lastSaved:o}=JSON.parse(x().decompressFromUTF16(e)||"{}");s(a||""),t(r||""),c(n||y[0]),u(l||f[0]),j.current={title:a||"",content:r||"",theme:l||f[0],category:n||y[0]},v(new Date(o))}catch(e){console.error("Failed to load draft:",e)}},[]),(0,l.useEffect)(()=>{let t=setInterval(()=>{N(!0);let t={title:a,content:e,category:o,lastSaved:new Date().toISOString(),theme:i},r=x().compressToUTF16(JSON.stringify(t));localStorage.setItem("blog_draft",r),j.current={title:a,content:e,category:o,theme:i},v(new Date(t.lastSaved)),N(!1)},3e4);return()=>{clearInterval(t)}},[a,e,o,i]),(0,l.useEffect)(()=>{let t=t=>{let r=j.current.title!==a||j.current.content!==e||j.current.category!==o||j.current.theme!==i;if(w||r)return t.preventDefault(),t.returnValue="您有未保存的更改，确定要离开吗？",t.returnValue};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}},[o,e,w,i,a]);let k=async()=>{if(!e||!a)return void alert("标题和内容不能为空");m(!0);try{let r="_posts/".concat(a,".md"),n=await g({title:a,content:b(a,e,i,o),path:r});(null==n?void 0:n.url)&&(alert("提交成功！PR链接："+n.url),localStorage.removeItem("blog_draft"),t(""),s(""),v(null),window.open(n.url,"_blank"))}catch(e){alert("提交失败："+e.message)}finally{m(!1)}};return(0,r.jsxs)("div",{className:"flex flex-col w-full min-h-screen",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-6 py-2 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 sticky top-0 z-10",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[(0,r.jsx)("input",{type:"text",value:a,onChange:e=>s(e.target.value),placeholder:"请输入文章标题",className:"text-2xl font-bold px-4 py-2 w-1/3 border-none focus:outline-none focus:ring-0 dark:bg-gray-800 dark:text-white placeholder-gray-400"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("select",{value:o,onChange:e=>c(e.target.value),className:"px-3 py-1.5 text-sm border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white bg-transparent",children:y.map(e=>(0,r.jsx)("option",{value:e,children:e},e))}),(0,r.jsx)("select",{value:i,onChange:e=>u(e.target.value),className:"px-3 py-1.5 text-sm border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white bg-transparent",children:f.map(e=>(0,r.jsx)("option",{value:e,children:e},e))})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(h.A,{name:"Ai.Haibara",picture:"/assets/blog/authors/haibara_2.jpg",height:40,width:40}),(0,r.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:w?"自动保存中...":p?"上次保存: ".concat(p.toLocaleTimeString()):"尚未保存"}),(0,r.jsx)("button",{onClick:k,disabled:d,className:"px-4 py-2 bg-blue-500 text-white text-sm rounded-full hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:d?"提交中...":"发布文章"})]})]}),(0,r.jsx)("div",{className:"flex-1 w-full",children:(0,r.jsx)(n.Ay,{value:e,onChange:e=>t(e||""),height:window.innerHeight-76,preview:"edit",className:"editor-fullscreen h-full",hideToolbar:!1,textareaProps:{placeholder:"请输入文章内容..."}})})]})}},1928:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var r=a(5155),n=a(6766);let l=e=>{let{name:t,picture:a,showName:l,...s}=e;return(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(n.default,{src:a,className:" rounded-full",alt:t,...s}),l?(0,r.jsx)("div",{className:"text-xl font-bold",children:t}):null]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[827,766,62,598,441,684,358],()=>t(907)),_N_E=e.O()}]);