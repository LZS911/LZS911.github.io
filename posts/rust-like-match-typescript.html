<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#000000"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><meta property="og:image" content="https://og-image.vercel.app/Next.js%20Blog%20Starter%20Example.png?theme=light&amp;md=1&amp;fontSize=100px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg"/><title>rust-like-match | Ai.Haibara codes</title><meta name="next-head-count" content="14"/><link rel="preload" href="/_next/static/css/a5eda337cc81d9ab.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a5eda337cc81d9ab.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee7e63bc15b31913.js" defer=""></script><script src="/_next/static/chunks/framework-3b5a00d5d7e8d93b.js" defer=""></script><script src="/_next/static/chunks/main-59a90320855f5cf5.js" defer=""></script><script src="/_next/static/chunks/pages/_app-91d7f786791773ad.js" defer=""></script><script src="/_next/static/chunks/799-575b46febca3af7d.js" defer=""></script><script src="/_next/static/chunks/642-f55f53346f993b53.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-8e1a2fba1f5daa00.js" defer=""></script><script src="/_next/static/YweoWqZUfFtvB-M1jJ2CU/_buildManifest.js" defer=""></script><script src="/_next/static/YweoWqZUfFtvB-M1jJ2CU/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen"><header class="text-white bg-black drop-shadow-2xl"><div class="mx-auto my-0 max-w-[960px] py-6 px-4 flex items-center"><div class="flex items-center"><img alt="Ai.Haibara" src="/assets/blog/authors/haibara_2.jpg" width="100" height="100" decoding="async" data-nimg="1" class=" rounded-full" loading="lazy" style="color:transparent"/></div><div class="ml-6"><a class=" font-bold text-3xl" href="/">Ai.Haibara codes</a><div class="mt-2"><a class="p-1 rounded-sm text-xl mr-2 hover:border-b-2 border-indigo" href="/">Home</a><a class="p-1 rounded-sm text-xl mr-2 hover:border-b-2 border-indigo" href="/projects">Projects</a><a class="p-1 rounded-sm text-xl mr-2 hover:border-b-2 border-indigo" href="/talks">Talks</a><a class="p-1 rounded-sm text-xl mr-2 hover:border-b-2 border-indigo" href="/blogs">Blogs</a></div></div></div></header><main class="p-6 flex justify-center"><article><div class="flex justify-center font-[Arial] max-w-[864px] text-center"><h1 class="text-5xl font-bold bg-indigo px-5 py-2 rounded-sm text-shadow-lg leading-[1.1]">rust-like-match</h1></div><time dateTime="2023-02-24" class="text-center block my-4 text-sm opacity-60">February	24, 2023</time><section><div class="markdown-body-jzman max-w-3xl"><h2 id="简介"><a aria-hidden="true" tabindex="-1" href="#简介"><span class="icon icon-link"></span></a>简介</h2>
<p><code>rust-like-match</code> 提供了在 javascript 或 typescript 中使用 <code>Rust-Like</code> 的模式匹配. 并且在 typescript 环境下, <code>rust-like-match</code> 能够利用类型校验来实现 rust 中 <code>match</code> 的穷尽匹配以及提供优秀的类型提示.</p>
<h2 id="什么是-rust-like-的模式匹配"><a aria-hidden="true" tabindex="-1" href="#什么是-rust-like-的模式匹配"><span class="icon icon-link"></span></a>什么是 <code>Rust-Like</code> 的模式匹配?</h2>
<p>在说到模式匹配之前, 我们先来看下 rust 中的枚举功能.</p>
<pre><code class="hljs language-rust"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Message</span> {
    Quit,
    Move { x: <span class="hljs-type">i32</span>, y: <span class="hljs-type">i32</span> },
    <span class="hljs-title function_ invoke__">Write</span>(<span class="hljs-type">String</span>),
    <span class="hljs-title function_ invoke__">ChangeColor</span>(<span class="hljs-type">i32</span>, <span class="hljs-type">i32</span>, <span class="hljs-type">i32</span>),
}
</code></pre>
<p>这里定义了一个名为 <code>Message</code> 的枚举类型, 包含了四个成员. 成员后的 <code>{}</code> 或者 <code>()</code> 代表着可以将什么类型的数据附加到该枚举成员上.</p>
<p>初始化枚举成员:</p>
<pre><code class="hljs language-rust"> <span class="hljs-keyword">let</span> <span class="hljs-variable">msg1</span> = Message::Quit;
 <span class="hljs-keyword">let</span> <span class="hljs-variable">msg2</span> = Message::Move { x: <span class="hljs-number">10</span>, y: <span class="hljs-number">20</span> };
 <span class="hljs-keyword">let</span> <span class="hljs-variable">msg3</span> = Message::<span class="hljs-title function_ invoke__">Write</span>(<span class="hljs-string">"hello rust"</span>.<span class="hljs-title function_ invoke__">to_string</span>());
 <span class="hljs-keyword">let</span> <span class="hljs-variable">mgs3</span> = Message::<span class="hljs-title function_ invoke__">ChangeColor</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>);
</code></pre>
<p>接下来回到主题, 来看下 rust 中的 <code>match</code> 关键字.</p>
<pre><code class="hljs language-rust"> <span class="hljs-keyword">match</span> msg1 {
   Message::Quit => <span class="hljs-title function_ invoke__">quit</span>(),
   Message::Move { x, y } => <span class="hljs-title function_ invoke__">move_item</span>(x, y),
   Message::<span class="hljs-title function_ invoke__">Write</span>(msg) => <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, msg),
   Message::<span class="hljs-title function_ invoke__">ChangeColor</span>(r, g, b) => <span class="hljs-title function_ invoke__">change_color</span>(r, g, b),
 }
</code></pre>
<p><code>match</code> 关键字后跟一个表达式, 在这个栗子中是变量 <code>msg1</code> 的值. 接下来是一对大括号, 里面包含了 <code>match</code> 的分支. 一个分支由两部分组成: 一个模式和一些代码. 第一个分支的模式是枚举成员 <code>Message::Quit</code>, 之后的 <code>=></code> 运算符将模式和需要执行的代码分开, 这里的代码是执行函数 <code>quit</code>. 同时, 在匹配上附加了额外数据的枚举成员时, 可以将其作为参数传递给后续需要执行的代码. 这里的代码结构有点类型 javascript 中的箭头函数.</p>
<p><code>match</code> 也支持通配模式:</p>
<pre><code class="hljs language-rust"> <span class="hljs-keyword">match</span> msg1 {
   Message::Quit => <span class="hljs-title function_ invoke__">quit</span>(),
   _ => <span class="hljs-title function_ invoke__">other</span>()
 }
</code></pre>
<p>上述代码中当匹配上 <code>Message::Quit</code> 之外的成员时, 都将执行 <code>other</code> 函数, 其中 <code>_</code> 为 rust 特定的占位符.</p>
<h2 id="typescript-中的模式匹配"><a aria-hidden="true" tabindex="-1" href="#typescript-中的模式匹配"><span class="icon icon-link"></span></a>Typescript 中的模式匹配</h2>
<p>接下来我们使用 <code>switch</code> 来模仿下 <code>match</code>:</p>
<pre><code class="hljs language-typescript">
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Message</span> =
  | {
      <span class="hljs-attr">key</span>: <span class="hljs-string">'Quit'</span>;
    }
  | { <span class="hljs-attr">key</span>: <span class="hljs-string">'Move'</span>; <span class="hljs-attr">value</span>: { <span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>; <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span> } }
  | { <span class="hljs-attr">key</span>: <span class="hljs-string">'Write'</span>; <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> }
  | { <span class="hljs-attr">key</span>: <span class="hljs-string">'ChangeColor'</span>; <span class="hljs-attr">r</span>: <span class="hljs-built_in">number</span>; <span class="hljs-attr">g</span>: <span class="hljs-built_in">number</span>; <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span> };



<span class="hljs-keyword">let</span> msg!: <span class="hljs-title class_">Message</span>;

<span class="hljs-keyword">switch</span> (msg.<span class="hljs-property">key</span>) {
  <span class="hljs-keyword">case</span> <span class="hljs-string">'Quit'</span>: {
    <span class="hljs-title function_">quit</span>();
    <span class="hljs-keyword">break</span>;
  }
  <span class="hljs-keyword">case</span> <span class="hljs-string">'Move'</span>: {
    <span class="hljs-title function_">move</span>(msg.<span class="hljs-property">value</span>);
    <span class="hljs-keyword">break</span>;
  }
  <span class="hljs-keyword">case</span> <span class="hljs-string">'Write'</span>: {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(msg.<span class="hljs-property">message</span>);
    <span class="hljs-keyword">break</span>;
  }

  <span class="hljs-keyword">case</span> <span class="hljs-string">'ChangeColor'</span>: {
    <span class="hljs-title function_">change_color</span>(msg.<span class="hljs-property">r</span>, msg.<span class="hljs-property">g</span>, msg.<span class="hljs-property">b</span>);
    <span class="hljs-keyword">break</span>;
  }
}
</code></pre>
<h2 id="match-的优势"><a aria-hidden="true" tabindex="-1" href="#match-的优势"><span class="icon icon-link"></span></a>Match 的优势</h2>
<p>在我看来, <code>match</code> 主要的优势有以下三点:</p>
<ol>
<li><strong>当 <code>match</code> 中没有使用通配模式时, 其中的分支必须覆盖了所有的可能性, 否则编译将不会通过</strong>.</li>
<li><code>switch</code> 是一个语句, 而不是一个表达式, 无法使用类似 <code>const value = switch(...){...}</code> 的操作, 只能在每一个 <code>case</code> 里面去执行赋值语句, 而 <code>match</code> 为一个表达式, 其返回值为分支中执行的代码的返回值.</li>
<li>优秀的多模式匹配机制. <code>switch</code> 中的多模式匹配需要移除 <code>case</code> 中的 <code>break</code> 语句, 也就是说对于每一个独立 <code>case</code> 都需要在尾部添加 <code>break</code> 语句, 但也容易因为 <code>break</code> 的丢失导致出现一些“误会”. 而 <code>match</code> 中的多模式采用类似 <code>Message::Quit | Message::Start => doSomething()</code> 的语法, 且每一个独立的分支不需要添加任何额外的语句.</li>
</ol>
<h2 id="使用方式"><a aria-hidden="true" tabindex="-1" href="#使用方式"><span class="icon icon-link"></span></a>使用方式</h2>
<p>在了解了 <code>match</code> 的具体语法以及优势后, 我们回到主题 <code>rust-like-match</code> 中, 我们首先来看下具体的使用方式:</p>
<ol>
<li>
<p>初始化</p>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">import</span> { defineMatchObject, none } <span class="hljs-keyword">from</span> <span class="hljs-string">"rust-like-match"</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title class_">Message</span> = <span class="hljs-title function_">defineMatchObject</span>({
  <span class="hljs-title class_">Quit</span>: none,
  <span class="hljs-title class_">Move</span>: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span></span>) =></span> ({ x, y }),
  <span class="hljs-title class_">Write</span>: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">msg</span>: <span class="hljs-built_in">string</span></span>) =></span> msg,
  <span class="hljs-title class_">ChangeColor</span>: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">r</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">g</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span></span>) =></span> ({ r, g, b }),
});
<span class="hljs-comment">//or</span>
<span class="hljs-keyword">const</span> obj = {
  <span class="hljs-title class_">Quit</span>: none,
  <span class="hljs-title class_">Move</span>: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span></span>) =></span> ({ x, y }),
  <span class="hljs-title class_">Write</span>: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">msg</span>: <span class="hljs-built_in">string</span></span>) =></span> msg,
  <span class="hljs-title class_">ChangeColor</span>: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">r</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">g</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span></span>) =></span> ({ r, g, b }),
} <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>;
<span class="hljs-keyword">const</span> <span class="hljs-title class_">Message</span> = <span class="hljs-title function_">defineMatchObject</span>(msg);
</code></pre>
<p>首先从 <code>rust-like-match</code> 中导出函数 <code>defineMatchObject</code> 以及变量 <code>none</code>. 由于 typescript 中已经存在 <code>enum</code> 的概念. 所以, 这里将初始化过程命名为 <strong>定义一个具有Match功能的对象</strong>, 也就是 <code>defineMatchObject</code>. 该函数接收一个字面量类型的对象, <code>key</code> 值对应 <code>rust</code> 中的枚举成员名, <code>value</code> 值的类型为 <code>None (typeof none)</code> 或者为一个函数. <code>None</code> 的情况对应着未给枚举成员附加额外数据, 相应的, 值为函数即代表着附加额外数据的情况.</p>
</li>
<li>
<p>赋值</p>
<p>我们来看下得到的 <code>Message</code> 的具体格式:</p>
<p><img src="/assets/rust-like-match/example-1.png" alt="alt"></p>
<p><img src="/assets/rust-like-match/example-2.png" alt="alt"></p>
<p><img src="/assets/rust-like-match/example-3.png" alt="alt"></p>
<p><img src="/assets/rust-like-match/example-4.png" alt="alt"></p>
<p>可以看到, 当初始值为 <code>none</code> 时, <code>Message</code> 的成员值(<code>Quit</code>)为一个拥有 <code>match</code> 属性的对象. 当初始值为函数时, <code>Message</code> 的成员值同样也是一个函数, 且该函数的入参类型与初始的函数入参类型一致. 该函数的返回值为一个拥有 <code>match</code> 属性的对象.</p>
<p>所以我们这样来进行赋值:</p>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">let</span> msg;

msg = <span class="hljs-title class_">Message</span>.<span class="hljs-property">Quit</span>;
<span class="hljs-comment">//or</span>
msg = <span class="hljs-title class_">Message</span>.<span class="hljs-title class_">Move</span>(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>);
<span class="hljs-comment">//or</span>
msg = <span class="hljs-title class_">Message</span>.<span class="hljs-title class_">Write</span>(<span class="hljs-string">"hello rust"</span>);
<span class="hljs-comment">//or</span>
msg = <span class="hljs-title class_">Message</span>.<span class="hljs-title class_">ChangeColor</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>);
</code></pre>
</li>
<li>
<p>匹配</p>
<p><code>match</code> 函数接收一个对象作为参数, 对象的每一个 <code>key:value</code> 对应着一条分支, <code>key</code> 值为一个模式, 必须满足穷尽模式或者使用通配模式, <code>value</code> 为一个函数, 该函数能够接收到 <code>defineMatchObject</code> 时定义的函数的返回值, 并将其作为参数. 函数体为分支匹配上后执行的代码.</p>
<p>接下来主要介绍在 typescript 环境下其拥有的一些特性:</p>
<ol>
<li>
<p>支持通配模式, 当分支中存在 <code>_</code> 时, 此分支涵盖了其他可能的值, 且无需满足全匹配.</p>
<pre><code class="hljs language-typescript"> msg.<span class="hljs-title function_">match</span>({
   <span class="hljs-title class_">Quit</span>:<span class="hljs-function">() =></span> <span class="hljs-title function_">quit</span>(),
   _ :<span class="hljs-function">() =></span> <span class="hljs-title function_">other</span>(),
 })
</code></pre>
</li>
<li>
<p>穷尽匹配: 当分支中不存在 <code>_</code> 时, 分支必须覆盖所有的情况, 否则 <code>typescript</code> 将编译失败.</p>
<pre><code class="hljs language-typescript"> msg.<span class="hljs-title function_">match</span>({
   <span class="hljs-title class_">Quit</span>: <span class="hljs-function">() =></span> <span class="hljs-title function_">quit</span>(),
   <span class="hljs-title class_">Move</span>: <span class="hljs-function">(<span class="hljs-params">{ x, y }</span>) =></span> <span class="hljs-title function_">move</span>(x, y),
   <span class="hljs-title class_">Write</span>: <span class="hljs-function">(<span class="hljs-params">msg</span>) =></span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(msg),
   <span class="hljs-title class_">ChangeColor</span>: <span class="hljs-function">(<span class="hljs-params">{ r, g, b }</span>) =></span> <span class="hljs-title function_">changeColor</span>(r, g, b),
 });
</code></pre>
</li>
<li>
<p>参数类型自动推导. 每个分支中的函数的入参类型为定义时函数的返回类型.</p>
</li>
<li>
<p>支持泛型.</p>
</li>
</ol>
<pre><code class="hljs language-typescript">  <span class="hljs-comment">//此时 res 类型将自动推导为 number</span>
  <span class="hljs-keyword">const</span> res = msg.<span class="hljs-title function_">match</span>({
    <span class="hljs-title class_">Quit</span>: <span class="hljs-function">() =></span> <span class="hljs-number">1</span>,
    <span class="hljs-title class_">Move</span>: <span class="hljs-function">(<span class="hljs-params">{ x, y }</span>) =></span> <span class="hljs-number">2</span>,
    <span class="hljs-title class_">Write</span>: <span class="hljs-function">(<span class="hljs-params">msg</span>) =></span> <span class="hljs-number">3</span>,
    <span class="hljs-title class_">ChangeColor</span>: <span class="hljs-function">(<span class="hljs-params">{ r, g, b }</span>) =></span> <span class="hljs-number">4</span>,
  });

 <span class="hljs-comment">//由于未标注泛型, 且存在分支的返回类型不一致, 此时 typescript 将会报错</span>
 <span class="hljs-keyword">const</span> res = msg.<span class="hljs-title function_">match</span>({
    <span class="hljs-title class_">Quit</span>: <span class="hljs-function">() =></span> <span class="hljs-number">1</span>,
    <span class="hljs-title class_">Move</span>: <span class="hljs-function">(<span class="hljs-params">{ x, y }</span>) =></span> <span class="hljs-string">'2'</span>,
    <span class="hljs-title class_">Write</span>: <span class="hljs-function">(<span class="hljs-params">msg</span>) =></span> <span class="hljs-number">3</span>,
    <span class="hljs-title class_">ChangeColor</span>: <span class="hljs-function">(<span class="hljs-params">{ r, g, b }</span>) =></span> <span class="hljs-number">4</span>,
  });

 <span class="hljs-comment">//res 的类型为 string | number | boolean | Array&#x3C;number></span>
 <span class="hljs-keyword">const</span> res = msg.<span class="hljs-property">match</span>&#x3C;<span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span> | <span class="hljs-built_in">boolean</span> | <span class="hljs-title class_">Array</span>&#x3C;<span class="hljs-built_in">number</span>>>({
    <span class="hljs-title class_">Quit</span>: <span class="hljs-function">() =></span> <span class="hljs-number">1</span>,
    <span class="hljs-title class_">Move</span>: <span class="hljs-function">(<span class="hljs-params">{ x, y }</span>) =></span> [x, y],
    <span class="hljs-title class_">Write</span>: <span class="hljs-function">(<span class="hljs-params">msg</span>) =></span> <span class="hljs-literal">false</span>,
    <span class="hljs-title class_">ChangeColor</span>: <span class="hljs-function">(<span class="hljs-params">{ r, g, b }</span>) =></span> <span class="hljs-string">`<span class="hljs-subst">${r}</span>-<span class="hljs-subst">${g}</span>-<span class="hljs-subst">${b}</span>`</span>,
  });
</code></pre>
</li>
</ol>
<h2 id="拓展"><a aria-hidden="true" tabindex="-1" href="#拓展"><span class="icon icon-link"></span></a>拓展</h2>
<ol>
<li>
<p>在 React 项目中, 怎样在能保证支持类型校验的同时将其设置为一个 <code>state</code>?</p>
<p><code>rust-like-match</code> 现支持导出类型 <code>MatchObjectType</code>. 具体使用方式如下:</p>
<pre><code class="hljs language-tsx"> <span class="hljs-keyword">import</span> { defineMatchObject, none, <span class="hljs-title class_">MatchObjectType</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'rust-like-match'</span>;

 <span class="hljs-keyword">const</span> statusEnum = {
    <span class="hljs-title class_">Loading</span>: none,
    <span class="hljs-title class_">Success</span>: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">data</span>?: <span class="hljs-title class_">Item</span></span>) =></span> data,
    <span class="hljs-title class_">Error</span>: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">err</span>: <span class="hljs-built_in">string</span></span>) =></span> <span class="hljs-title class_">Error</span>,
 } <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>;

 <span class="hljs-keyword">const</span> <span class="hljs-title class_">RequestStatus</span> = <span class="hljs-title function_">defineMatchObject</span>(statusEnum);

 <span class="hljs-keyword">const</span> [status, setStatus] = useState&#x3C;<span class="hljs-title class_">MatchObjectType</span>&#x3C;<span class="hljs-keyword">typeof</span> statusEnum>>();

 <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =></span> {
   <span class="hljs-title function_">setStatus</span>(<span class="hljs-title class_">RequestStatus</span>.<span class="hljs-property">Loading</span>);
   api
     .<span class="hljs-title function_">getData</span>()
     .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =></span> {
       <span class="hljs-keyword">if</span> (res.<span class="hljs-property">data</span>.<span class="hljs-property">code</span> === <span class="hljs-title class_">ResponseCode</span>.<span class="hljs-property">SUCCESS</span>) {
         <span class="hljs-title function_">setStatus</span>(<span class="hljs-title class_">RequestStatus</span>.<span class="hljs-title class_">Success</span>(res.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>));
       }
     })
     .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =></span> {
       <span class="hljs-title function_">setStatus</span>(
         <span class="hljs-title class_">RequestStatus</span>.<span class="hljs-title class_">Error</span>(err?.<span class="hljs-title function_">toString</span>() ?? <span class="hljs-string">"unknown error"</span>)
       );
     });
 }, []);


 <span class="hljs-keyword">return</span> (
   <span class="hljs-comment">//...</span>
   {
     status?.<span class="hljs-title function_">match</span>({
       <span class="hljs-title class_">Loading</span>: <span class="hljs-function">() =></span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">Spin</span> /></span></span>,
       <span class="hljs-title class_">Success</span>: <span class="hljs-function">(<span class="hljs-params">data</span>) =></span> <span class="hljs-title function_">renderData</span>(data),
       <span class="hljs-title class_">Error</span>: <span class="hljs-function">(<span class="hljs-params">err</span>) =></span> <span class="hljs-title function_">renderError</span>(err)
     })
   }
   <span class="hljs-comment">//...</span>
 )
</code></pre>
</li>
<li>
<p>新增函数 <code>baseTypeMatch</code>, 支持对基础类型数据进行模式匹配. 具体使用方式如下:</p>
<ol>
<li>
<p>number 类型</p>
<pre><code class="hljs language-typescript">  <span class="hljs-keyword">const</span> value1 = <span class="hljs-title function_">baseTypeMatch</span>(<span class="hljs-number">1</span>, {
    <span class="hljs-comment">//val type is 1</span>
    <span class="hljs-number">1</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> val + <span class="hljs-number">2</span>,
    <span class="hljs-number">2</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> val + <span class="hljs-number">3</span>,
    <span class="hljs-attr">_</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> val,
  });
  <span class="hljs-title function_">expect</span>(value1).<span class="hljs-title function_">toBe</span>(<span class="hljs-number">3</span>);

  <span class="hljs-keyword">const</span> value2 = <span class="hljs-title function_">baseTypeMatch</span>(value1, {
    <span class="hljs-comment">//val type is number</span>
    <span class="hljs-number">1</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> val + <span class="hljs-number">2</span>,
    <span class="hljs-number">2</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> val + <span class="hljs-number">3</span>,
    <span class="hljs-string">'3 | 4'</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> val + <span class="hljs-number">1</span>,
    <span class="hljs-attr">_</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> val,
  });

  <span class="hljs-title function_">expect</span>(value2).<span class="hljs-title function_">toBe</span>(<span class="hljs-number">4</span>);

  <span class="hljs-keyword">const</span> <span class="hljs-attr">cases</span>: <span class="hljs-title class_">BaseTypeMatchPatternType</span>&#x3C;<span class="hljs-built_in">number</span>, <span class="hljs-built_in">number</span>> = {
    <span class="hljs-string">'1 | 2'</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> val + <span class="hljs-number">1</span>,
    <span class="hljs-number">3</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> val + <span class="hljs-number">1</span>,
    <span class="hljs-attr">_</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> val + <span class="hljs-number">1</span>,
  };
  <span class="hljs-keyword">const</span> value3 = <span class="hljs-title function_">baseTypeMatch</span>(value2, cases);
  <span class="hljs-title function_">expect</span>(value3).<span class="hljs-title function_">toBe</span>(<span class="hljs-number">5</span>);
</code></pre>
</li>
<li>
<p>string 类型</p>
<pre><code class="hljs language-typescript"> <span class="hljs-keyword">const</span> value1 = <span class="hljs-title function_">baseTypeMatch</span>(<span class="hljs-string">'foo'</span>, {
  <span class="hljs-comment">//val type is foo</span>
  <span class="hljs-attr">foo</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> val + <span class="hljs-number">2</span>,
  <span class="hljs-attr">bar</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> val + <span class="hljs-number">3</span>,
  <span class="hljs-attr">_</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> val,
  });

  <span class="hljs-title function_">expect</span>(value1).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">'foo2'</span>);

  <span class="hljs-keyword">const</span> value2 = <span class="hljs-title function_">baseTypeMatch</span>(value1, {
    <span class="hljs-comment">//val type is string</span>
    <span class="hljs-attr">foo</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> val + <span class="hljs-number">2</span>,
    <span class="hljs-attr">bar</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> val + <span class="hljs-number">3</span>,
    <span class="hljs-string">'foo2 | foo1'</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> val + <span class="hljs-number">1</span>,
    <span class="hljs-attr">_</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> val,
  });

  <span class="hljs-title function_">expect</span>(value2).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">'foo21'</span>);

  <span class="hljs-keyword">const</span> <span class="hljs-attr">cases</span>: <span class="hljs-title class_">BaseTypeMatchPatternType</span>&#x3C;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>> = {
    <span class="hljs-string">'1 | 2'</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> val + <span class="hljs-number">1</span>,
    <span class="hljs-attr">bar</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> val + <span class="hljs-number">1</span>,
    <span class="hljs-attr">_</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> val + <span class="hljs-number">1</span>,
  };
  <span class="hljs-keyword">const</span> value3 = <span class="hljs-title function_">baseTypeMatch</span>(value2, cases);
  <span class="hljs-title function_">expect</span>(value3).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">'foo211'</span>);
</code></pre>
</li>
<li>
<p>boolean 类型</p>
<pre><code class="hljs language-typescript">   <span class="hljs-keyword">const</span> value1 = baseTypeMatch&#x3C;<span class="hljs-built_in">number</span>>(<span class="hljs-literal">false</span>, {
     <span class="hljs-comment">//val type is false</span>
      <span class="hljs-attr">false</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> (val ? <span class="hljs-number">1</span> : <span class="hljs-number">2</span>),
      <span class="hljs-attr">true</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> (val ? <span class="hljs-number">1</span> : <span class="hljs-number">2</span>),
    });

    <span class="hljs-title function_">expect</span>(value1).<span class="hljs-title function_">toBe</span>(<span class="hljs-number">2</span>);

    <span class="hljs-keyword">const</span> value2 = <span class="hljs-title function_">baseTypeMatch</span>(value1, {
      <span class="hljs-comment">//val type is number</span>
      <span class="hljs-number">2</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> <span class="hljs-literal">true</span>,
      <span class="hljs-attr">_</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> <span class="hljs-literal">false</span>,
    });

    <span class="hljs-title function_">expect</span>(value2).<span class="hljs-title function_">toBeTruthy</span>();

    <span class="hljs-keyword">const</span> <span class="hljs-attr">cases</span>: <span class="hljs-title class_">BaseTypeMatchPatternType</span>&#x3C;<span class="hljs-built_in">boolean</span>, <span class="hljs-built_in">string</span>> = {
      <span class="hljs-string">'true | false'</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> <span class="hljs-string">'hello'</span>,
      <span class="hljs-attr">bar</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> <span class="hljs-string">'rust'</span>,
      <span class="hljs-attr">_</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> <span class="hljs-string">'javascript'</span>,
    };
    <span class="hljs-keyword">const</span> value3 = <span class="hljs-title function_">baseTypeMatch</span>(value2, cases);
    <span class="hljs-title function_">expect</span>(value3).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">'hello'</span>);
</code></pre>
</li>
<li>
<p>symbol 类型</p>
<pre><code class="hljs language-typescript">   <span class="hljs-keyword">const</span> <span class="hljs-built_in">symbol</span> = <span class="hljs-title class_">Symbol</span>();
   <span class="hljs-keyword">const</span> value1 = baseTypeMatch&#x3C;<span class="hljs-built_in">number</span> | <span class="hljs-built_in">symbol</span>>(<span class="hljs-title class_">Symbol</span>(), {
     <span class="hljs-attr">foo</span>: <span class="hljs-function">() =></span> <span class="hljs-number">1</span>,
     <span class="hljs-attr">bar</span>: <span class="hljs-function">() =></span> <span class="hljs-number">2</span>,
     <span class="hljs-attr">_</span>: <span class="hljs-function">() =></span> <span class="hljs-built_in">symbol</span>,
   });
   <span class="hljs-title function_">expect</span>(value1).<span class="hljs-title function_">toBe</span>(<span class="hljs-built_in">symbol</span>);

   <span class="hljs-keyword">const</span> <span class="hljs-attr">cases</span>: <span class="hljs-title class_">BaseTypeMatchPatternType</span>&#x3C;<span class="hljs-built_in">symbol</span>, <span class="hljs-built_in">string</span> | <span class="hljs-built_in">boolean</span> | <span class="hljs-built_in">number</span> | <span class="hljs-built_in">symbol</span>> = {
     [value1 <span class="hljs-keyword">as</span> <span class="hljs-built_in">symbol</span>]: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> <span class="hljs-literal">false</span>,
     <span class="hljs-string">'a | b'</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> <span class="hljs-number">1</span>,
     <span class="hljs-number">1</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> val,
     <span class="hljs-attr">_</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =></span> <span class="hljs-string">'hello'</span>,
   };
   <span class="hljs-keyword">const</span> value2 = <span class="hljs-title function_">baseTypeMatch</span>(value1 <span class="hljs-keyword">as</span> <span class="hljs-built_in">symbol</span>, cases);
   <span class="hljs-title function_">expect</span>(value2).<span class="hljs-title function_">toBeFalsy</span>();
</code></pre>
</li>
</ol>
</li>
</ol>
<h2 id="未来将会支持的功能"><a aria-hidden="true" tabindex="-1" href="#未来将会支持的功能"><span class="icon icon-link"></span></a>未来将会支持的功能</h2>
<ol>
<li>实现多模式匹配, 预计会以 <code>"Quit | Start": () => other()</code> 的形式来实现.</li>
<li>兼容 typescript 中的 <code>enum</code> (实现方案考虑中).</li>
</ol></div></section><div class="mt-10 max-w-3xl"><h3 class="text-2xl font-bold mb-4">评论</h3><p>加载评论中...</p></div></article></main><footer class="bg-neutral-50 border-t border-neutral-200 text-center text-xs opacity-50 py-4">© 2022,<!-- --> <a rel="noopener noreferrer" class="hover:underline hover:bg-indigo" href="https://github.com/LZS911" target="_blank">LZS_911</a>, build with<!-- --> <a rel="noopener noreferrer" class="underline hover:bg-indigo" href="https://nextjs.org/" target="_blank">Next.js</a> <!-- -->and<!-- --> <a rel="noopener noreferrer" class="underline hover:bg-indigo" href="https://pages.github.com/?(null)" target="_blank">GitHub Pages</a></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"rust-like-match","date":"2023-02-24","slug":"rust-like-match-typescript","author":"Ai.Haibara","content":"\u003ch2 id=\"简介\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#简介\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003e简介\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003erust-like-match\u003c/code\u003e 提供了在 javascript 或 typescript 中使用 \u003ccode\u003eRust-Like\u003c/code\u003e 的模式匹配. 并且在 typescript 环境下, \u003ccode\u003erust-like-match\u003c/code\u003e 能够利用类型校验来实现 rust 中 \u003ccode\u003ematch\u003c/code\u003e 的穷尽匹配以及提供优秀的类型提示.\u003c/p\u003e\n\u003ch2 id=\"什么是-rust-like-的模式匹配\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#什么是-rust-like-的模式匹配\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003e什么是 \u003ccode\u003eRust-Like\u003c/code\u003e 的模式匹配?\u003c/h2\u003e\n\u003cp\u003e在说到模式匹配之前, 我们先来看下 rust 中的枚举功能.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-rust\"\u003e\u003cspan class=\"hljs-keyword\"\u003eenum\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eMessage\u003c/span\u003e {\n    Quit,\n    Move { x: \u003cspan class=\"hljs-type\"\u003ei32\u003c/span\u003e, y: \u003cspan class=\"hljs-type\"\u003ei32\u003c/span\u003e },\n    \u003cspan class=\"hljs-title function_ invoke__\"\u003eWrite\u003c/span\u003e(\u003cspan class=\"hljs-type\"\u003eString\u003c/span\u003e),\n    \u003cspan class=\"hljs-title function_ invoke__\"\u003eChangeColor\u003c/span\u003e(\u003cspan class=\"hljs-type\"\u003ei32\u003c/span\u003e, \u003cspan class=\"hljs-type\"\u003ei32\u003c/span\u003e, \u003cspan class=\"hljs-type\"\u003ei32\u003c/span\u003e),\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e这里定义了一个名为 \u003ccode\u003eMessage\u003c/code\u003e 的枚举类型, 包含了四个成员. 成员后的 \u003ccode\u003e{}\u003c/code\u003e 或者 \u003ccode\u003e()\u003c/code\u003e 代表着可以将什么类型的数据附加到该枚举成员上.\u003c/p\u003e\n\u003cp\u003e初始化枚举成员:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-rust\"\u003e \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"hljs-variable\"\u003emsg1\u003c/span\u003e = Message::Quit;\n \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"hljs-variable\"\u003emsg2\u003c/span\u003e = Message::Move { x: \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e, y: \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e };\n \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"hljs-variable\"\u003emsg3\u003c/span\u003e = Message::\u003cspan class=\"hljs-title function_ invoke__\"\u003eWrite\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"hello rust\"\u003c/span\u003e.\u003cspan class=\"hljs-title function_ invoke__\"\u003eto_string\u003c/span\u003e());\n \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"hljs-variable\"\u003emgs3\u003c/span\u003e = Message::\u003cspan class=\"hljs-title function_ invoke__\"\u003eChangeColor\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e255\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e255\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e255\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e接下来回到主题, 来看下 rust 中的 \u003ccode\u003ematch\u003c/code\u003e 关键字.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-rust\"\u003e \u003cspan class=\"hljs-keyword\"\u003ematch\u003c/span\u003e msg1 {\n   Message::Quit =\u003e \u003cspan class=\"hljs-title function_ invoke__\"\u003equit\u003c/span\u003e(),\n   Message::Move { x, y } =\u003e \u003cspan class=\"hljs-title function_ invoke__\"\u003emove_item\u003c/span\u003e(x, y),\n   Message::\u003cspan class=\"hljs-title function_ invoke__\"\u003eWrite\u003c/span\u003e(msg) =\u003e \u003cspan class=\"hljs-built_in\"\u003eprintln!\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"{}\"\u003c/span\u003e, msg),\n   Message::\u003cspan class=\"hljs-title function_ invoke__\"\u003eChangeColor\u003c/span\u003e(r, g, b) =\u003e \u003cspan class=\"hljs-title function_ invoke__\"\u003echange_color\u003c/span\u003e(r, g, b),\n }\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003ematch\u003c/code\u003e 关键字后跟一个表达式, 在这个栗子中是变量 \u003ccode\u003emsg1\u003c/code\u003e 的值. 接下来是一对大括号, 里面包含了 \u003ccode\u003ematch\u003c/code\u003e 的分支. 一个分支由两部分组成: 一个模式和一些代码. 第一个分支的模式是枚举成员 \u003ccode\u003eMessage::Quit\u003c/code\u003e, 之后的 \u003ccode\u003e=\u003e\u003c/code\u003e 运算符将模式和需要执行的代码分开, 这里的代码是执行函数 \u003ccode\u003equit\u003c/code\u003e. 同时, 在匹配上附加了额外数据的枚举成员时, 可以将其作为参数传递给后续需要执行的代码. 这里的代码结构有点类型 javascript 中的箭头函数.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ematch\u003c/code\u003e 也支持通配模式:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-rust\"\u003e \u003cspan class=\"hljs-keyword\"\u003ematch\u003c/span\u003e msg1 {\n   Message::Quit =\u003e \u003cspan class=\"hljs-title function_ invoke__\"\u003equit\u003c/span\u003e(),\n   _ =\u003e \u003cspan class=\"hljs-title function_ invoke__\"\u003eother\u003c/span\u003e()\n }\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e上述代码中当匹配上 \u003ccode\u003eMessage::Quit\u003c/code\u003e 之外的成员时, 都将执行 \u003ccode\u003eother\u003c/code\u003e 函数, 其中 \u003ccode\u003e_\u003c/code\u003e 为 rust 特定的占位符.\u003c/p\u003e\n\u003ch2 id=\"typescript-中的模式匹配\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#typescript-中的模式匹配\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eTypescript 中的模式匹配\u003c/h2\u003e\n\u003cp\u003e接下来我们使用 \u003ccode\u003eswitch\u003c/code\u003e 来模仿下 \u003ccode\u003ematch\u003c/code\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\n\u003cspan class=\"hljs-keyword\"\u003etype\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eMessage\u003c/span\u003e =\n  | {\n      \u003cspan class=\"hljs-attr\"\u003ekey\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Quit'\u003c/span\u003e;\n    }\n  | { \u003cspan class=\"hljs-attr\"\u003ekey\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Move'\u003c/span\u003e; \u003cspan class=\"hljs-attr\"\u003evalue\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e; \u003cspan class=\"hljs-attr\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e } }\n  | { \u003cspan class=\"hljs-attr\"\u003ekey\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'Write'\u003c/span\u003e; \u003cspan class=\"hljs-attr\"\u003emessage\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e }\n  | { \u003cspan class=\"hljs-attr\"\u003ekey\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'ChangeColor'\u003c/span\u003e; \u003cspan class=\"hljs-attr\"\u003er\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e; \u003cspan class=\"hljs-attr\"\u003eg\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e; \u003cspan class=\"hljs-attr\"\u003eb\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e };\n\n\n\n\u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e msg!: \u003cspan class=\"hljs-title class_\"\u003eMessage\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003eswitch\u003c/span\u003e (msg.\u003cspan class=\"hljs-property\"\u003ekey\u003c/span\u003e) {\n  \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'Quit'\u003c/span\u003e: {\n    \u003cspan class=\"hljs-title function_\"\u003equit\u003c/span\u003e();\n    \u003cspan class=\"hljs-keyword\"\u003ebreak\u003c/span\u003e;\n  }\n  \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'Move'\u003c/span\u003e: {\n    \u003cspan class=\"hljs-title function_\"\u003emove\u003c/span\u003e(msg.\u003cspan class=\"hljs-property\"\u003evalue\u003c/span\u003e);\n    \u003cspan class=\"hljs-keyword\"\u003ebreak\u003c/span\u003e;\n  }\n  \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'Write'\u003c/span\u003e: {\n    \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(msg.\u003cspan class=\"hljs-property\"\u003emessage\u003c/span\u003e);\n    \u003cspan class=\"hljs-keyword\"\u003ebreak\u003c/span\u003e;\n  }\n\n  \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'ChangeColor'\u003c/span\u003e: {\n    \u003cspan class=\"hljs-title function_\"\u003echange_color\u003c/span\u003e(msg.\u003cspan class=\"hljs-property\"\u003er\u003c/span\u003e, msg.\u003cspan class=\"hljs-property\"\u003eg\u003c/span\u003e, msg.\u003cspan class=\"hljs-property\"\u003eb\u003c/span\u003e);\n    \u003cspan class=\"hljs-keyword\"\u003ebreak\u003c/span\u003e;\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"match-的优势\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#match-的优势\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eMatch 的优势\u003c/h2\u003e\n\u003cp\u003e在我看来, \u003ccode\u003ematch\u003c/code\u003e 主要的优势有以下三点:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003e当 \u003ccode\u003ematch\u003c/code\u003e 中没有使用通配模式时, 其中的分支必须覆盖了所有的可能性, 否则编译将不会通过\u003c/strong\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eswitch\u003c/code\u003e 是一个语句, 而不是一个表达式, 无法使用类似 \u003ccode\u003econst value = switch(...){...}\u003c/code\u003e 的操作, 只能在每一个 \u003ccode\u003ecase\u003c/code\u003e 里面去执行赋值语句, 而 \u003ccode\u003ematch\u003c/code\u003e 为一个表达式, 其返回值为分支中执行的代码的返回值.\u003c/li\u003e\n\u003cli\u003e优秀的多模式匹配机制. \u003ccode\u003eswitch\u003c/code\u003e 中的多模式匹配需要移除 \u003ccode\u003ecase\u003c/code\u003e 中的 \u003ccode\u003ebreak\u003c/code\u003e 语句, 也就是说对于每一个独立 \u003ccode\u003ecase\u003c/code\u003e 都需要在尾部添加 \u003ccode\u003ebreak\u003c/code\u003e 语句, 但也容易因为 \u003ccode\u003ebreak\u003c/code\u003e 的丢失导致出现一些“误会”. 而 \u003ccode\u003ematch\u003c/code\u003e 中的多模式采用类似 \u003ccode\u003eMessage::Quit | Message::Start =\u003e doSomething()\u003c/code\u003e 的语法, 且每一个独立的分支不需要添加任何额外的语句.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"使用方式\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#使用方式\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003e使用方式\u003c/h2\u003e\n\u003cp\u003e在了解了 \u003ccode\u003ematch\u003c/code\u003e 的具体语法以及优势后, 我们回到主题 \u003ccode\u003erust-like-match\u003c/code\u003e 中, 我们首先来看下具体的使用方式:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e初始化\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { defineMatchObject, none } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"rust-like-match\"\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eMessage\u003c/span\u003e = \u003cspan class=\"hljs-title function_\"\u003edefineMatchObject\u003c/span\u003e({\n  \u003cspan class=\"hljs-title class_\"\u003eQuit\u003c/span\u003e: none,\n  \u003cspan class=\"hljs-title class_\"\u003eMove\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003e\u003cspan class=\"hljs-attr\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e\u003c/span\u003e) =\u003e\u003c/span\u003e ({ x, y }),\n  \u003cspan class=\"hljs-title class_\"\u003eWrite\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003e\u003cspan class=\"hljs-attr\"\u003emsg\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e\u003c/span\u003e) =\u003e\u003c/span\u003e msg,\n  \u003cspan class=\"hljs-title class_\"\u003eChangeColor\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003e\u003cspan class=\"hljs-attr\"\u003er\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eg\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eb\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e\u003c/span\u003e) =\u003e\u003c/span\u003e ({ r, g, b }),\n});\n\u003cspan class=\"hljs-comment\"\u003e//or\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e obj = {\n  \u003cspan class=\"hljs-title class_\"\u003eQuit\u003c/span\u003e: none,\n  \u003cspan class=\"hljs-title class_\"\u003eMove\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003e\u003cspan class=\"hljs-attr\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e\u003c/span\u003e) =\u003e\u003c/span\u003e ({ x, y }),\n  \u003cspan class=\"hljs-title class_\"\u003eWrite\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003e\u003cspan class=\"hljs-attr\"\u003emsg\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e\u003c/span\u003e) =\u003e\u003c/span\u003e msg,\n  \u003cspan class=\"hljs-title class_\"\u003eChangeColor\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003e\u003cspan class=\"hljs-attr\"\u003er\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eg\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eb\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e\u003c/span\u003e) =\u003e\u003c/span\u003e ({ r, g, b }),\n} \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eMessage\u003c/span\u003e = \u003cspan class=\"hljs-title function_\"\u003edefineMatchObject\u003c/span\u003e(msg);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e首先从 \u003ccode\u003erust-like-match\u003c/code\u003e 中导出函数 \u003ccode\u003edefineMatchObject\u003c/code\u003e 以及变量 \u003ccode\u003enone\u003c/code\u003e. 由于 typescript 中已经存在 \u003ccode\u003eenum\u003c/code\u003e 的概念. 所以, 这里将初始化过程命名为 \u003cstrong\u003e定义一个具有Match功能的对象\u003c/strong\u003e, 也就是 \u003ccode\u003edefineMatchObject\u003c/code\u003e. 该函数接收一个字面量类型的对象, \u003ccode\u003ekey\u003c/code\u003e 值对应 \u003ccode\u003erust\u003c/code\u003e 中的枚举成员名, \u003ccode\u003evalue\u003c/code\u003e 值的类型为 \u003ccode\u003eNone (typeof none)\u003c/code\u003e 或者为一个函数. \u003ccode\u003eNone\u003c/code\u003e 的情况对应着未给枚举成员附加额外数据, 相应的, 值为函数即代表着附加额外数据的情况.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e赋值\u003c/p\u003e\n\u003cp\u003e我们来看下得到的 \u003ccode\u003eMessage\u003c/code\u003e 的具体格式:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/rust-like-match/example-1.png\" alt=\"alt\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/rust-like-match/example-2.png\" alt=\"alt\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/rust-like-match/example-3.png\" alt=\"alt\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/rust-like-match/example-4.png\" alt=\"alt\"\u003e\u003c/p\u003e\n\u003cp\u003e可以看到, 当初始值为 \u003ccode\u003enone\u003c/code\u003e 时, \u003ccode\u003eMessage\u003c/code\u003e 的成员值(\u003ccode\u003eQuit\u003c/code\u003e)为一个拥有 \u003ccode\u003ematch\u003c/code\u003e 属性的对象. 当初始值为函数时, \u003ccode\u003eMessage\u003c/code\u003e 的成员值同样也是一个函数, 且该函数的入参类型与初始的函数入参类型一致. 该函数的返回值为一个拥有 \u003ccode\u003ematch\u003c/code\u003e 属性的对象.\u003c/p\u003e\n\u003cp\u003e所以我们这样来进行赋值:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e msg;\n\nmsg = \u003cspan class=\"hljs-title class_\"\u003eMessage\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eQuit\u003c/span\u003e;\n\u003cspan class=\"hljs-comment\"\u003e//or\u003c/span\u003e\nmsg = \u003cspan class=\"hljs-title class_\"\u003eMessage\u003c/span\u003e.\u003cspan class=\"hljs-title class_\"\u003eMove\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e);\n\u003cspan class=\"hljs-comment\"\u003e//or\u003c/span\u003e\nmsg = \u003cspan class=\"hljs-title class_\"\u003eMessage\u003c/span\u003e.\u003cspan class=\"hljs-title class_\"\u003eWrite\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"hello rust\"\u003c/span\u003e);\n\u003cspan class=\"hljs-comment\"\u003e//or\u003c/span\u003e\nmsg = \u003cspan class=\"hljs-title class_\"\u003eMessage\u003c/span\u003e.\u003cspan class=\"hljs-title class_\"\u003eChangeColor\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e255\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e255\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e255\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e匹配\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ematch\u003c/code\u003e 函数接收一个对象作为参数, 对象的每一个 \u003ccode\u003ekey:value\u003c/code\u003e 对应着一条分支, \u003ccode\u003ekey\u003c/code\u003e 值为一个模式, 必须满足穷尽模式或者使用通配模式, \u003ccode\u003evalue\u003c/code\u003e 为一个函数, 该函数能够接收到 \u003ccode\u003edefineMatchObject\u003c/code\u003e 时定义的函数的返回值, 并将其作为参数. 函数体为分支匹配上后执行的代码.\u003c/p\u003e\n\u003cp\u003e接下来主要介绍在 typescript 环境下其拥有的一些特性:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e支持通配模式, 当分支中存在 \u003ccode\u003e_\u003c/code\u003e 时, 此分支涵盖了其他可能的值, 且无需满足全匹配.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e msg.\u003cspan class=\"hljs-title function_\"\u003ematch\u003c/span\u003e({\n   \u003cspan class=\"hljs-title class_\"\u003eQuit\u003c/span\u003e:\u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003equit\u003c/span\u003e(),\n   _ :\u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eother\u003c/span\u003e(),\n })\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e穷尽匹配: 当分支中不存在 \u003ccode\u003e_\u003c/code\u003e 时, 分支必须覆盖所有的情况, 否则 \u003ccode\u003etypescript\u003c/code\u003e 将编译失败.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e msg.\u003cspan class=\"hljs-title function_\"\u003ematch\u003c/span\u003e({\n   \u003cspan class=\"hljs-title class_\"\u003eQuit\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003equit\u003c/span\u003e(),\n   \u003cspan class=\"hljs-title class_\"\u003eMove\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003e{ x, y }\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003emove\u003c/span\u003e(x, y),\n   \u003cspan class=\"hljs-title class_\"\u003eWrite\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003emsg\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(msg),\n   \u003cspan class=\"hljs-title class_\"\u003eChangeColor\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003e{ r, g, b }\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003echangeColor\u003c/span\u003e(r, g, b),\n });\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e参数类型自动推导. 每个分支中的函数的入参类型为定义时函数的返回类型.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e支持泛型.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e  \u003cspan class=\"hljs-comment\"\u003e//此时 res 类型将自动推导为 number\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e res = msg.\u003cspan class=\"hljs-title function_\"\u003ematch\u003c/span\u003e({\n    \u003cspan class=\"hljs-title class_\"\u003eQuit\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n    \u003cspan class=\"hljs-title class_\"\u003eMove\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003e{ x, y }\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\n    \u003cspan class=\"hljs-title class_\"\u003eWrite\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003emsg\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e,\n    \u003cspan class=\"hljs-title class_\"\u003eChangeColor\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003e{ r, g, b }\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e,\n  });\n\n \u003cspan class=\"hljs-comment\"\u003e//由于未标注泛型, 且存在分支的返回类型不一致, 此时 typescript 将会报错\u003c/span\u003e\n \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e res = msg.\u003cspan class=\"hljs-title function_\"\u003ematch\u003c/span\u003e({\n    \u003cspan class=\"hljs-title class_\"\u003eQuit\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n    \u003cspan class=\"hljs-title class_\"\u003eMove\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003e{ x, y }\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'2'\u003c/span\u003e,\n    \u003cspan class=\"hljs-title class_\"\u003eWrite\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003emsg\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e,\n    \u003cspan class=\"hljs-title class_\"\u003eChangeColor\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003e{ r, g, b }\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e,\n  });\n\n \u003cspan class=\"hljs-comment\"\u003e//res 的类型为 string | number | boolean | Array\u0026#x3C;number\u003e\u003c/span\u003e\n \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e res = msg.\u003cspan class=\"hljs-property\"\u003ematch\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003eboolean\u003c/span\u003e | \u003cspan class=\"hljs-title class_\"\u003eArray\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e\u003e\u003e({\n    \u003cspan class=\"hljs-title class_\"\u003eQuit\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n    \u003cspan class=\"hljs-title class_\"\u003eMove\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003e{ x, y }\u003c/span\u003e) =\u003e\u003c/span\u003e [x, y],\n    \u003cspan class=\"hljs-title class_\"\u003eWrite\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003emsg\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e,\n    \u003cspan class=\"hljs-title class_\"\u003eChangeColor\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003e{ r, g, b }\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e`\u003cspan class=\"hljs-subst\"\u003e${r}\u003c/span\u003e-\u003cspan class=\"hljs-subst\"\u003e${g}\u003c/span\u003e-\u003cspan class=\"hljs-subst\"\u003e${b}\u003c/span\u003e`\u003c/span\u003e,\n  });\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"拓展\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#拓展\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003e拓展\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e在 React 项目中, 怎样在能保证支持类型校验的同时将其设置为一个 \u003ccode\u003estate\u003c/code\u003e?\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003erust-like-match\u003c/code\u003e 现支持导出类型 \u003ccode\u003eMatchObjectType\u003c/code\u003e. 具体使用方式如下:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-tsx\"\u003e \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { defineMatchObject, none, \u003cspan class=\"hljs-title class_\"\u003eMatchObjectType\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'rust-like-match'\u003c/span\u003e;\n\n \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e statusEnum = {\n    \u003cspan class=\"hljs-title class_\"\u003eLoading\u003c/span\u003e: none,\n    \u003cspan class=\"hljs-title class_\"\u003eSuccess\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003e\u003cspan class=\"hljs-attr\"\u003edata\u003c/span\u003e?: \u003cspan class=\"hljs-title class_\"\u003eItem\u003c/span\u003e\u003c/span\u003e) =\u003e\u003c/span\u003e data,\n    \u003cspan class=\"hljs-title class_\"\u003eError\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003e\u003cspan class=\"hljs-attr\"\u003eerr\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eError\u003c/span\u003e,\n } \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e;\n\n \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eRequestStatus\u003c/span\u003e = \u003cspan class=\"hljs-title function_\"\u003edefineMatchObject\u003c/span\u003e(statusEnum);\n\n \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e [status, setStatus] = useState\u0026#x3C;\u003cspan class=\"hljs-title class_\"\u003eMatchObjectType\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-keyword\"\u003etypeof\u003c/span\u003e statusEnum\u003e\u003e();\n\n \u003cspan class=\"hljs-title function_\"\u003euseEffect\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e {\n   \u003cspan class=\"hljs-title function_\"\u003esetStatus\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eRequestStatus\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eLoading\u003c/span\u003e);\n   api\n     .\u003cspan class=\"hljs-title function_\"\u003egetData\u003c/span\u003e()\n     .\u003cspan class=\"hljs-title function_\"\u003ethen\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eres\u003c/span\u003e) =\u003e\u003c/span\u003e {\n       \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (res.\u003cspan class=\"hljs-property\"\u003edata\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ecode\u003c/span\u003e === \u003cspan class=\"hljs-title class_\"\u003eResponseCode\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eSUCCESS\u003c/span\u003e) {\n         \u003cspan class=\"hljs-title function_\"\u003esetStatus\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eRequestStatus\u003c/span\u003e.\u003cspan class=\"hljs-title class_\"\u003eSuccess\u003c/span\u003e(res.\u003cspan class=\"hljs-property\"\u003edata\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003edata\u003c/span\u003e));\n       }\n     })\n     .\u003cspan class=\"hljs-title function_\"\u003ecatch\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eerr\u003c/span\u003e) =\u003e\u003c/span\u003e {\n       \u003cspan class=\"hljs-title function_\"\u003esetStatus\u003c/span\u003e(\n         \u003cspan class=\"hljs-title class_\"\u003eRequestStatus\u003c/span\u003e.\u003cspan class=\"hljs-title class_\"\u003eError\u003c/span\u003e(err?.\u003cspan class=\"hljs-title function_\"\u003etoString\u003c/span\u003e() ?? \u003cspan class=\"hljs-string\"\u003e\"unknown error\"\u003c/span\u003e)\n       );\n     });\n }, []);\n\n\n \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (\n   \u003cspan class=\"hljs-comment\"\u003e//...\u003c/span\u003e\n   {\n     status?.\u003cspan class=\"hljs-title function_\"\u003ematch\u003c/span\u003e({\n       \u003cspan class=\"hljs-title class_\"\u003eLoading\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e \u003cspan class=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026#x3C;\u003cspan class=\"hljs-name\"\u003eSpin\u003c/span\u003e /\u003e\u003c/span\u003e\u003c/span\u003e,\n       \u003cspan class=\"hljs-title class_\"\u003eSuccess\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003edata\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003erenderData\u003c/span\u003e(data),\n       \u003cspan class=\"hljs-title class_\"\u003eError\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eerr\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003erenderError\u003c/span\u003e(err)\n     })\n   }\n   \u003cspan class=\"hljs-comment\"\u003e//...\u003c/span\u003e\n )\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e新增函数 \u003ccode\u003ebaseTypeMatch\u003c/code\u003e, 支持对基础类型数据进行模式匹配. 具体使用方式如下:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003enumber 类型\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e value1 = \u003cspan class=\"hljs-title function_\"\u003ebaseTypeMatch\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, {\n    \u003cspan class=\"hljs-comment\"\u003e//val type is 1\u003c/span\u003e\n    \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e val + \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\n    \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e val + \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003e_\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e val,\n  });\n  \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(value1).\u003cspan class=\"hljs-title function_\"\u003etoBe\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e);\n\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e value2 = \u003cspan class=\"hljs-title function_\"\u003ebaseTypeMatch\u003c/span\u003e(value1, {\n    \u003cspan class=\"hljs-comment\"\u003e//val type is number\u003c/span\u003e\n    \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e val + \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\n    \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e val + \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e'3 | 4'\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e val + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003e_\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e val,\n  });\n\n  \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(value2).\u003cspan class=\"hljs-title function_\"\u003etoBe\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e);\n\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ecases\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eBaseTypeMatchPatternType\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e, \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e\u003e = {\n    \u003cspan class=\"hljs-string\"\u003e'1 | 2'\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e val + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n    \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e val + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003e_\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e val + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n  };\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e value3 = \u003cspan class=\"hljs-title function_\"\u003ebaseTypeMatch\u003c/span\u003e(value2, cases);\n  \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(value3).\u003cspan class=\"hljs-title function_\"\u003etoBe\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003estring 类型\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e value1 = \u003cspan class=\"hljs-title function_\"\u003ebaseTypeMatch\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'foo'\u003c/span\u003e, {\n  \u003cspan class=\"hljs-comment\"\u003e//val type is foo\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003efoo\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e val + \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\n  \u003cspan class=\"hljs-attr\"\u003ebar\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e val + \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e,\n  \u003cspan class=\"hljs-attr\"\u003e_\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e val,\n  });\n\n  \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(value1).\u003cspan class=\"hljs-title function_\"\u003etoBe\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'foo2'\u003c/span\u003e);\n\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e value2 = \u003cspan class=\"hljs-title function_\"\u003ebaseTypeMatch\u003c/span\u003e(value1, {\n    \u003cspan class=\"hljs-comment\"\u003e//val type is string\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003efoo\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e val + \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003ebar\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e val + \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e,\n    \u003cspan class=\"hljs-string\"\u003e'foo2 | foo1'\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e val + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003e_\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e val,\n  });\n\n  \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(value2).\u003cspan class=\"hljs-title function_\"\u003etoBe\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'foo21'\u003c/span\u003e);\n\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ecases\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eBaseTypeMatchPatternType\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e, \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e\u003e = {\n    \u003cspan class=\"hljs-string\"\u003e'1 | 2'\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e val + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003ebar\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e val + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003e_\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e val + \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n  };\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e value3 = \u003cspan class=\"hljs-title function_\"\u003ebaseTypeMatch\u003c/span\u003e(value2, cases);\n  \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(value3).\u003cspan class=\"hljs-title function_\"\u003etoBe\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'foo211'\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eboolean 类型\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e   \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e value1 = baseTypeMatch\u0026#x3C;\u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e\u003e(\u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e, {\n     \u003cspan class=\"hljs-comment\"\u003e//val type is false\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003efalse\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e (val ? \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e : \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e),\n      \u003cspan class=\"hljs-attr\"\u003etrue\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e (val ? \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e : \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e),\n    });\n\n    \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(value1).\u003cspan class=\"hljs-title function_\"\u003etoBe\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e);\n\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e value2 = \u003cspan class=\"hljs-title function_\"\u003ebaseTypeMatch\u003c/span\u003e(value1, {\n      \u003cspan class=\"hljs-comment\"\u003e//val type is number\u003c/span\u003e\n      \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e,\n      \u003cspan class=\"hljs-attr\"\u003e_\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e,\n    });\n\n    \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(value2).\u003cspan class=\"hljs-title function_\"\u003etoBeTruthy\u003c/span\u003e();\n\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ecases\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eBaseTypeMatchPatternType\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-built_in\"\u003eboolean\u003c/span\u003e, \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e\u003e = {\n      \u003cspan class=\"hljs-string\"\u003e'true | false'\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'hello'\u003c/span\u003e,\n      \u003cspan class=\"hljs-attr\"\u003ebar\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'rust'\u003c/span\u003e,\n      \u003cspan class=\"hljs-attr\"\u003e_\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'javascript'\u003c/span\u003e,\n    };\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e value3 = \u003cspan class=\"hljs-title function_\"\u003ebaseTypeMatch\u003c/span\u003e(value2, cases);\n    \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(value3).\u003cspan class=\"hljs-title function_\"\u003etoBe\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'hello'\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003esymbol 类型\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e   \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003esymbol\u003c/span\u003e = \u003cspan class=\"hljs-title class_\"\u003eSymbol\u003c/span\u003e();\n   \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e value1 = baseTypeMatch\u0026#x3C;\u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003esymbol\u003c/span\u003e\u003e(\u003cspan class=\"hljs-title class_\"\u003eSymbol\u003c/span\u003e(), {\n     \u003cspan class=\"hljs-attr\"\u003efoo\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n     \u003cspan class=\"hljs-attr\"\u003ebar\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\n     \u003cspan class=\"hljs-attr\"\u003e_\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003esymbol\u003c/span\u003e,\n   });\n   \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(value1).\u003cspan class=\"hljs-title function_\"\u003etoBe\u003c/span\u003e(\u003cspan class=\"hljs-built_in\"\u003esymbol\u003c/span\u003e);\n\n   \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ecases\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eBaseTypeMatchPatternType\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-built_in\"\u003esymbol\u003c/span\u003e, \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003eboolean\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003esymbol\u003c/span\u003e\u003e = {\n     [value1 \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003esymbol\u003c/span\u003e]: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e,\n     \u003cspan class=\"hljs-string\"\u003e'a | b'\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\n     \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e val,\n     \u003cspan class=\"hljs-attr\"\u003e_\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eval\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'hello'\u003c/span\u003e,\n   };\n   \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e value2 = \u003cspan class=\"hljs-title function_\"\u003ebaseTypeMatch\u003c/span\u003e(value1 \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003esymbol\u003c/span\u003e, cases);\n   \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(value2).\u003cspan class=\"hljs-title function_\"\u003etoBeFalsy\u003c/span\u003e();\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"未来将会支持的功能\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#未来将会支持的功能\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003e未来将会支持的功能\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e实现多模式匹配, 预计会以 \u003ccode\u003e\"Quit | Start\": () =\u003e other()\u003c/code\u003e 的形式来实现.\u003c/li\u003e\n\u003cli\u003e兼容 typescript 中的 \u003ccode\u003eenum\u003c/code\u003e (实现方案考虑中).\u003c/li\u003e\n\u003c/ol\u003e","theme":"jzman","tag":[null]}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"rust-like-match-typescript"},"buildId":"YweoWqZUfFtvB-M1jJ2CU","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>