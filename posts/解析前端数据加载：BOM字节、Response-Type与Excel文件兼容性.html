<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#000000"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><meta property="og:image" content="https://og-image.vercel.app/Next.js%20Blog%20Starter%20Example.png?theme=light&amp;md=1&amp;fontSize=100px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg"/><title>è§£æå‰ç«¯æ•°æ®åŠ è½½ï¼šBOMå­—èŠ‚ã€Response-Typeä¸Excelæ–‡ä»¶å…¼å®¹æ€§ | Ai.Haibara codes</title><meta name="next-head-count" content="14"/><link rel="preload" href="/_next/static/css/8681f744d5932be6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8681f744d5932be6.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-8fa1640cc84ba8fe.js" defer=""></script><script src="/_next/static/chunks/framework-3b5a00d5d7e8d93b.js" defer=""></script><script src="/_next/static/chunks/main-59a90320855f5cf5.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f46e289d7ac5e197.js" defer=""></script><script src="/_next/static/chunks/799-575b46febca3af7d.js" defer=""></script><script src="/_next/static/chunks/399-cac0cd8ed02bf02a.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-e2afa3a98c674f72.js" defer=""></script><script src="/_next/static/5nPQWyP3XMPyYl2FPDKAk/_buildManifest.js" defer=""></script><script src="/_next/static/5nPQWyP3XMPyYl2FPDKAk/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen"><header class="text-white bg-black drop-shadow-2xl"><div class="mx-auto my-0 max-w-[960px] py-6 px-4 flex items-center"><div class="flex items-center"><img alt="Ai.Haibara" src="/assets/blog/authors/haibara_2.jpg" width="100" height="100" decoding="async" data-nimg="1" class=" rounded-full" loading="lazy" style="color:transparent"/></div><div class="ml-6"><a class=" font-bold text-3xl" href="/">Ai.Haibara codes</a><div class="mt-2"><a class="p-1 rounded-sm text-xl mr-2 hover:border-b-2 border-indigo" href="/">Home</a><a class="p-1 rounded-sm text-xl mr-2 hover:border-b-2 border-indigo" href="/projects">Projects</a><a class="p-1 rounded-sm text-xl mr-2 hover:border-b-2 border-indigo" href="/talks">Talks</a><a class="p-1 rounded-sm text-xl mr-2 hover:border-b-2 border-indigo" href="/blogs">Blogs</a></div></div></div></header><main class="p-6 flex justify-center"><article><div class="flex justify-center font-[Arial] max-w-[864px] text-center"><h1 class="text-5xl font-bold bg-indigo px-5 py-2 rounded-sm text-shadow-lg leading-[1.1]">è§£æå‰ç«¯æ•°æ®åŠ è½½ï¼šBOMå­—èŠ‚ã€Response-Typeä¸Excelæ–‡ä»¶å…¼å®¹æ€§</h1></div><time dateTime="2024-04-10" class="text-center block my-4 text-sm opacity-60">April	10, 2024</time><section><div class="markdown-body-fancy max-w-3xl"><h2 id="å¼•è¨€"><a aria-hidden="true" tabindex="-1" href="#å¼•è¨€"><span class="icon icon-link"></span></a>å¼•è¨€</h2>
<p>åœ¨å¼€å‘ To B ç«¯çš„é¡¹ç›®æ—¶ï¼Œå¯¼å‡º CSV æ–‡ä»¶è¿›è¡Œæ•°æ®åˆ†ææ˜¯ä¸€é¡¹å¸¸è§„æ“ä½œã€‚ç„¶è€Œï¼Œè¿™ä¸€è¿‡ç¨‹å¹¶éæ€»æ˜¯é¡ºç•…æ— é˜»ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œå½“ä½ ä¿¡å¿ƒæ»¡æ»¡åœ°å°†ä¸€ä¸ª CSV æ–‡ä»¶æ‹–å…¥ Excel ï¼ŒæœŸå¾…çœ‹åˆ°ä¸€ä¸ªæ•´é½çš„æ•°æ®è¡¨æ ¼æ—¶ï¼Œå´é­é‡äº†ä¹±ç çš„å°´å°¬åœºæ™¯ã€‚è¿™ä¸ä»…ä»¤äººæ²®ä¸§ï¼Œè€Œä¸”å¯èƒ½ä¸¥é‡å½±å“å·¥ä½œæ•ˆç‡ã€‚é‚£ä¹ˆï¼ŒCSV æ–‡ä»¶ä¸ Excel ä¹‹é—´å­˜åœ¨å“ªäº›å·®å¼‚ï¼Ÿæˆ‘ä»¬å¦‚ä½•ç¡®ä¿åœ¨ Excel ä¸­èƒ½å¤Ÿæ­£å¸¸æ‰“å¼€ CSV æ–‡ä»¶ï¼Ÿ</p>
<p>æœ¬æ–‡å°†é’ˆå¯¹è¿™äº›ç–‘é—®å±•å¼€æ¢è®¨ï¼Œä»ä¸€æ¬¡ CSV æ–‡ä»¶å¯¼å…¥ Excel æ—¶å‡ºç°çš„ä¹±ç é—®é¢˜å…¥æ‰‹ï¼Œé€æ­¥å‰–æèƒŒåçš„åŸå› ã€‚é‡ç‚¹æ¢è®¨<code>BOMï¼ˆByte Order Markï¼‰</code>å­—èŠ‚å’Œ HTTP å“åº”ä¸­çš„<code>Content-Type</code>å¦‚ä½•å½±å“å‰ç«¯å¯¹æ•°æ®çš„åŠ è½½å’Œè§£æï¼Œä»¥åŠè¿™äº›å› ç´ å¯¹ Excel æ–‡ä»¶å…¼å®¹æ€§çš„å½±å“ã€‚</p>
<h2 id="csvæ–‡ä»¶ä¸excelçš„å·®å¼‚-1"><a aria-hidden="true" tabindex="-1" href="#csvæ–‡ä»¶ä¸excelçš„å·®å¼‚-1"><span class="icon icon-link"></span></a>CSVæ–‡ä»¶ä¸Excelçš„å·®å¼‚ <sup><a href="#user-content-fn-1" id="user-content-fnref-1" data-footnote-ref aria-describedby="footnote-label">1</a></sup></h2>
<ol>
<li>Excelæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå®ƒä¿å­˜æœ‰å…³å·¥ä½œç°¿ä¸­æ‰€æœ‰å·¥ä½œè¡¨çš„ä¿¡æ¯ã€‚CSVä»£è¡¨ Comma Separated Values ã€‚è¿™æ˜¯ä¸€ä¸ªçº¯æ–‡æœ¬æ ¼å¼ï¼Œç”¨é€—å·åˆ†éš”ä¸€ç³»åˆ—å€¼ã€‚</li>
<li>Excelä¸ä»…å¯ä»¥å­˜å‚¨æ•°æ®ï¼Œè¿˜å¯ä»¥å¯¹æ•°æ®è¿›è¡Œæ“ä½œã€‚CSVæ–‡ä»¶åªæ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå®ƒå­˜å‚¨æ•°æ®ï¼Œä½†ä¸åŒ…å«æ ¼å¼ï¼Œå…¬å¼ï¼Œå®ç­‰ã€‚å®ƒä¹Ÿè¢«ç§°ä¸ºå¹³é¢æ–‡ä»¶ã€‚</li>
<li>Excelæ˜¯ä¸€ä¸ªç”µå­è¡¨æ ¼ï¼Œå°†æ–‡ä»¶ä¿å­˜ä¸ºè‡ªå·±çš„ä¸“æœ‰æ ¼å¼ï¼Œå³xlsæˆ–xlsxã€‚CSVæ˜¯å°†è¡¨æ ¼ä¿¡æ¯ä¿å­˜ä¸ºæ‰©å±•åä¸º.csvçš„åˆ†éš”æ–‡æœ¬æ–‡ä»¶çš„æ ¼å¼ã€‚</li>
<li>ä¿å­˜åœ¨excelä¸­çš„æ–‡ä»¶ä¸èƒ½è¢«æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€æˆ–ç¼–è¾‘ã€‚CSVæ–‡ä»¶å¯ä»¥é€šè¿‡æ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆå¦‚è®°äº‹æœ¬ï¼‰æ‰“å¼€æˆ–ç¼–è¾‘ã€‚</li>
</ol>
<h2 id="bomå­—èŠ‚çš„æ¦‚å¿µä¸ä½œç”¨"><a aria-hidden="true" tabindex="-1" href="#bomå­—èŠ‚çš„æ¦‚å¿µä¸ä½œç”¨"><span class="icon icon-link"></span></a>BOMå­—èŠ‚çš„æ¦‚å¿µä¸ä½œç”¨</h2>
<p>åœ¨è§£é‡ŠBOMå­—èŠ‚å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹ CSV æ–‡ä»¶åœ¨ WPS å’Œ Microsoft Excel ä¸­çš„è¡¨ç°åŒºåˆ«</p>
<h3 id="wps"><a aria-hidden="true" tabindex="-1" href="#wps"><span class="icon icon-link"></span></a>WPS</h3>
<p><img src="https://github.com/LZS911/LZS911.github.io/assets/42765421/6c8989cf-0386-4f4b-bcdb-1dfef747f2dc" alt="image"></p>
<h3 id="microsoft-excel"><a aria-hidden="true" tabindex="-1" href="#microsoft-excel"><span class="icon icon-link"></span></a>Microsoft Excel</h3>
<p><img src="https://github.com/LZS911/LZS911.github.io/assets/42765421/1eb61e35-19f5-4aaa-b1fa-b0f6a5be24f7" alt="image"></p>
<h3 id="ä¸ºä»€ä¹ˆä¼šå‡ºç°ä¸­æ–‡ä¹±ç "><a aria-hidden="true" tabindex="-1" href="#ä¸ºä»€ä¹ˆä¼šå‡ºç°ä¸­æ–‡ä¹±ç "><span class="icon icon-link"></span></a>ä¸ºä»€ä¹ˆä¼šå‡ºç°ä¸­æ–‡ä¹±ç ï¼Ÿ</h3>
<p>å½“å‡ºç°ä¹±ç åï¼Œé¦–å…ˆåº”è¯¥è€ƒè™‘çš„æ˜¯æ–‡ä»¶çš„ç¼–ç æ ¼å¼é—®é¢˜ã€‚é€šå¸¸ï¼ŒCSV æ–‡ä»¶é‡‡ç”¨ UTF-8 ç¼–ç ï¼Œè¿™æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„å­—ç¬¦ç¼–ç ï¼Œæ”¯æŒåŒ…æ‹¬ä¸­æ–‡åœ¨å†…çš„å¤šç§è¯­è¨€ã€‚ç„¶è€Œ Microsoft Excel ä¼šé»˜è®¤ä½¿ç”¨ ANSI ç¼–ç æ¥è§£ææ–‡ä»¶ï¼Œè€Œ ANSI ç¼–ç å®é™…ä¸Šæ˜¯ä¾èµ–äºç³»ç»ŸåŒºåŸŸè®¾ç½®çš„ç‰¹å®šç¼–ç ï¼Œæ¯”å¦‚åœ¨ä¸­æ–‡ Windows ç³»ç»Ÿä¸­é€šå¸¸æ˜¯GBKã€‚</p>
<h3 id="è§£å†³æ–¹æ¡ˆ"><a aria-hidden="true" tabindex="-1" href="#è§£å†³æ–¹æ¡ˆ"><span class="icon icon-link"></span></a>è§£å†³æ–¹æ¡ˆ</h3>
<ol>
<li>
<p>ä¿®æ”¹csvæ–‡ä»¶ç¼–ç æ ¼å¼ã€‚ æ‰§è¡Œå‘½ä»¤ <code>iconv -f UTF-8 -t GB18030 old_file.csv > new_file.csv</code>ï¼ˆåœ¨ macos ä¸­èƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œï¼Œè‹¥ Windows æ— æ³•æ‰§è¡Œéœ€å¯»æ‰¾æ›¿ä»£æ–¹æ¡ˆï¼Œä¾‹å¦‚ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆå¦‚Notepad++ï¼‰çš„å¦å­˜ä¸ºåŠŸèƒ½ï¼Œé€‰æ‹©GBKä½œä¸ºä¿å­˜ç¼–ç ï¼‰ï¼Œé‡æ–°ç”Ÿæˆçš„ new_file ä¾¿èƒ½æ­£å¸¸åœ¨ Microsoft Excel ä¸­æ˜¾ç¤ºä¸­æ–‡äº†ã€‚
å°½ç®¡ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·è¿›è¡Œç¼–ç è½¬æ¢å¯¹äºæŠ€æœ¯ç”¨æˆ·æ¥è¯´æ˜¯ä¸€ä¸ªé«˜æ•ˆçš„æ–¹æ³•ï¼Œä½†ç¡®å®å¯èƒ½å¯¹æ™®é€šç”¨æˆ·æ¥è¯´æœ‰ä¸€å®šçš„ä½¿ç”¨é—¨æ§›ã€‚</p>
</li>
<li>
<p>ä½¿ç”¨ BOM æ¥è¿›è¡Œç¼–ç è¡¨ç¤ºã€‚ BOMæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å­—èŠ‚åºåˆ—ï¼Œç”¨äºæ ‡è¯†æ–‡ä»¶çš„ç¼–ç æ ¼å¼ã€‚UTF-8ç¼–ç çš„BOMå­—èŠ‚åºåˆ—æ˜¯<code>0xEF 0xBB 0xBF</code>ã€‚å½“Excelæ‰“å¼€å¸¦æœ‰BOMçš„CSVæ–‡ä»¶æ—¶ï¼ŒBOMå¸®åŠ©Excelè¯†åˆ«æ–‡ä»¶æ˜¯ä»¥UTF-8ç¼–ç çš„ï¼Œä»è€Œé¿å…äº†ä½¿ç”¨é”™è¯¯çš„ç¼–ç è§£ææ–‡ä»¶å†…å®¹ã€‚
ä»£ç æ¡ˆä¾‹ï¼š<a href="https://github.com/LZS911/csv-bom-excel-example">https://github.com/LZS911/csv-bom-excel-example</a> <sup><a href="#user-content-fn-2" id="user-content-fnref-2" data-footnote-ref aria-describedby="footnote-label">2</a></sup></p>
<p><img src="https://github.com/LZS911/LZS911.github.io/assets/42765421/260b5efb-a0a9-4b2b-a4ed-8e8e84a8ddd8" alt="image">
<img src="https://github.com/LZS911/LZS911.github.io/assets/42765421/aeade430-b59a-4e57-a92f-f81f1604f48e" alt="image"></p>
<blockquote>
<p>å…¶ä¸­æ–‡ä»¶å¤§å°ä¸º 60b çš„ä¸ºé™„å¸¦äº† BOM å­—èŠ‚çš„ csv æ–‡ä»¶</p>
</blockquote>
</li>
</ol>
<h2 id="response-typeåœ¨httpå“åº”ä¸­çš„ä½œç”¨"><a aria-hidden="true" tabindex="-1" href="#response-typeåœ¨httpå“åº”ä¸­çš„ä½œç”¨"><span class="icon icon-link"></span></a>Response-Typeåœ¨HTTPå“åº”ä¸­çš„ä½œç”¨</h2>
<p>æˆ‘ä»¬æ¥çœ‹ä¸€è¡Œä»£ç ï¼š <a href="https://github.com/LZS911/csv-bom-excel-example/blob/main/index.html#L15">https://github.com/LZS911/csv-bom-excel-example/blob/main/index.html#L15</a></p>
<p>é¦–å…ˆäº†è§£ä¸‹ ResponseType<sup><a href="#user-content-fn-3" id="user-content-fnref-3" data-footnote-ref aria-describedby="footnote-label">3</a></sup> çš„ä½œç”¨</p>
<blockquote>
<p><code>XMLHttpRequest</code> å±æ€§ <code>responseType</code> æ˜¯ä¸€ä¸ªæšä¸¾å­—ç¬¦ä¸²å€¼ï¼Œç”¨äºæŒ‡å®šå“åº”ä¸­åŒ…å«çš„æ•°æ®ç±»å‹ã€‚
å®ƒè¿˜å…è®¸ä½œè€…æ›´æ”¹å“åº”ç±»å‹ã€‚å¦‚æœå°† <code>responseType</code> çš„å€¼è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œåˆ™ä¼šä½¿ç”¨ <code>'text'</code> ä½œä¸ºé»˜è®¤å€¼ã€‚</p>
</blockquote>
<p>æ–‡ç« å¯èƒ½çœ‹çš„æœ‰ç‚¹è¿·ç³Šï¼Œæˆ‘ä»¬ç›´æ¥å°†è¿™è¡Œä»£ç æ³¨é‡Šï¼Œç„¶åè§‚å¯Ÿä¸‹è½½å¾—åˆ°çš„æ–‡ä»¶çš„è¡¨ç°
<img src="https://github.com/LZS911/LZS911.github.io/assets/42765421/d6084364-3e6b-4beb-a012-02efede30366" alt="image">
<img src="https://github.com/LZS911/LZS911.github.io/assets/42765421/0434db6d-3f2e-4ed1-aa37-c81b7bf6cd7f" alt="image"></p>
<p>å¯ä»¥å‘ç°ï¼Œå‰ç«¯è·å–åˆ°çš„ csv æ–‡ä»¶åˆä¸¢å¤±æ‰äº†åç«¯é™„åŠ çš„ BOM å­—èŠ‚ï¼Œå¯¼è‡´åœ¨ Microsoft Excel ä¸­å‡ºç°äº†ä¹±ç ã€‚</p>
<p>æ‰€ä»¥ï¼Œå¯ä»¥å¾—å‡ºç»“è®ºï¼š</p>
<p>å½“æœåŠ¡ç«¯ç«¯åœ¨è¿”å›æ•°æ®é¦–éƒ¨æ·»åŠ å­—èŠ‚<code>BOMï¼ˆByte Order Markï¼‰</code>æ—¶ï¼Œå‰ç«¯å¦‚æœæ²¡æœ‰ç‰¹åˆ«è®¾ç½® <code>XMLHttpRequestçš„responseType</code> ä¸º <code>'blob'</code>ï¼Œä¼šä¸¢å¤±BOMå­—èŠ‚ã€‚</p>
<p>è¿™æ˜¯å› ä¸º<code>XMLHttpRequest</code>çš„é»˜è®¤<code>responseType</code>æ˜¯ <code>'text'</code>ï¼Œå½“è®¾ç½®ä¸º<code>'text'</code>æ—¶ï¼Œæµè§ˆå™¨ä¼šå°è¯•å°†å“åº”ä½“è§£ç ä¸ºå­—ç¬¦ä¸²æ–‡æœ¬ã€‚</p>
<h2 id="å¦‚ä½•é¿å…bomå­—èŠ‚çš„ä¸¢å¤±"><a aria-hidden="true" tabindex="-1" href="#å¦‚ä½•é¿å…bomå­—èŠ‚çš„ä¸¢å¤±"><span class="icon icon-link"></span></a>å¦‚ä½•é¿å…BOMå­—èŠ‚çš„ä¸¢å¤±</h2>
<h3 id="åç«¯å¤„ç†"><a aria-hidden="true" tabindex="-1" href="#åç«¯å¤„ç†"><span class="icon icon-link"></span></a>åç«¯å¤„ç†</h3>
<p>åœ¨å‰ç«¯ä¸è¿›è¡Œä»»ä½•é¢å¤–çš„å¤„ç†æƒ…å†µä¸‹ï¼Œåç«¯å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²é¦–éƒ¨æ·»åŠ å­—èŠ‚ <code>\ufeff</code> çš„æ–¹å¼ã€‚ è§ä»£ç ï¼š<a href="https://github.com/LZS911/csv-bom-excel-example/blob/main/server.js#L5">https://github.com/LZS911/csv-bom-excel-example/blob/main/server.js#L5</a>ã€‚å½“ç„¶ï¼Œæœ€åä»£ç èƒ½ä¸èƒ½è¿‡ review å°±ä¸å¥½è¯´äº†ğŸ¤ªã€‚</p>
<h3 id="å‰ç«¯å¤„ç†"><a aria-hidden="true" tabindex="-1" href="#å‰ç«¯å¤„ç†"><span class="icon icon-link"></span></a>å‰ç«¯å¤„ç†</h3>
<ol>
<li>å‰ç«¯æ‰‹åŠ¨æ·»åŠ  <code>{responseType: 'blob'}</code>ï¼Œ å­˜åœ¨ä¸€å®šçš„å¿ƒæ™ºè´Ÿæ‹…ã€‚</li>
<li>ç»Ÿä¸€åœ¨è¯·æ±‚åœ¨ <code>context-type</code> ä¸º 'text/csv' çš„æƒ…å†µä¸‹ï¼Œåœ¨è¿”å›çš„dataå‰éƒ¨åŠ ä¸Š <code>\ufeff</code>ã€‚ åŒæ ·éœ€è¦ç»è¿‡ä»£ç  review çš„è€ƒéªŒã€‚</li>
</ol>
<h3 id="æœ€ä½³å®è·µ"><a aria-hidden="true" tabindex="-1" href="#æœ€ä½³å®è·µ"><span class="icon icon-link"></span></a>æœ€ä½³å®è·µ</h3>
<p>ç›®å‰å¯¹æ¯”ä¸‹æ¥ï¼Œä¸Šè¿°çš„å‡ ç§æ–¹æ¡ˆéƒ½ä¸æ˜¯ç‰¹åˆ«å®Œç¾ã€‚ä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»¼åˆåˆ©ç”¨é¡¹ç›®ä¸­ç°æœ‰çš„å·¥å…·å’Œæµç¨‹æ¥æ‰¾å¯»åˆ°æœ€ä½³å®è·µã€‚</p>
<p>æˆ‘ä»¬çš„å‰ç«¯é¡¹ç›®ä½¿ç”¨äº† <code>Typescript</code>ï¼Œå¹¶ä¸” api å®šä¹‰éƒ¨åˆ†ä½¿ç”¨ä¸€æ®µè„šæœ¬é€šè¿‡è·å–åç«¯çš„ swagger.json æ–‡ä»¶æ¥è‡ªåŠ¨ç”Ÿæˆï¼Œä¾‹å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼š<a href="https://github.com/actiontech/dms-ui/blob/08f7de1a9e724008e18f73e498eaa9aca456ed1d/packages/shared/lib/api/sqle/service/task/index.ts#L206">https://github.com/actiontech/dms-ui/blob/08f7de1a9e724008e18f73e498eaa9aca456ed1d/packages/shared/lib/api/sqle/service/task/index.ts#L206</a></p>
<p><img src="https://github.com/LZS911/LZS911.github.io/assets/42765421/0ca221f5-4417-4d12-b257-08c90d5ab709" alt="image"></p>
<p>äºæ˜¯æˆ‘ä»¬å¯ä»¥æ ¹æ®åç«¯çš„ swagger å®šä¹‰ï¼Œç¡®å®šéœ€è¦è®¾ç½® {responseType: 'blob'} çš„æ¥å£ï¼Œç„¶ååœ¨ api æ¨¡æ¿éƒ¨åˆ†è‡ªåŠ¨æ·»åŠ ä¸Šè¯¥å‚æ•°ï¼Œä¾¿èƒ½å‡å°‘å¿ƒæ™ºè´Ÿæ‹…ï¼Œç¡®ä¿è¯¥å‚æ•°çš„å­˜åœ¨ã€‚</p>
<h2 id="ç»“è¯­4"><a aria-hidden="true" tabindex="-1" href="#ç»“è¯­4"><span class="icon icon-link"></span></a>ç»“è¯­<sup><a href="#user-content-fn-4" id="user-content-fnref-4" data-footnote-ref aria-describedby="footnote-label">4</a></sup></h2>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æ·±å…¥æ¢è®¨äº†åœ¨ Web å¼€å‘è¿‡ç¨‹ä¸­å¤„ç†CSVæ–‡ä»¶æ—¶å¯èƒ½ä¼šé‡åˆ°çš„ä¸€ä¸ªæ£˜æ‰‹é—®é¢˜â€”â€”ä¹±ç ï¼Œä»¥åŠä¸ä¹‹ç›¸å…³çš„æŠ€æœ¯ç»†èŠ‚ã€‚æˆ‘ä»¬åˆ†æäº†ä¹±ç äº§ç”Ÿçš„åŸå› ï¼Œä¸»è¦é›†ä¸­åœ¨å­—ç¬¦ç¼–ç çš„ä¸åŒ¹é…ï¼Œå°¤å…¶æ˜¯å½“ CSV æ–‡ä»¶ä½¿ç”¨ UTF-8 ç¼–ç ä¸”å¸¦æœ‰BOMå­—èŠ‚ï¼Œè€Œå‰ç«¯æˆ– Excel ç­‰ç”µå­è¡¨æ ¼è½¯ä»¶æœªèƒ½æ­£ç¡®è¯†åˆ«å’Œå¤„ç†è¿™äº›å­—èŠ‚æ—¶ã€‚
é€šè¿‡æä¾›ä¸€ç³»åˆ—çš„è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬åœ¨æœåŠ¡ç«¯æ­£ç¡®è®¾ç½® HTTP å“åº”çš„<code>Content-Type</code>å¤´éƒ¨ï¼Œä»¥åŠåœ¨å‰ç«¯é€šè¿‡<code>XMLHttpRequest</code>ä»¥é€‚å½“çš„<code>responseType</code>æ¥æ”¶äºŒè¿›åˆ¶æ•°æ®ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•æœ‰æ•ˆåœ°é¿å…æ•°æ®åœ¨ä¼ è¾“å’ŒåŠ è½½è¿‡ç¨‹ä¸­å‡ºç°ä¹±ç ã€‚</p>
<h2 id="é™„å½•"><a aria-hidden="true" tabindex="-1" href="#é™„å½•"><span class="icon icon-link"></span></a>é™„å½•</h2>
<blockquote>
<p>é€šè¿‡ <a href="https://kimi.moonshot.cn/">Kimi</a> è¾…åŠ©ç”Ÿæˆæ–‡ç« æ ‡é¢˜ä»¥åŠå…·ä½“å¤§çº²ï¼Œå¹¶ä¸”è¿›è¡Œç»†èŠ‚ä¼˜åŒ–ã€‚</p>
</blockquote>
<section data-footnotes class="footnotes"><h2 class="sr-only" id="footnote-label"><a aria-hidden="true" tabindex="-1" href="#footnote-label"><span class="icon icon-link"></span></a>Footnotes</h2>
<ol>
<li id="user-content-fn-1">
<p><a href="https://zhuanlan.zhihu.com/p/148209693">CSVæ–‡ä»¶ä¸Excelçš„å·®å¼‚</a> <a href="#user-content-fnref-1" data-footnote-backref class="data-footnote-backref" aria-label="Back to content">â†©</a></p>
</li>
<li id="user-content-fn-2">
<p><a href="https://github.com/LZS911/csv-bom-excel-example">ç¤ºä¾‹ä»£ç ç”± Kimi ç”Ÿæˆ</a> <a href="#user-content-fnref-2" data-footnote-backref class="data-footnote-backref" aria-label="Back to content">â†©</a></p>
</li>
<li id="user-content-fn-3">
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/responseType">ResponseType</a> <a href="#user-content-fnref-3" data-footnote-backref class="data-footnote-backref" aria-label="Back to content">â†©</a></p>
</li>
<li id="user-content-fn-4">
<p><a href="https://kimi.moonshot.cn/">æ¥è‡ª Kimi</a> <a href="#user-content-fnref-4" data-footnote-backref class="data-footnote-backref" aria-label="Back to content">â†©</a></p>
</li>
</ol>
</section></div></section></article></main><footer class="bg-neutral-50 border-t border-neutral-200 text-center text-xs opacity-50 py-4">Â© 2022,<!-- --> <a rel="noopener noreferrer" class="hover:underline hover:bg-indigo" href="https://github.com/LZS911" target="_blank">LZS_911</a>, build with<!-- --> <a rel="noopener noreferrer" class="underline hover:bg-indigo" href="https://nextjs.org/" target="_blank">Next.js</a> <!-- -->and<!-- --> <a rel="noopener noreferrer" class="underline hover:bg-indigo" href="https://pages.github.com/?(null)" target="_blank">GitHub Pages</a></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"è§£æå‰ç«¯æ•°æ®åŠ è½½ï¼šBOMå­—èŠ‚ã€Response-Typeä¸Excelæ–‡ä»¶å…¼å®¹æ€§","date":"2024-04-10","slug":"è§£æå‰ç«¯æ•°æ®åŠ è½½ï¼šBOMå­—èŠ‚ã€Response-Typeä¸Excelæ–‡ä»¶å…¼å®¹æ€§","author":"Ai.Haibara","content":"\u003ch2 id=\"å¼•è¨€\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#å¼•è¨€\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eå¼•è¨€\u003c/h2\u003e\n\u003cp\u003eåœ¨å¼€å‘ To B ç«¯çš„é¡¹ç›®æ—¶ï¼Œå¯¼å‡º CSV æ–‡ä»¶è¿›è¡Œæ•°æ®åˆ†ææ˜¯ä¸€é¡¹å¸¸è§„æ“ä½œã€‚ç„¶è€Œï¼Œè¿™ä¸€è¿‡ç¨‹å¹¶éæ€»æ˜¯é¡ºç•…æ— é˜»ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œå½“ä½ ä¿¡å¿ƒæ»¡æ»¡åœ°å°†ä¸€ä¸ª CSV æ–‡ä»¶æ‹–å…¥ Excel ï¼ŒæœŸå¾…çœ‹åˆ°ä¸€ä¸ªæ•´é½çš„æ•°æ®è¡¨æ ¼æ—¶ï¼Œå´é­é‡äº†ä¹±ç çš„å°´å°¬åœºæ™¯ã€‚è¿™ä¸ä»…ä»¤äººæ²®ä¸§ï¼Œè€Œä¸”å¯èƒ½ä¸¥é‡å½±å“å·¥ä½œæ•ˆç‡ã€‚é‚£ä¹ˆï¼ŒCSV æ–‡ä»¶ä¸ Excel ä¹‹é—´å­˜åœ¨å“ªäº›å·®å¼‚ï¼Ÿæˆ‘ä»¬å¦‚ä½•ç¡®ä¿åœ¨ Excel ä¸­èƒ½å¤Ÿæ­£å¸¸æ‰“å¼€ CSV æ–‡ä»¶ï¼Ÿ\u003c/p\u003e\n\u003cp\u003eæœ¬æ–‡å°†é’ˆå¯¹è¿™äº›ç–‘é—®å±•å¼€æ¢è®¨ï¼Œä»ä¸€æ¬¡ CSV æ–‡ä»¶å¯¼å…¥ Excel æ—¶å‡ºç°çš„ä¹±ç é—®é¢˜å…¥æ‰‹ï¼Œé€æ­¥å‰–æèƒŒåçš„åŸå› ã€‚é‡ç‚¹æ¢è®¨\u003ccode\u003eBOMï¼ˆByte Order Markï¼‰\u003c/code\u003eå­—èŠ‚å’Œ HTTP å“åº”ä¸­çš„\u003ccode\u003eContent-Type\u003c/code\u003eå¦‚ä½•å½±å“å‰ç«¯å¯¹æ•°æ®çš„åŠ è½½å’Œè§£æï¼Œä»¥åŠè¿™äº›å› ç´ å¯¹ Excel æ–‡ä»¶å…¼å®¹æ€§çš„å½±å“ã€‚\u003c/p\u003e\n\u003ch2 id=\"csvæ–‡ä»¶ä¸excelçš„å·®å¼‚-1\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#csvæ–‡ä»¶ä¸excelçš„å·®å¼‚-1\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eCSVæ–‡ä»¶ä¸Excelçš„å·®å¼‚ \u003csup\u003e\u003ca href=\"#user-content-fn-1\" id=\"user-content-fnref-1\" data-footnote-ref aria-describedby=\"footnote-label\"\u003e1\u003c/a\u003e\u003c/sup\u003e\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eExcelæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå®ƒä¿å­˜æœ‰å…³å·¥ä½œç°¿ä¸­æ‰€æœ‰å·¥ä½œè¡¨çš„ä¿¡æ¯ã€‚CSVä»£è¡¨ Comma Separated Values ã€‚è¿™æ˜¯ä¸€ä¸ªçº¯æ–‡æœ¬æ ¼å¼ï¼Œç”¨é€—å·åˆ†éš”ä¸€ç³»åˆ—å€¼ã€‚\u003c/li\u003e\n\u003cli\u003eExcelä¸ä»…å¯ä»¥å­˜å‚¨æ•°æ®ï¼Œè¿˜å¯ä»¥å¯¹æ•°æ®è¿›è¡Œæ“ä½œã€‚CSVæ–‡ä»¶åªæ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå®ƒå­˜å‚¨æ•°æ®ï¼Œä½†ä¸åŒ…å«æ ¼å¼ï¼Œå…¬å¼ï¼Œå®ç­‰ã€‚å®ƒä¹Ÿè¢«ç§°ä¸ºå¹³é¢æ–‡ä»¶ã€‚\u003c/li\u003e\n\u003cli\u003eExcelæ˜¯ä¸€ä¸ªç”µå­è¡¨æ ¼ï¼Œå°†æ–‡ä»¶ä¿å­˜ä¸ºè‡ªå·±çš„ä¸“æœ‰æ ¼å¼ï¼Œå³xlsæˆ–xlsxã€‚CSVæ˜¯å°†è¡¨æ ¼ä¿¡æ¯ä¿å­˜ä¸ºæ‰©å±•åä¸º.csvçš„åˆ†éš”æ–‡æœ¬æ–‡ä»¶çš„æ ¼å¼ã€‚\u003c/li\u003e\n\u003cli\u003eä¿å­˜åœ¨excelä¸­çš„æ–‡ä»¶ä¸èƒ½è¢«æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€æˆ–ç¼–è¾‘ã€‚CSVæ–‡ä»¶å¯ä»¥é€šè¿‡æ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆå¦‚è®°äº‹æœ¬ï¼‰æ‰“å¼€æˆ–ç¼–è¾‘ã€‚\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"bomå­—èŠ‚çš„æ¦‚å¿µä¸ä½œç”¨\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#bomå­—èŠ‚çš„æ¦‚å¿µä¸ä½œç”¨\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eBOMå­—èŠ‚çš„æ¦‚å¿µä¸ä½œç”¨\u003c/h2\u003e\n\u003cp\u003eåœ¨è§£é‡ŠBOMå­—èŠ‚å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹ CSV æ–‡ä»¶åœ¨ WPS å’Œ Microsoft Excel ä¸­çš„è¡¨ç°åŒºåˆ«\u003c/p\u003e\n\u003ch3 id=\"wps\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#wps\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eWPS\u003c/h3\u003e\n\u003cp\u003e\u003cimg src=\"https://github.com/LZS911/LZS911.github.io/assets/42765421/6c8989cf-0386-4f4b-bcdb-1dfef747f2dc\" alt=\"image\"\u003e\u003c/p\u003e\n\u003ch3 id=\"microsoft-excel\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#microsoft-excel\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eMicrosoft Excel\u003c/h3\u003e\n\u003cp\u003e\u003cimg src=\"https://github.com/LZS911/LZS911.github.io/assets/42765421/1eb61e35-19f5-4aaa-b1fa-b0f6a5be24f7\" alt=\"image\"\u003e\u003c/p\u003e\n\u003ch3 id=\"ä¸ºä»€ä¹ˆä¼šå‡ºç°ä¸­æ–‡ä¹±ç \"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#ä¸ºä»€ä¹ˆä¼šå‡ºç°ä¸­æ–‡ä¹±ç \"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eä¸ºä»€ä¹ˆä¼šå‡ºç°ä¸­æ–‡ä¹±ç ï¼Ÿ\u003c/h3\u003e\n\u003cp\u003eå½“å‡ºç°ä¹±ç åï¼Œé¦–å…ˆåº”è¯¥è€ƒè™‘çš„æ˜¯æ–‡ä»¶çš„ç¼–ç æ ¼å¼é—®é¢˜ã€‚é€šå¸¸ï¼ŒCSV æ–‡ä»¶é‡‡ç”¨ UTF-8 ç¼–ç ï¼Œè¿™æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„å­—ç¬¦ç¼–ç ï¼Œæ”¯æŒåŒ…æ‹¬ä¸­æ–‡åœ¨å†…çš„å¤šç§è¯­è¨€ã€‚ç„¶è€Œ Microsoft Excel ä¼šé»˜è®¤ä½¿ç”¨ ANSI ç¼–ç æ¥è§£ææ–‡ä»¶ï¼Œè€Œ ANSI ç¼–ç å®é™…ä¸Šæ˜¯ä¾èµ–äºç³»ç»ŸåŒºåŸŸè®¾ç½®çš„ç‰¹å®šç¼–ç ï¼Œæ¯”å¦‚åœ¨ä¸­æ–‡ Windows ç³»ç»Ÿä¸­é€šå¸¸æ˜¯GBKã€‚\u003c/p\u003e\n\u003ch3 id=\"è§£å†³æ–¹æ¡ˆ\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#è§£å†³æ–¹æ¡ˆ\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eè§£å†³æ–¹æ¡ˆ\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eä¿®æ”¹csvæ–‡ä»¶ç¼–ç æ ¼å¼ã€‚ æ‰§è¡Œå‘½ä»¤ \u003ccode\u003eiconv -f UTF-8 -t GB18030 old_file.csv \u003e new_file.csv\u003c/code\u003eï¼ˆåœ¨ macos ä¸­èƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œï¼Œè‹¥ Windows æ— æ³•æ‰§è¡Œéœ€å¯»æ‰¾æ›¿ä»£æ–¹æ¡ˆï¼Œä¾‹å¦‚ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆå¦‚Notepad++ï¼‰çš„å¦å­˜ä¸ºåŠŸèƒ½ï¼Œé€‰æ‹©GBKä½œä¸ºä¿å­˜ç¼–ç ï¼‰ï¼Œé‡æ–°ç”Ÿæˆçš„ new_file ä¾¿èƒ½æ­£å¸¸åœ¨ Microsoft Excel ä¸­æ˜¾ç¤ºä¸­æ–‡äº†ã€‚\nå°½ç®¡ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·è¿›è¡Œç¼–ç è½¬æ¢å¯¹äºæŠ€æœ¯ç”¨æˆ·æ¥è¯´æ˜¯ä¸€ä¸ªé«˜æ•ˆçš„æ–¹æ³•ï¼Œä½†ç¡®å®å¯èƒ½å¯¹æ™®é€šç”¨æˆ·æ¥è¯´æœ‰ä¸€å®šçš„ä½¿ç”¨é—¨æ§›ã€‚\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eä½¿ç”¨ BOM æ¥è¿›è¡Œç¼–ç è¡¨ç¤ºã€‚ BOMæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å­—èŠ‚åºåˆ—ï¼Œç”¨äºæ ‡è¯†æ–‡ä»¶çš„ç¼–ç æ ¼å¼ã€‚UTF-8ç¼–ç çš„BOMå­—èŠ‚åºåˆ—æ˜¯\u003ccode\u003e0xEF 0xBB 0xBF\u003c/code\u003eã€‚å½“Excelæ‰“å¼€å¸¦æœ‰BOMçš„CSVæ–‡ä»¶æ—¶ï¼ŒBOMå¸®åŠ©Excelè¯†åˆ«æ–‡ä»¶æ˜¯ä»¥UTF-8ç¼–ç çš„ï¼Œä»è€Œé¿å…äº†ä½¿ç”¨é”™è¯¯çš„ç¼–ç è§£ææ–‡ä»¶å†…å®¹ã€‚\nä»£ç æ¡ˆä¾‹ï¼š\u003ca href=\"https://github.com/LZS911/csv-bom-excel-example\"\u003ehttps://github.com/LZS911/csv-bom-excel-example\u003c/a\u003e \u003csup\u003e\u003ca href=\"#user-content-fn-2\" id=\"user-content-fnref-2\" data-footnote-ref aria-describedby=\"footnote-label\"\u003e2\u003c/a\u003e\u003c/sup\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://github.com/LZS911/LZS911.github.io/assets/42765421/260b5efb-a0a9-4b2b-a4ed-8e8e84a8ddd8\" alt=\"image\"\u003e\n\u003cimg src=\"https://github.com/LZS911/LZS911.github.io/assets/42765421/aeade430-b59a-4e57-a92f-f81f1604f48e\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eå…¶ä¸­æ–‡ä»¶å¤§å°ä¸º 60b çš„ä¸ºé™„å¸¦äº† BOM å­—èŠ‚çš„ csv æ–‡ä»¶\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"response-typeåœ¨httpå“åº”ä¸­çš„ä½œç”¨\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#response-typeåœ¨httpå“åº”ä¸­çš„ä½œç”¨\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eResponse-Typeåœ¨HTTPå“åº”ä¸­çš„ä½œç”¨\u003c/h2\u003e\n\u003cp\u003eæˆ‘ä»¬æ¥çœ‹ä¸€è¡Œä»£ç ï¼š \u003ca href=\"https://github.com/LZS911/csv-bom-excel-example/blob/main/index.html#L15\"\u003ehttps://github.com/LZS911/csv-bom-excel-example/blob/main/index.html#L15\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eé¦–å…ˆäº†è§£ä¸‹ ResponseType\u003csup\u003e\u003ca href=\"#user-content-fn-3\" id=\"user-content-fnref-3\" data-footnote-ref aria-describedby=\"footnote-label\"\u003e3\u003c/a\u003e\u003c/sup\u003e çš„ä½œç”¨\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003eXMLHttpRequest\u003c/code\u003e å±æ€§ \u003ccode\u003eresponseType\u003c/code\u003e æ˜¯ä¸€ä¸ªæšä¸¾å­—ç¬¦ä¸²å€¼ï¼Œç”¨äºæŒ‡å®šå“åº”ä¸­åŒ…å«çš„æ•°æ®ç±»å‹ã€‚\nå®ƒè¿˜å…è®¸ä½œè€…æ›´æ”¹å“åº”ç±»å‹ã€‚å¦‚æœå°† \u003ccode\u003eresponseType\u003c/code\u003e çš„å€¼è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œåˆ™ä¼šä½¿ç”¨ \u003ccode\u003e'text'\u003c/code\u003e ä½œä¸ºé»˜è®¤å€¼ã€‚\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eæ–‡ç« å¯èƒ½çœ‹çš„æœ‰ç‚¹è¿·ç³Šï¼Œæˆ‘ä»¬ç›´æ¥å°†è¿™è¡Œä»£ç æ³¨é‡Šï¼Œç„¶åè§‚å¯Ÿä¸‹è½½å¾—åˆ°çš„æ–‡ä»¶çš„è¡¨ç°\n\u003cimg src=\"https://github.com/LZS911/LZS911.github.io/assets/42765421/d6084364-3e6b-4beb-a012-02efede30366\" alt=\"image\"\u003e\n\u003cimg src=\"https://github.com/LZS911/LZS911.github.io/assets/42765421/0434db6d-3f2e-4ed1-aa37-c81b7bf6cd7f\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003eå¯ä»¥å‘ç°ï¼Œå‰ç«¯è·å–åˆ°çš„ csv æ–‡ä»¶åˆä¸¢å¤±æ‰äº†åç«¯é™„åŠ çš„ BOM å­—èŠ‚ï¼Œå¯¼è‡´åœ¨ Microsoft Excel ä¸­å‡ºç°äº†ä¹±ç ã€‚\u003c/p\u003e\n\u003cp\u003eæ‰€ä»¥ï¼Œå¯ä»¥å¾—å‡ºç»“è®ºï¼š\u003c/p\u003e\n\u003cp\u003eå½“æœåŠ¡ç«¯ç«¯åœ¨è¿”å›æ•°æ®é¦–éƒ¨æ·»åŠ å­—èŠ‚\u003ccode\u003eBOMï¼ˆByte Order Markï¼‰\u003c/code\u003eæ—¶ï¼Œå‰ç«¯å¦‚æœæ²¡æœ‰ç‰¹åˆ«è®¾ç½® \u003ccode\u003eXMLHttpRequestçš„responseType\u003c/code\u003e ä¸º \u003ccode\u003e'blob'\u003c/code\u003eï¼Œä¼šä¸¢å¤±BOMå­—èŠ‚ã€‚\u003c/p\u003e\n\u003cp\u003eè¿™æ˜¯å› ä¸º\u003ccode\u003eXMLHttpRequest\u003c/code\u003eçš„é»˜è®¤\u003ccode\u003eresponseType\u003c/code\u003eæ˜¯ \u003ccode\u003e'text'\u003c/code\u003eï¼Œå½“è®¾ç½®ä¸º\u003ccode\u003e'text'\u003c/code\u003eæ—¶ï¼Œæµè§ˆå™¨ä¼šå°è¯•å°†å“åº”ä½“è§£ç ä¸ºå­—ç¬¦ä¸²æ–‡æœ¬ã€‚\u003c/p\u003e\n\u003ch2 id=\"å¦‚ä½•é¿å…bomå­—èŠ‚çš„ä¸¢å¤±\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#å¦‚ä½•é¿å…bomå­—èŠ‚çš„ä¸¢å¤±\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eå¦‚ä½•é¿å…BOMå­—èŠ‚çš„ä¸¢å¤±\u003c/h2\u003e\n\u003ch3 id=\"åç«¯å¤„ç†\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#åç«¯å¤„ç†\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eåç«¯å¤„ç†\u003c/h3\u003e\n\u003cp\u003eåœ¨å‰ç«¯ä¸è¿›è¡Œä»»ä½•é¢å¤–çš„å¤„ç†æƒ…å†µä¸‹ï¼Œåç«¯å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²é¦–éƒ¨æ·»åŠ å­—èŠ‚ \u003ccode\u003e\\ufeff\u003c/code\u003e çš„æ–¹å¼ã€‚ è§ä»£ç ï¼š\u003ca href=\"https://github.com/LZS911/csv-bom-excel-example/blob/main/server.js#L5\"\u003ehttps://github.com/LZS911/csv-bom-excel-example/blob/main/server.js#L5\u003c/a\u003eã€‚å½“ç„¶ï¼Œæœ€åä»£ç èƒ½ä¸èƒ½è¿‡ review å°±ä¸å¥½è¯´äº†ğŸ¤ªã€‚\u003c/p\u003e\n\u003ch3 id=\"å‰ç«¯å¤„ç†\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#å‰ç«¯å¤„ç†\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eå‰ç«¯å¤„ç†\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eå‰ç«¯æ‰‹åŠ¨æ·»åŠ  \u003ccode\u003e{responseType: 'blob'}\u003c/code\u003eï¼Œ å­˜åœ¨ä¸€å®šçš„å¿ƒæ™ºè´Ÿæ‹…ã€‚\u003c/li\u003e\n\u003cli\u003eç»Ÿä¸€åœ¨è¯·æ±‚åœ¨ \u003ccode\u003econtext-type\u003c/code\u003e ä¸º 'text/csv' çš„æƒ…å†µä¸‹ï¼Œåœ¨è¿”å›çš„dataå‰éƒ¨åŠ ä¸Š \u003ccode\u003e\\ufeff\u003c/code\u003eã€‚ åŒæ ·éœ€è¦ç»è¿‡ä»£ç  review çš„è€ƒéªŒã€‚\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"æœ€ä½³å®è·µ\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#æœ€ä½³å®è·µ\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eæœ€ä½³å®è·µ\u003c/h3\u003e\n\u003cp\u003eç›®å‰å¯¹æ¯”ä¸‹æ¥ï¼Œä¸Šè¿°çš„å‡ ç§æ–¹æ¡ˆéƒ½ä¸æ˜¯ç‰¹åˆ«å®Œç¾ã€‚ä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»¼åˆåˆ©ç”¨é¡¹ç›®ä¸­ç°æœ‰çš„å·¥å…·å’Œæµç¨‹æ¥æ‰¾å¯»åˆ°æœ€ä½³å®è·µã€‚\u003c/p\u003e\n\u003cp\u003eæˆ‘ä»¬çš„å‰ç«¯é¡¹ç›®ä½¿ç”¨äº† \u003ccode\u003eTypescript\u003c/code\u003eï¼Œå¹¶ä¸” api å®šä¹‰éƒ¨åˆ†ä½¿ç”¨ä¸€æ®µè„šæœ¬é€šè¿‡è·å–åç«¯çš„ swagger.json æ–‡ä»¶æ¥è‡ªåŠ¨ç”Ÿæˆï¼Œä¾‹å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼š\u003ca href=\"https://github.com/actiontech/dms-ui/blob/08f7de1a9e724008e18f73e498eaa9aca456ed1d/packages/shared/lib/api/sqle/service/task/index.ts#L206\"\u003ehttps://github.com/actiontech/dms-ui/blob/08f7de1a9e724008e18f73e498eaa9aca456ed1d/packages/shared/lib/api/sqle/service/task/index.ts#L206\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://github.com/LZS911/LZS911.github.io/assets/42765421/0ca221f5-4417-4d12-b257-08c90d5ab709\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003eäºæ˜¯æˆ‘ä»¬å¯ä»¥æ ¹æ®åç«¯çš„ swagger å®šä¹‰ï¼Œç¡®å®šéœ€è¦è®¾ç½® {responseType: 'blob'} çš„æ¥å£ï¼Œç„¶ååœ¨ api æ¨¡æ¿éƒ¨åˆ†è‡ªåŠ¨æ·»åŠ ä¸Šè¯¥å‚æ•°ï¼Œä¾¿èƒ½å‡å°‘å¿ƒæ™ºè´Ÿæ‹…ï¼Œç¡®ä¿è¯¥å‚æ•°çš„å­˜åœ¨ã€‚\u003c/p\u003e\n\u003ch2 id=\"ç»“è¯­4\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#ç»“è¯­4\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eç»“è¯­\u003csup\u003e\u003ca href=\"#user-content-fn-4\" id=\"user-content-fnref-4\" data-footnote-ref aria-describedby=\"footnote-label\"\u003e4\u003c/a\u003e\u003c/sup\u003e\u003c/h2\u003e\n\u003cp\u003eåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æ·±å…¥æ¢è®¨äº†åœ¨ Web å¼€å‘è¿‡ç¨‹ä¸­å¤„ç†CSVæ–‡ä»¶æ—¶å¯èƒ½ä¼šé‡åˆ°çš„ä¸€ä¸ªæ£˜æ‰‹é—®é¢˜â€”â€”ä¹±ç ï¼Œä»¥åŠä¸ä¹‹ç›¸å…³çš„æŠ€æœ¯ç»†èŠ‚ã€‚æˆ‘ä»¬åˆ†æäº†ä¹±ç äº§ç”Ÿçš„åŸå› ï¼Œä¸»è¦é›†ä¸­åœ¨å­—ç¬¦ç¼–ç çš„ä¸åŒ¹é…ï¼Œå°¤å…¶æ˜¯å½“ CSV æ–‡ä»¶ä½¿ç”¨ UTF-8 ç¼–ç ä¸”å¸¦æœ‰BOMå­—èŠ‚ï¼Œè€Œå‰ç«¯æˆ– Excel ç­‰ç”µå­è¡¨æ ¼è½¯ä»¶æœªèƒ½æ­£ç¡®è¯†åˆ«å’Œå¤„ç†è¿™äº›å­—èŠ‚æ—¶ã€‚\né€šè¿‡æä¾›ä¸€ç³»åˆ—çš„è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬åœ¨æœåŠ¡ç«¯æ­£ç¡®è®¾ç½® HTTP å“åº”çš„\u003ccode\u003eContent-Type\u003c/code\u003eå¤´éƒ¨ï¼Œä»¥åŠåœ¨å‰ç«¯é€šè¿‡\u003ccode\u003eXMLHttpRequest\u003c/code\u003eä»¥é€‚å½“çš„\u003ccode\u003eresponseType\u003c/code\u003eæ¥æ”¶äºŒè¿›åˆ¶æ•°æ®ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•æœ‰æ•ˆåœ°é¿å…æ•°æ®åœ¨ä¼ è¾“å’ŒåŠ è½½è¿‡ç¨‹ä¸­å‡ºç°ä¹±ç ã€‚\u003c/p\u003e\n\u003ch2 id=\"é™„å½•\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#é™„å½•\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eé™„å½•\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eé€šè¿‡ \u003ca href=\"https://kimi.moonshot.cn/\"\u003eKimi\u003c/a\u003e è¾…åŠ©ç”Ÿæˆæ–‡ç« æ ‡é¢˜ä»¥åŠå…·ä½“å¤§çº²ï¼Œå¹¶ä¸”è¿›è¡Œç»†èŠ‚ä¼˜åŒ–ã€‚\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003csection data-footnotes class=\"footnotes\"\u003e\u003ch2 class=\"sr-only\" id=\"footnote-label\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#footnote-label\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eFootnotes\u003c/h2\u003e\n\u003col\u003e\n\u003cli id=\"user-content-fn-1\"\u003e\n\u003cp\u003e\u003ca href=\"https://zhuanlan.zhihu.com/p/148209693\"\u003eCSVæ–‡ä»¶ä¸Excelçš„å·®å¼‚\u003c/a\u003e \u003ca href=\"#user-content-fnref-1\" data-footnote-backref class=\"data-footnote-backref\" aria-label=\"Back to content\"\u003eâ†©\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli id=\"user-content-fn-2\"\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/LZS911/csv-bom-excel-example\"\u003eç¤ºä¾‹ä»£ç ç”± Kimi ç”Ÿæˆ\u003c/a\u003e \u003ca href=\"#user-content-fnref-2\" data-footnote-backref class=\"data-footnote-backref\" aria-label=\"Back to content\"\u003eâ†©\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli id=\"user-content-fn-3\"\u003e\n\u003cp\u003e\u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/responseType\"\u003eResponseType\u003c/a\u003e \u003ca href=\"#user-content-fnref-3\" data-footnote-backref class=\"data-footnote-backref\" aria-label=\"Back to content\"\u003eâ†©\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli id=\"user-content-fn-4\"\u003e\n\u003cp\u003e\u003ca href=\"https://kimi.moonshot.cn/\"\u003eæ¥è‡ª Kimi\u003c/a\u003e \u003ca href=\"#user-content-fnref-4\" data-footnote-backref class=\"data-footnote-backref\" aria-label=\"Back to content\"\u003eâ†©\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/section\u003e","theme":"fancy","tag":[null]}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"è§£æå‰ç«¯æ•°æ®åŠ è½½ï¼šBOMå­—èŠ‚ã€Response-Typeä¸Excelæ–‡ä»¶å…¼å®¹æ€§"},"buildId":"5nPQWyP3XMPyYl2FPDKAk","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>