<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#000000"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><meta property="og:image" content="https://og-image.vercel.app/Next.js%20Blog%20Starter%20Example.png?theme=light&amp;md=1&amp;fontSize=100px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg"/><title>如何实现一个EventEmit? | Ai.Haibara codes</title><meta name="next-head-count" content="14"/><link rel="preload" href="/_next/static/css/a5eda337cc81d9ab.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a5eda337cc81d9ab.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee7e63bc15b31913.js" defer=""></script><script src="/_next/static/chunks/framework-3b5a00d5d7e8d93b.js" defer=""></script><script src="/_next/static/chunks/main-319e858aa81ca629.js" defer=""></script><script src="/_next/static/chunks/pages/_app-91d7f786791773ad.js" defer=""></script><script src="/_next/static/chunks/799-575b46febca3af7d.js" defer=""></script><script src="/_next/static/chunks/642-f55f53346f993b53.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-23138caee0f75470.js" defer=""></script><script src="/_next/static/yIbYpMrVODDFyEXyLGSSq/_buildManifest.js" defer=""></script><script src="/_next/static/yIbYpMrVODDFyEXyLGSSq/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen"><header class="text-white bg-black drop-shadow-2xl"><div class="mx-auto my-0 max-w-[960px] py-6 px-4 flex items-center"><div class="flex items-center"><img alt="Ai.Haibara" src="/assets/blog/authors/haibara_2.jpg" width="100" height="100" decoding="async" data-nimg="1" class=" rounded-full" loading="lazy" style="color:transparent"/></div><div class="ml-6"><a class=" font-bold text-3xl" href="/">Ai.Haibara codes</a><div class="mt-2"><a class="p-1 rounded-sm text-xl mr-2 hover:border-b-2 border-indigo" href="/">Home</a><a class="p-1 rounded-sm text-xl mr-2 hover:border-b-2 border-indigo" href="/projects">Projects</a><a class="p-1 rounded-sm text-xl mr-2 hover:border-b-2 border-indigo" href="/talks">Talks</a><a class="p-1 rounded-sm text-xl mr-2 hover:border-b-2 border-indigo" href="/blogs">Blogs</a></div></div></div></header><main class="p-6 flex justify-center"><article><div class="flex justify-center font-[Arial] max-w-[864px] text-center"><h1 class="text-5xl font-bold bg-indigo px-5 py-2 rounded-sm text-shadow-lg leading-[1.1]">如何实现一个EventEmit?</h1></div><time dateTime="2022-09-07" class="text-center block my-4 text-sm opacity-60">September	7, 2022</time><section><div class="markdown-body-orange max-w-3xl"><h2 id="eventemit-简介"><a aria-hidden="true" tabindex="-1" href="#eventemit-简介"><span class="icon icon-link"></span></a>EventEmit 简介</h2>
<p><code>node.js</code> 所有的异步 <code>I/O</code> 操作在完成时都会发送一个事件到事件队列. 一个 <code>fs.readStream</code> 对象会在文件被打开的时候触发一个事件. 所有这些产生事件的对象都是 <code>events.EventEmitter</code> 的实例.</p>
<p><code>EventEmit</code> 是 <code>node.js</code> 内置模块 <code>events</code> 提供的一个 <code>class</code>, 在 <code>node.js</code> 环境中可以直接 <code>require</code> 后使用. 在 <code>web</code> 环境中我们可以使用第三方 <code>npm</code> 包或者原生的 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/EventTarget">EventTarget</a>. 当然, 也可以自己实现一个类似 <code>node.js</code> 的简易版本.</p>
<p>我们先来看下 <code>EventEmit</code> 的基本使用方法:</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> { <span class="hljs-title class_">EventEmitter</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'node:events'</span>);

<span class="hljs-keyword">const</span> event = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventEmitter</span>();

<span class="hljs-keyword">const</span> <span class="hljs-title function_">fn</span> = (<span class="hljs-params"></span>) => {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'event 事件触发!'</span>);
};

<span class="hljs-comment">//为指定事件注册一个监听器</span>
event.<span class="hljs-title function_">addListener</span>(<span class="hljs-string">'event'</span>, fn);

<span class="hljs-comment">//触发监听器</span>
event.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'event'</span>);

<span class="hljs-comment">//移除监听器</span>
event.<span class="hljs-title function_">removeListener</span>(<span class="hljs-string">'event'</span>, fn);
</code></pre>
<p>其中, 当我们添加新的监听器时, <code>newListener</code> 事件会触发, <code>当监听器被移除时，removeListener</code> 事件被触发.</p>
<h3 id="实现的-api-介绍"><a aria-hidden="true" tabindex="-1" href="#实现的-api-介绍"><span class="icon icon-link"></span></a>实现的 Api 介绍</h3>
<ol>
<li>
<p><code>emitter.addListener(eventName, listener)</code> 为指定事件注册一个监听器，接受一个 <code>string</code> (或 <code>symbol</code>) 类型的 <code>eventName</code> 和一个回调函数. 返回值为 <code>EventEmit</code> 的实例, 以便链式调用.</p>
<ul>
<li><code>eventName</code> <code>&#x3C;string></code> | <code>&#x3C;symbol></code></li>
<li><code>listener</code> <code>&#x3C;Function></code></li>
<li><code>Returns</code> <code>&#x3C;EventEmit></code></li>
</ul>
</li>
<li>
<p><code>emitter.emit(eventName, [...args])</code> 同步调用为名为 <code>eventName</code> 的事件注册的每个监听器, 按照它们注册的顺序, 将提供的参数传递给每个侦听器, 如果存在该监听器, 则返回 <code>True</code>, 否则返回 <code>False</code></p>
<ul>
<li><code>eventName</code> <code>&#x3C;string></code> | <code>&#x3C;symbol></code></li>
<li><code>...args</code> <code>&#x3C;any></code></li>
<li><code>Returns</code> <code>&#x3C;boolean></code></li>
</ul>
</li>
<li>
<p><code>emitter.once(eventName, listener)</code> 和 <code>addListener</code> 类似, 但只触发一次, 随后便解除事件监听.</p>
</li>
<li>
<p><code>emitter.removeListener(eventName, listener)</code> 移除指定事件的某个监听回调.</p>
<ul>
<li><code>eventName</code> <code>&#x3C;string></code> | <code>&#x3C;symbol></code></li>
<li><code>listener</code> <code>&#x3C;Function></code></li>
<li><code>Returns</code> <code>&#x3C;EventEmit></code></li>
</ul>
</li>
<li>
<p><code>emitter.removeAllListeners([eventName])</code> 删除所有监听器, 或删除指定 <code>eventName</code> 的监听器.</p>
<ul>
<li><code>eventName</code> <code>&#x3C;string></code> | <code>&#x3C;symbol></code></li>
<li><code>Returns</code> <code>&#x3C;EventEmitter></code></li>
</ul>
</li>
<li>
<p><code>emitter.setMaxListeners(n)</code> 用于修改监听器的默认限制的数量. (默认大于 10 个监听回调时会产生警告)</p>
<ul>
<li><code>n</code> <code>&#x3C;integer></code></li>
<li><code>Returns</code> <code>&#x3C;EventEmitter></code></li>
</ul>
</li>
<li>
<p><code>emitter.getMaxListeners()</code> 获取限制监听器的数量</p>
</li>
<li>
<p><code>emitter.listeners(eventName)</code> 返回名为 <code>eventName</code> 的事件的监听器数组的副本.</p>
<ul>
<li><code>eventName</code> <code>&#x3C;string></code> | <code>&#x3C;symbol></code></li>
<li><code>Returns</code> <code>&#x3C;Function></code></li>
</ul>
</li>
<li>
<p><code>emitter.listenerCount(eventName)</code> 返回监听名为 <code>eventName</code> 的事件的监听器数量</p>
</li>
<li>
<p><code>emitter.on</code> <code>emitter.addListener</code>的别名函数</p>
</li>
<li>
<p><code>emitter.off</code> <code>emitter.removeListener</code>的别名函数</p>
</li>
</ol>
<h3 id="构造函数"><a aria-hidden="true" tabindex="-1" href="#构造函数"><span class="icon icon-link"></span></a>构造函数</h3>
<pre><code class="hljs language-javascript">  #maxListeners = <span class="hljs-number">10</span>;
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
    <span class="hljs-variable language_">this</span>.#maxListeners = <span class="hljs-number">10</span>;
  }
</code></pre>
<p>其中 <code>listeners</code> 的结构如下:</p>
<pre><code class="hljs language-JSON"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"event1"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>f1<span class="hljs-punctuation">,</span>f2<span class="hljs-punctuation">,</span>f3<span class="hljs-punctuation">]</span>，
  <span class="hljs-attr">"event2"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>f4<span class="hljs-punctuation">,</span>f5<span class="hljs-punctuation">]</span>，
  ...
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 id="addlistener-方法"><a aria-hidden="true" tabindex="-1" href="#addlistener-方法"><span class="icon icon-link"></span></a>addListener 方法</h3>
<ol>
<li>
<p>判断该事件监听器数组是否初始化，若未初始化，则将 <code>listeners[event]</code> 初始化为数组，并加入监听器 <code>cb</code>, 并触发 <code>newListener</code> 事件.</p>
</li>
<li>
<p>判断该事件的监听器数量是否已超限，超限则报警告.</p>
</li>
<li>
<p>判断数组中是否已存在 <code>cb</code>, 不存在则添加，已存在则不做操作.</p>
</li>
<li>
<p>指定 <code>on</code> 等于 <code>addListener</code> 方法</p>
</li>
</ol>
<pre><code class="hljs language-javascript">  <span class="hljs-title function_">addListener</span>(<span class="hljs-params">eventName, cb</span>) {
    <span class="hljs-keyword">if</span> (
      !<span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName || !<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName])]
    ) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName] = [cb];
      <span class="hljs-keyword">if</span> (eventName !== <span class="hljs-string">"newListener"</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"newListener"</span>);
      }
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName].<span class="hljs-property">length</span> >= <span class="hljs-variable language_">this</span>.#maxListeners) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(
        <span class="hljs-string">"MaxListenersExceededWarning: Possible EventEmitter memory leak detected. %d event6 listeners added to [EventEmitter]. Use emitter.setMaxListeners() to increase limit"</span>,
        <span class="hljs-variable language_">this</span>.#maxListeners
      );
    }

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName].<span class="hljs-title function_">push</span>(cb);
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

</code></pre>
<h3 id="emit-方法"><a aria-hidden="true" tabindex="-1" href="#emit-方法"><span class="icon icon-link"></span></a>emit 方法</h3>
<p>遍历监听器,通过 <code>apply</code> 方法把上面得到的 <code>args</code> 参数传进去, 需要注意的是不要漏了返回值.</p>
<pre><code class="hljs language-javascript">  <span class="hljs-title function_">emit</span>(<span class="hljs-params">eventName, ...args</span>) {
    <span class="hljs-keyword">const</span> isExistEvent =
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName] &#x26;&#x26; <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName].<span class="hljs-property">length</span> > <span class="hljs-number">0</span>;

    <span class="hljs-keyword">if</span> (isExistEvent) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName].<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">cb</span>) =></span> {
        cb.<span class="hljs-title function_">apply</span>(<span class="hljs-literal">null</span>, args);
      });
    }
    <span class="hljs-keyword">return</span> isExistEvent;
  }
</code></pre>
<h3 id="removelistener-方法"><a aria-hidden="true" tabindex="-1" href="#removelistener-方法"><span class="icon icon-link"></span></a>removeListener 方法</h3>
<pre><code class="hljs language-javascript">  <span class="hljs-title function_">removeListener</span>(<span class="hljs-params">eventName, listener</span>) {
    <span class="hljs-keyword">const</span> index = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName] || []).<span class="hljs-title function_">indexOf</span>(listener);
    <span class="hljs-keyword">if</span> (index !== -<span class="hljs-number">1</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName].<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
      <span class="hljs-keyword">if</span> (eventName !== <span class="hljs-string">"removeListener"</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"removeListener"</span>);
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }
</code></pre>
<h3 id="once-方法"><a aria-hidden="true" tabindex="-1" href="#once-方法"><span class="icon icon-link"></span></a>once 方法</h3>
<p><code>once</code> 方法是 <code>on</code> 方法和 <code>removeListener</code> 方法的结合：用 <code>on</code> 方法监听，在回调结束的最后位置，通过<code>removeListener</code> 删掉监听函数自身</p>
<pre><code class="hljs language-javascript">  <span class="hljs-title function_">once</span>(<span class="hljs-params">eventName, listener</span>) {
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">fn</span> = (<span class="hljs-params">...args</span>) => {
      listener.<span class="hljs-title function_">apply</span>(<span class="hljs-literal">null</span>, args);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeListener</span>(eventName, fn);
    };
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(eventName, fn);
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }
</code></pre>
<h3 id="removealllisteners-方法"><a aria-hidden="true" tabindex="-1" href="#removealllisteners-方法"><span class="icon icon-link"></span></a>removeAllListeners 方法</h3>
<pre><code class="hljs language-javascript">  <span class="hljs-title function_">removeAllListeners</span>(<span class="hljs-params">eventNames = []</span>) {
    <span class="hljs-keyword">if</span> (eventNames.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
    } <span class="hljs-keyword">else</span> {
      eventNames.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">v</span>) =></span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[v] = <span class="hljs-literal">null</span>;
      });
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }
</code></pre>
<h3 id="setmaxlistenersgetmaxlistenerslistenercountonoff-方法"><a aria-hidden="true" tabindex="-1" href="#setmaxlistenersgetmaxlistenerslistenercountonoff-方法"><span class="icon icon-link"></span></a>setMaxListeners、getMaxListeners、listenerCount、on、off 方法</h3>
<pre><code class="hljs language-javascript">  <span class="hljs-title function_">setMaxListeners</span>(<span class="hljs-params">maxListeners</span>) {
    <span class="hljs-variable language_">this</span>.#maxListeners = maxListeners;
  }
  <span class="hljs-title function_">getMaxListeners</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.#maxListeners;
  }
  <span class="hljs-title function_">listenerCount</span>(<span class="hljs-params">eventName</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName]?.<span class="hljs-property">length</span> ?? <span class="hljs-number">0</span>;
  }

  <span class="hljs-title class_">EventEmitter</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">on</span> = <span class="hljs-title class_">EventEmitter</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">addListener</span>;
  <span class="hljs-title class_">EventEmitter</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">off</span> = <span class="hljs-title class_">EventEmitter</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">removeListener</span>;
</code></pre>
<h4 id="完整代码地址-httpsgithubcomlzs911eventemit"><a aria-hidden="true" tabindex="-1" href="#完整代码地址-httpsgithubcomlzs911eventemit"><span class="icon icon-link"></span></a>完整代码地址: <a href="https://github.com/LZS911/EventEmit">https://github.com/LZS911/EventEmit</a></h4></div></section><div class="mt-10 max-w-3xl"><h3 class="text-2xl font-bold mb-4">评论</h3><p>加载评论中...</p></div></article></main><footer class="bg-neutral-50 border-t border-neutral-200 text-center text-xs opacity-50 py-4">© 2022,<!-- --> <a rel="noopener noreferrer" class="hover:underline hover:bg-indigo" href="https://github.com/LZS911" target="_blank">LZS_911</a>, build with<!-- --> <a rel="noopener noreferrer" class="underline hover:bg-indigo" href="https://nextjs.org/" target="_blank">Next.js</a> <!-- -->and<!-- --> <a rel="noopener noreferrer" class="underline hover:bg-indigo" href="https://pages.github.com/?(null)" target="_blank">GitHub Pages</a></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"如何实现一个EventEmit?","date":"2022-09-07","slug":"如何实现一个事件监听器EventEmit","author":"LZS_911","content":"\u003ch2 id=\"eventemit-简介\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#eventemit-简介\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eEventEmit 简介\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003enode.js\u003c/code\u003e 所有的异步 \u003ccode\u003eI/O\u003c/code\u003e 操作在完成时都会发送一个事件到事件队列. 一个 \u003ccode\u003efs.readStream\u003c/code\u003e 对象会在文件被打开的时候触发一个事件. 所有这些产生事件的对象都是 \u003ccode\u003eevents.EventEmitter\u003c/code\u003e 的实例.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eEventEmit\u003c/code\u003e 是 \u003ccode\u003enode.js\u003c/code\u003e 内置模块 \u003ccode\u003eevents\u003c/code\u003e 提供的一个 \u003ccode\u003eclass\u003c/code\u003e, 在 \u003ccode\u003enode.js\u003c/code\u003e 环境中可以直接 \u003ccode\u003erequire\u003c/code\u003e 后使用. 在 \u003ccode\u003eweb\u003c/code\u003e 环境中我们可以使用第三方 \u003ccode\u003enpm\u003c/code\u003e 包或者原生的 \u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/EventTarget\"\u003eEventTarget\u003c/a\u003e. 当然, 也可以自己实现一个类似 \u003ccode\u003enode.js\u003c/code\u003e 的简易版本.\u003c/p\u003e\n\u003cp\u003e我们先来看下 \u003ccode\u003eEventEmit\u003c/code\u003e 的基本使用方法:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eEventEmitter\u003c/span\u003e } = \u003cspan class=\"hljs-built_in\"\u003erequire\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'node:events'\u003c/span\u003e);\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e event = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eEventEmitter\u003c/span\u003e();\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003efn\u003c/span\u003e = (\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) =\u003e {\n  \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'event 事件触发!'\u003c/span\u003e);\n};\n\n\u003cspan class=\"hljs-comment\"\u003e//为指定事件注册一个监听器\u003c/span\u003e\nevent.\u003cspan class=\"hljs-title function_\"\u003eaddListener\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'event'\u003c/span\u003e, fn);\n\n\u003cspan class=\"hljs-comment\"\u003e//触发监听器\u003c/span\u003e\nevent.\u003cspan class=\"hljs-title function_\"\u003eemit\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'event'\u003c/span\u003e);\n\n\u003cspan class=\"hljs-comment\"\u003e//移除监听器\u003c/span\u003e\nevent.\u003cspan class=\"hljs-title function_\"\u003eremoveListener\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'event'\u003c/span\u003e, fn);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e其中, 当我们添加新的监听器时, \u003ccode\u003enewListener\u003c/code\u003e 事件会触发, \u003ccode\u003e当监听器被移除时，removeListener\u003c/code\u003e 事件被触发.\u003c/p\u003e\n\u003ch3 id=\"实现的-api-介绍\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#实现的-api-介绍\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003e实现的 Api 介绍\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eemitter.addListener(eventName, listener)\u003c/code\u003e 为指定事件注册一个监听器，接受一个 \u003ccode\u003estring\u003c/code\u003e (或 \u003ccode\u003esymbol\u003c/code\u003e) 类型的 \u003ccode\u003eeventName\u003c/code\u003e 和一个回调函数. 返回值为 \u003ccode\u003eEventEmit\u003c/code\u003e 的实例, 以便链式调用.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eeventName\u003c/code\u003e \u003ccode\u003e\u0026#x3C;string\u003e\u003c/code\u003e | \u003ccode\u003e\u0026#x3C;symbol\u003e\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003elistener\u003c/code\u003e \u003ccode\u003e\u0026#x3C;Function\u003e\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eReturns\u003c/code\u003e \u003ccode\u003e\u0026#x3C;EventEmit\u003e\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eemitter.emit(eventName, [...args])\u003c/code\u003e 同步调用为名为 \u003ccode\u003eeventName\u003c/code\u003e 的事件注册的每个监听器, 按照它们注册的顺序, 将提供的参数传递给每个侦听器, 如果存在该监听器, 则返回 \u003ccode\u003eTrue\u003c/code\u003e, 否则返回 \u003ccode\u003eFalse\u003c/code\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eeventName\u003c/code\u003e \u003ccode\u003e\u0026#x3C;string\u003e\u003c/code\u003e | \u003ccode\u003e\u0026#x3C;symbol\u003e\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e...args\u003c/code\u003e \u003ccode\u003e\u0026#x3C;any\u003e\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eReturns\u003c/code\u003e \u003ccode\u003e\u0026#x3C;boolean\u003e\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eemitter.once(eventName, listener)\u003c/code\u003e 和 \u003ccode\u003eaddListener\u003c/code\u003e 类似, 但只触发一次, 随后便解除事件监听.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eemitter.removeListener(eventName, listener)\u003c/code\u003e 移除指定事件的某个监听回调.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eeventName\u003c/code\u003e \u003ccode\u003e\u0026#x3C;string\u003e\u003c/code\u003e | \u003ccode\u003e\u0026#x3C;symbol\u003e\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003elistener\u003c/code\u003e \u003ccode\u003e\u0026#x3C;Function\u003e\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eReturns\u003c/code\u003e \u003ccode\u003e\u0026#x3C;EventEmit\u003e\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eemitter.removeAllListeners([eventName])\u003c/code\u003e 删除所有监听器, 或删除指定 \u003ccode\u003eeventName\u003c/code\u003e 的监听器.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eeventName\u003c/code\u003e \u003ccode\u003e\u0026#x3C;string\u003e\u003c/code\u003e | \u003ccode\u003e\u0026#x3C;symbol\u003e\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eReturns\u003c/code\u003e \u003ccode\u003e\u0026#x3C;EventEmitter\u003e\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eemitter.setMaxListeners(n)\u003c/code\u003e 用于修改监听器的默认限制的数量. (默认大于 10 个监听回调时会产生警告)\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003en\u003c/code\u003e \u003ccode\u003e\u0026#x3C;integer\u003e\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eReturns\u003c/code\u003e \u003ccode\u003e\u0026#x3C;EventEmitter\u003e\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eemitter.getMaxListeners()\u003c/code\u003e 获取限制监听器的数量\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eemitter.listeners(eventName)\u003c/code\u003e 返回名为 \u003ccode\u003eeventName\u003c/code\u003e 的事件的监听器数组的副本.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eeventName\u003c/code\u003e \u003ccode\u003e\u0026#x3C;string\u003e\u003c/code\u003e | \u003ccode\u003e\u0026#x3C;symbol\u003e\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eReturns\u003c/code\u003e \u003ccode\u003e\u0026#x3C;Function\u003e\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eemitter.listenerCount(eventName)\u003c/code\u003e 返回监听名为 \u003ccode\u003eeventName\u003c/code\u003e 的事件的监听器数量\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eemitter.on\u003c/code\u003e \u003ccode\u003eemitter.addListener\u003c/code\u003e的别名函数\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eemitter.off\u003c/code\u003e \u003ccode\u003eemitter.removeListener\u003c/code\u003e的别名函数\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"构造函数\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#构造函数\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003e构造函数\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e  #maxListeners = \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e;\n  \u003cspan class=\"hljs-title function_\"\u003econstructor\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003elisteners\u003c/span\u003e = \u003cspan class=\"hljs-title class_\"\u003eObject\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003ecreate\u003c/span\u003e(\u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e);\n    \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.#maxListeners = \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e;\n  }\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e其中 \u003ccode\u003elisteners\u003c/code\u003e 的结构如下:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-JSON\"\u003e\u003cspan class=\"hljs-punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003e\"event1\"\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-punctuation\"\u003e[\u003c/span\u003ef1\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003ef2\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003ef3\u003cspan class=\"hljs-punctuation\"\u003e]\u003c/span\u003e，\n  \u003cspan class=\"hljs-attr\"\u003e\"event2\"\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-punctuation\"\u003e[\u003c/span\u003ef4\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003ef5\u003cspan class=\"hljs-punctuation\"\u003e]\u003c/span\u003e，\n  ...\n\u003cspan class=\"hljs-punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"addlistener-方法\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#addlistener-方法\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eaddListener 方法\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e判断该事件监听器数组是否初始化，若未初始化，则将 \u003ccode\u003elisteners[event]\u003c/code\u003e 初始化为数组，并加入监听器 \u003ccode\u003ecb\u003c/code\u003e, 并触发 \u003ccode\u003enewListener\u003c/code\u003e 事件.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e判断该事件的监听器数量是否已超限，超限则报警告.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e判断数组中是否已存在 \u003ccode\u003ecb\u003c/code\u003e, 不存在则添加，已存在则不做操作.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e指定 \u003ccode\u003eon\u003c/code\u003e 等于 \u003ccode\u003eaddListener\u003c/code\u003e 方法\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e  \u003cspan class=\"hljs-title function_\"\u003eaddListener\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eeventName, cb\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (\n      !\u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003elisteners\u003c/span\u003e[eventName || !\u003cspan class=\"hljs-title class_\"\u003eArray\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eisArray\u003c/span\u003e(\u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003elisteners\u003c/span\u003e[eventName])]\n    ) {\n      \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003elisteners\u003c/span\u003e[eventName] = [cb];\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (eventName !== \u003cspan class=\"hljs-string\"\u003e\"newListener\"\u003c/span\u003e) {\n        \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eemit\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"newListener\"\u003c/span\u003e);\n      }\n      \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e;\n    }\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003elisteners\u003c/span\u003e[eventName].\u003cspan class=\"hljs-property\"\u003elength\u003c/span\u003e \u003e= \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.#maxListeners) {\n      \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eerror\u003c/span\u003e(\n        \u003cspan class=\"hljs-string\"\u003e\"MaxListenersExceededWarning: Possible EventEmitter memory leak detected. %d event6 listeners added to [EventEmitter]. Use emitter.setMaxListeners() to increase limit\"\u003c/span\u003e,\n        \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.#maxListeners\n      );\n    }\n\n    \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003elisteners\u003c/span\u003e[eventName].\u003cspan class=\"hljs-title function_\"\u003epush\u003c/span\u003e(cb);\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e;\n  }\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"emit-方法\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#emit-方法\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eemit 方法\u003c/h3\u003e\n\u003cp\u003e遍历监听器,通过 \u003ccode\u003eapply\u003c/code\u003e 方法把上面得到的 \u003ccode\u003eargs\u003c/code\u003e 参数传进去, 需要注意的是不要漏了返回值.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e  \u003cspan class=\"hljs-title function_\"\u003eemit\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eeventName, ...args\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e isExistEvent =\n      \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003elisteners\u003c/span\u003e[eventName] \u0026#x26;\u0026#x26; \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003elisteners\u003c/span\u003e[eventName].\u003cspan class=\"hljs-property\"\u003elength\u003c/span\u003e \u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e;\n\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (isExistEvent) {\n      \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003elisteners\u003c/span\u003e[eventName].\u003cspan class=\"hljs-title function_\"\u003eforEach\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003ecb\u003c/span\u003e) =\u003e\u003c/span\u003e {\n        cb.\u003cspan class=\"hljs-title function_\"\u003eapply\u003c/span\u003e(\u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e, args);\n      });\n    }\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e isExistEvent;\n  }\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"removelistener-方法\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#removelistener-方法\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eremoveListener 方法\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e  \u003cspan class=\"hljs-title function_\"\u003eremoveListener\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eeventName, listener\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e index = (\u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003elisteners\u003c/span\u003e[eventName] || []).\u003cspan class=\"hljs-title function_\"\u003eindexOf\u003c/span\u003e(listener);\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (index !== -\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) {\n      \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003elisteners\u003c/span\u003e[eventName].\u003cspan class=\"hljs-title function_\"\u003esplice\u003c/span\u003e(index, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e);\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (eventName !== \u003cspan class=\"hljs-string\"\u003e\"removeListener\"\u003c/span\u003e) {\n        \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eemit\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"removeListener\"\u003c/span\u003e);\n      }\n    }\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e;\n  }\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"once-方法\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#once-方法\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eonce 方法\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eonce\u003c/code\u003e 方法是 \u003ccode\u003eon\u003c/code\u003e 方法和 \u003ccode\u003eremoveListener\u003c/code\u003e 方法的结合：用 \u003ccode\u003eon\u003c/code\u003e 方法监听，在回调结束的最后位置，通过\u003ccode\u003eremoveListener\u003c/code\u003e 删掉监听函数自身\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e  \u003cspan class=\"hljs-title function_\"\u003eonce\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eeventName, listener\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003efn\u003c/span\u003e = (\u003cspan class=\"hljs-params\"\u003e...args\u003c/span\u003e) =\u003e {\n      listener.\u003cspan class=\"hljs-title function_\"\u003eapply\u003c/span\u003e(\u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e, args);\n      \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eremoveListener\u003c/span\u003e(eventName, fn);\n    };\n    \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eon\u003c/span\u003e(eventName, fn);\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e;\n  }\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"removealllisteners-方法\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#removealllisteners-方法\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eremoveAllListeners 方法\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e  \u003cspan class=\"hljs-title function_\"\u003eremoveAllListeners\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eeventNames = []\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (eventNames.\u003cspan class=\"hljs-property\"\u003elength\u003c/span\u003e === \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) {\n      \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003elisteners\u003c/span\u003e = \u003cspan class=\"hljs-title class_\"\u003eObject\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003ecreate\u003c/span\u003e(\u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e);\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n      eventNames.\u003cspan class=\"hljs-title function_\"\u003eforEach\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003ev\u003c/span\u003e) =\u003e\u003c/span\u003e {\n        \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003elisteners\u003c/span\u003e[v] = \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e;\n      });\n    }\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e;\n  }\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"setmaxlistenersgetmaxlistenerslistenercountonoff-方法\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#setmaxlistenersgetmaxlistenerslistenercountonoff-方法\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003esetMaxListeners、getMaxListeners、listenerCount、on、off 方法\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e  \u003cspan class=\"hljs-title function_\"\u003esetMaxListeners\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003emaxListeners\u003c/span\u003e) {\n    \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.#maxListeners = maxListeners;\n  }\n  \u003cspan class=\"hljs-title function_\"\u003egetMaxListeners\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.#maxListeners;\n  }\n  \u003cspan class=\"hljs-title function_\"\u003elistenerCount\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eeventName\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003elisteners\u003c/span\u003e[eventName]?.\u003cspan class=\"hljs-property\"\u003elength\u003c/span\u003e ?? \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e;\n  }\n\n  \u003cspan class=\"hljs-title class_\"\u003eEventEmitter\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003e\u003cspan class=\"hljs-keyword\"\u003eprototype\u003c/span\u003e\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eon\u003c/span\u003e = \u003cspan class=\"hljs-title class_\"\u003eEventEmitter\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003e\u003cspan class=\"hljs-keyword\"\u003eprototype\u003c/span\u003e\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eaddListener\u003c/span\u003e;\n  \u003cspan class=\"hljs-title class_\"\u003eEventEmitter\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003e\u003cspan class=\"hljs-keyword\"\u003eprototype\u003c/span\u003e\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eoff\u003c/span\u003e = \u003cspan class=\"hljs-title class_\"\u003eEventEmitter\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003e\u003cspan class=\"hljs-keyword\"\u003eprototype\u003c/span\u003e\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eremoveListener\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"完整代码地址-httpsgithubcomlzs911eventemit\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#完整代码地址-httpsgithubcomlzs911eventemit\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003e完整代码地址: \u003ca href=\"https://github.com/LZS911/EventEmit\"\u003ehttps://github.com/LZS911/EventEmit\u003c/a\u003e\u003c/h4\u003e","ogImage":{"url":"/assets/blog/image/cover.jpg"},"coverImage":"/assets/blog/image/cover.jpg","theme":"orange","tag":["node","javascript","EventEmit"]}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"如何实现一个事件监听器EventEmit"},"buildId":"yIbYpMrVODDFyEXyLGSSq","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>