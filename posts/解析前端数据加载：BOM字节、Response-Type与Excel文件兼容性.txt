1:"$Sreact.fragment"
2:I[7555,[],""]
3:I[1901,["874","static/chunks/874-90f68e0a3827b559.js","39","static/chunks/app/error-d036ecfd03716e30.js"],"default"]
4:I[1295,[],""]
5:I[9543,["874","static/chunks/874-90f68e0a3827b559.js","345","static/chunks/app/not-found-2113bbd7a2f55e8f.js"],"default"]
8:I[9665,[],"MetadataBoundary"]
a:I[9665,[],"OutletBoundary"]
d:I[4911,[],"AsyncMetadataOutlet"]
f:I[8460,["209","static/chunks/app/loading-b73dd9bd22c3caa2.js"],"default"]
10:I[9665,[],"ViewportBoundary"]
12:I[6614,[],""]
:HL["/_next/static/media/569ce4b8f30dc480-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/media/93f479601ee12b01-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/css/afd685b2833157f9.css","style"]
0:{"P":null,"b":"b2cI1DuFmdmFcolkW81qY","p":"","c":["","posts","%E8%A7%A3%E6%9E%90%E5%89%8D%E7%AB%AF%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%EF%BC%9ABOM%E5%AD%97%E8%8A%82%E3%80%81Response-Type%E4%B8%8EExcel%E6%96%87%E4%BB%B6%E5%85%BC%E5%AE%B9%E6%80%A7"],"i":false,"f":[[["",{"children":["(article)",{"children":["posts",{"children":[["slug","%E8%A7%A3%E6%9E%90%E5%89%8D%E7%AB%AF%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%EF%BC%9ABOM%E5%AD%97%E8%8A%82%E3%80%81Response-Type%E4%B8%8EExcel%E6%96%87%E4%BB%B6%E5%85%BC%E5%AE%B9%E6%80%A7","d"],{"children":["__PAGE__",{}]}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/afd685b2833157f9.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","children":["$","body",null,{"className":"__variable_5cfdac __variable_9a8899 antialiased","children":["$","$L2",null,{"parallelRouterKey":"children","error":"$3","errorStyles":[],"errorScripts":[],"template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","$L5",null,{}],[]],"forbidden":"$undefined","unauthorized":"$undefined"}]}]}]]}],{"children":["(article)",["$","$1","c",{"children":[null,"$L6"]}],{"children":["posts",["$","$1","c",{"children":[null,["$","$L2",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":[["slug","%E8%A7%A3%E6%9E%90%E5%89%8D%E7%AB%AF%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%EF%BC%9ABOM%E5%AD%97%E8%8A%82%E3%80%81Response-Type%E4%B8%8EExcel%E6%96%87%E4%BB%B6%E5%85%BC%E5%AE%B9%E6%80%A7","d"],["$","$1","c",{"children":[null,["$","$L2",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":["$L7",["$","$L8",null,{"children":"$L9"}],null,["$","$La",null,{"children":["$Lb","$Lc",["$","$Ld",null,{"promise":"$@e"}]]}]]}],{},null,false]},null,false]},null,false]},null,false]},[["$","$Lf","l",{}],[],[]],false],["$","$1","h",{"children":[null,["$","$1","oEg5r79ASz5bgRikrerMm",{"children":[["$","$L10",null,{"children":"$L11"}],["$","meta",null,{"name":"next-size-adjust","content":""}]]}],null]}],false]],"m":"$undefined","G":["$12","$undefined"],"s":false,"S":true}
13:I[4467,["874","static/chunks/874-90f68e0a3827b559.js","766","static/chunks/766-dfd76e5b111fda64.js","651","static/chunks/app/(article)/layout-120a8801c6045af4.js"],"default"]
14:"$Sreact.suspense"
15:I[4911,[],"AsyncMetadata"]
6:["$","html",null,{"lang":"en","children":["$","body",null,{"className":"__variable_5cfdac __variable_9a8899 antialiased","children":[["$","div",null,{"className":"min-h-screen","children":[["$","$L13",null,{}],["$","main",null,{"className":"p-6 flex justify-center","children":["$","$L2",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]}],["$","footer",null,{"className":"bg-neutral-50 border-t border-neutral-200 text-center text-xs opacity-50 py-4","children":["Â© 2022 - ",2025,["$","a",null,{"rel":"noopener noreferrer","className":"hover:underline hover:bg-indigo","href":"https://github.com/LZS911","target":"_blank","children":", LZS_911"}],", build with"," ",["$","a",null,{"rel":"noopener noreferrer","className":"underline hover:bg-indigo","href":"https://nextjs.org/","target":"_blank","children":"Next.js"}]," ","and"," ",["$","a",null,{"rel":"noopener noreferrer","className":"underline hover:bg-indigo","href":"https://pages.github.com/?(null)","target":"_blank","children":"GitHub Pages"}]]}]]}],false]}]}]
9:["$","$14",null,{"fallback":null,"children":["$","$L15",null,{"promise":"$@16"}]}]
c:null
17:I[5099,["766","static/chunks/766-dfd76e5b111fda64.js","62","static/chunks/62-abd5adcc4de2f71a.js","520","static/chunks/app/(article)/posts/%5Bslug%5D/page-3df7d22b1edb27cc.js"],"ThemeLoader"]
18:T2d45,<h2 id="å¼•è¨€"><a aria-hidden="true" tabindex="-1" href="#å¼•è¨€"><span class="icon icon-link"></span></a>å¼•è¨€</h2>
<p>åœ¨å¼€å‘ To B ç«¯çš„é¡¹ç›®æ—¶ï¼Œå¯¼å‡º CSV æ–‡ä»¶è¿›è¡Œæ•°æ®åˆ†ææ˜¯ä¸€é¡¹å¸¸è§„æ“ä½œã€‚ç„¶è€Œï¼Œè¿™ä¸€è¿‡ç¨‹å¹¶éæ€»æ˜¯é¡ºç•…æ— é˜»ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œå½“ä½ ä¿¡å¿ƒæ»¡æ»¡åœ°å°†ä¸€ä¸ª CSV æ–‡ä»¶æ‹–å…¥ Excel ï¼ŒæœŸå¾…çœ‹åˆ°ä¸€ä¸ªæ•´é½çš„æ•°æ®è¡¨æ ¼æ—¶ï¼Œå´é­é‡äº†ä¹±ç çš„å°´å°¬åœºæ™¯ã€‚è¿™ä¸ä»…ä»¤äººæ²®ä¸§ï¼Œè€Œä¸”å¯èƒ½ä¸¥é‡å½±å“å·¥ä½œæ•ˆç‡ã€‚é‚£ä¹ˆï¼ŒCSV æ–‡ä»¶ä¸ Excel ä¹‹é—´å­˜åœ¨å“ªäº›å·®å¼‚ï¼Ÿæˆ‘ä»¬å¦‚ä½•ç¡®ä¿åœ¨ Excel ä¸­èƒ½å¤Ÿæ­£å¸¸æ‰“å¼€ CSV æ–‡ä»¶ï¼Ÿ</p>
<p>æœ¬æ–‡å°†é’ˆå¯¹è¿™äº›ç–‘é—®å±•å¼€æ¢è®¨ï¼Œä»ä¸€æ¬¡ CSV æ–‡ä»¶å¯¼å…¥ Excel æ—¶å‡ºç°çš„ä¹±ç é—®é¢˜å…¥æ‰‹ï¼Œé€æ­¥å‰–æèƒŒåçš„åŸå› ã€‚é‡ç‚¹æ¢è®¨<code>BOMï¼ˆByte Order Markï¼‰</code>å­—èŠ‚å’Œ HTTP å“åº”ä¸­çš„<code>Content-Type</code>å¦‚ä½•å½±å“å‰ç«¯å¯¹æ•°æ®çš„åŠ è½½å’Œè§£æï¼Œä»¥åŠè¿™äº›å› ç´ å¯¹ Excel æ–‡ä»¶å…¼å®¹æ€§çš„å½±å“ã€‚</p>
<h2 id="csvæ–‡ä»¶ä¸excelçš„å·®å¼‚-1"><a aria-hidden="true" tabindex="-1" href="#csvæ–‡ä»¶ä¸excelçš„å·®å¼‚-1"><span class="icon icon-link"></span></a>CSVæ–‡ä»¶ä¸Excelçš„å·®å¼‚ <sup><a href="#user-content-fn-1" id="user-content-fnref-1" data-footnote-ref aria-describedby="footnote-label">1</a></sup></h2>
<ol>
<li>Excelæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå®ƒä¿å­˜æœ‰å…³å·¥ä½œç°¿ä¸­æ‰€æœ‰å·¥ä½œè¡¨çš„ä¿¡æ¯ã€‚CSVä»£è¡¨ Comma Separated Values ã€‚è¿™æ˜¯ä¸€ä¸ªçº¯æ–‡æœ¬æ ¼å¼ï¼Œç”¨é€—å·åˆ†éš”ä¸€ç³»åˆ—å€¼ã€‚</li>
<li>Excelä¸ä»…å¯ä»¥å­˜å‚¨æ•°æ®ï¼Œè¿˜å¯ä»¥å¯¹æ•°æ®è¿›è¡Œæ“ä½œã€‚CSVæ–‡ä»¶åªæ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå®ƒå­˜å‚¨æ•°æ®ï¼Œä½†ä¸åŒ…å«æ ¼å¼ï¼Œå…¬å¼ï¼Œå®ç­‰ã€‚å®ƒä¹Ÿè¢«ç§°ä¸ºå¹³é¢æ–‡ä»¶ã€‚</li>
<li>Excelæ˜¯ä¸€ä¸ªç”µå­è¡¨æ ¼ï¼Œå°†æ–‡ä»¶ä¿å­˜ä¸ºè‡ªå·±çš„ä¸“æœ‰æ ¼å¼ï¼Œå³xlsæˆ–xlsxã€‚CSVæ˜¯å°†è¡¨æ ¼ä¿¡æ¯ä¿å­˜ä¸ºæ‰©å±•åä¸º.csvçš„åˆ†éš”æ–‡æœ¬æ–‡ä»¶çš„æ ¼å¼ã€‚</li>
<li>ä¿å­˜åœ¨excelä¸­çš„æ–‡ä»¶ä¸èƒ½è¢«æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€æˆ–ç¼–è¾‘ã€‚CSVæ–‡ä»¶å¯ä»¥é€šè¿‡æ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆå¦‚è®°äº‹æœ¬ï¼‰æ‰“å¼€æˆ–ç¼–è¾‘ã€‚</li>
</ol>
<h2 id="bomå­—èŠ‚çš„æ¦‚å¿µä¸ä½œç”¨"><a aria-hidden="true" tabindex="-1" href="#bomå­—èŠ‚çš„æ¦‚å¿µä¸ä½œç”¨"><span class="icon icon-link"></span></a>BOMå­—èŠ‚çš„æ¦‚å¿µä¸ä½œç”¨</h2>
<p>åœ¨è§£é‡ŠBOMå­—èŠ‚å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹ CSV æ–‡ä»¶åœ¨ WPS å’Œ Microsoft Excel ä¸­çš„è¡¨ç°åŒºåˆ«</p>
<h3 id="wps"><a aria-hidden="true" tabindex="-1" href="#wps"><span class="icon icon-link"></span></a>WPS</h3>
<p><img src="https://github.com/LZS911/LZS911.github.io/assets/42765421/6c8989cf-0386-4f4b-bcdb-1dfef747f2dc" alt="image"></p>
<h3 id="microsoft-excel"><a aria-hidden="true" tabindex="-1" href="#microsoft-excel"><span class="icon icon-link"></span></a>Microsoft Excel</h3>
<p><img src="https://github.com/LZS911/LZS911.github.io/assets/42765421/1eb61e35-19f5-4aaa-b1fa-b0f6a5be24f7" alt="image"></p>
<h3 id="ä¸ºä»€ä¹ˆä¼šå‡ºç°ä¸­æ–‡ä¹±ç "><a aria-hidden="true" tabindex="-1" href="#ä¸ºä»€ä¹ˆä¼šå‡ºç°ä¸­æ–‡ä¹±ç "><span class="icon icon-link"></span></a>ä¸ºä»€ä¹ˆä¼šå‡ºç°ä¸­æ–‡ä¹±ç ï¼Ÿ</h3>
<p>å½“å‡ºç°ä¹±ç åï¼Œé¦–å…ˆåº”è¯¥è€ƒè™‘çš„æ˜¯æ–‡ä»¶çš„ç¼–ç æ ¼å¼é—®é¢˜ã€‚é€šå¸¸ï¼ŒCSV æ–‡ä»¶é‡‡ç”¨ UTF-8 ç¼–ç ï¼Œè¿™æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„å­—ç¬¦ç¼–ç ï¼Œæ”¯æŒåŒ…æ‹¬ä¸­æ–‡åœ¨å†…çš„å¤šç§è¯­è¨€ã€‚ç„¶è€Œ Microsoft Excel ä¼šé»˜è®¤ä½¿ç”¨ ANSI ç¼–ç æ¥è§£ææ–‡ä»¶ï¼Œè€Œ ANSI ç¼–ç å®é™…ä¸Šæ˜¯ä¾èµ–äºç³»ç»ŸåŒºåŸŸè®¾ç½®çš„ç‰¹å®šç¼–ç ï¼Œæ¯”å¦‚åœ¨ä¸­æ–‡ Windows ç³»ç»Ÿä¸­é€šå¸¸æ˜¯GBKã€‚</p>
<h3 id="è§£å†³æ–¹æ¡ˆ"><a aria-hidden="true" tabindex="-1" href="#è§£å†³æ–¹æ¡ˆ"><span class="icon icon-link"></span></a>è§£å†³æ–¹æ¡ˆ</h3>
<ol>
<li>
<p>ä¿®æ”¹csvæ–‡ä»¶ç¼–ç æ ¼å¼ã€‚ æ‰§è¡Œå‘½ä»¤ <code>iconv -f UTF-8 -t GB18030 old_file.csv > new_file.csv</code>ï¼ˆåœ¨ macos ä¸­èƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œï¼Œè‹¥ Windows æ— æ³•æ‰§è¡Œéœ€å¯»æ‰¾æ›¿ä»£æ–¹æ¡ˆï¼Œä¾‹å¦‚ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆå¦‚Notepad++ï¼‰çš„å¦å­˜ä¸ºåŠŸèƒ½ï¼Œé€‰æ‹©GBKä½œä¸ºä¿å­˜ç¼–ç ï¼‰ï¼Œé‡æ–°ç”Ÿæˆçš„ new_file ä¾¿èƒ½æ­£å¸¸åœ¨ Microsoft Excel ä¸­æ˜¾ç¤ºä¸­æ–‡äº†ã€‚
å°½ç®¡ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·è¿›è¡Œç¼–ç è½¬æ¢å¯¹äºæŠ€æœ¯ç”¨æˆ·æ¥è¯´æ˜¯ä¸€ä¸ªé«˜æ•ˆçš„æ–¹æ³•ï¼Œä½†ç¡®å®å¯èƒ½å¯¹æ™®é€šç”¨æˆ·æ¥è¯´æœ‰ä¸€å®šçš„ä½¿ç”¨é—¨æ§›ã€‚</p>
</li>
<li>
<p>ä½¿ç”¨ BOM æ¥è¿›è¡Œç¼–ç è¡¨ç¤ºã€‚ BOMæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å­—èŠ‚åºåˆ—ï¼Œç”¨äºæ ‡è¯†æ–‡ä»¶çš„ç¼–ç æ ¼å¼ã€‚UTF-8ç¼–ç çš„BOMå­—èŠ‚åºåˆ—æ˜¯<code>0xEF 0xBB 0xBF</code>ã€‚å½“Excelæ‰“å¼€å¸¦æœ‰BOMçš„CSVæ–‡ä»¶æ—¶ï¼ŒBOMå¸®åŠ©Excelè¯†åˆ«æ–‡ä»¶æ˜¯ä»¥UTF-8ç¼–ç çš„ï¼Œä»è€Œé¿å…äº†ä½¿ç”¨é”™è¯¯çš„ç¼–ç è§£ææ–‡ä»¶å†…å®¹ã€‚
ä»£ç æ¡ˆä¾‹ï¼š<a href="https://github.com/LZS911/csv-bom-excel-example">https://github.com/LZS911/csv-bom-excel-example</a> <sup><a href="#user-content-fn-2" id="user-content-fnref-2" data-footnote-ref aria-describedby="footnote-label">2</a></sup></p>
<p><img src="https://github.com/LZS911/LZS911.github.io/assets/42765421/260b5efb-a0a9-4b2b-a4ed-8e8e84a8ddd8" alt="image">
<img src="https://github.com/LZS911/LZS911.github.io/assets/42765421/aeade430-b59a-4e57-a92f-f81f1604f48e" alt="image"></p>
<blockquote>
<p>å…¶ä¸­æ–‡ä»¶å¤§å°ä¸º 60b çš„ä¸ºé™„å¸¦äº† BOM å­—èŠ‚çš„ csv æ–‡ä»¶</p>
</blockquote>
</li>
</ol>
<h2 id="response-typeåœ¨httpå“åº”ä¸­çš„ä½œç”¨"><a aria-hidden="true" tabindex="-1" href="#response-typeåœ¨httpå“åº”ä¸­çš„ä½œç”¨"><span class="icon icon-link"></span></a>Response-Typeåœ¨HTTPå“åº”ä¸­çš„ä½œç”¨</h2>
<p>æˆ‘ä»¬æ¥çœ‹ä¸€è¡Œä»£ç ï¼š <a href="https://github.com/LZS911/csv-bom-excel-example/blob/main/index.html#L15">https://github.com/LZS911/csv-bom-excel-example/blob/main/index.html#L15</a></p>
<p>é¦–å…ˆäº†è§£ä¸‹ ResponseType<sup><a href="#user-content-fn-3" id="user-content-fnref-3" data-footnote-ref aria-describedby="footnote-label">3</a></sup> çš„ä½œç”¨</p>
<blockquote>
<p><code>XMLHttpRequest</code> å±æ€§ <code>responseType</code> æ˜¯ä¸€ä¸ªæšä¸¾å­—ç¬¦ä¸²å€¼ï¼Œç”¨äºæŒ‡å®šå“åº”ä¸­åŒ…å«çš„æ•°æ®ç±»å‹ã€‚
å®ƒè¿˜å…è®¸ä½œè€…æ›´æ”¹å“åº”ç±»å‹ã€‚å¦‚æœå°† <code>responseType</code> çš„å€¼è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œåˆ™ä¼šä½¿ç”¨ <code>'text'</code> ä½œä¸ºé»˜è®¤å€¼ã€‚</p>
</blockquote>
<p>æ–‡ç« å¯èƒ½çœ‹çš„æœ‰ç‚¹è¿·ç³Šï¼Œæˆ‘ä»¬ç›´æ¥å°†è¿™è¡Œä»£ç æ³¨é‡Šï¼Œç„¶åè§‚å¯Ÿä¸‹è½½å¾—åˆ°çš„æ–‡ä»¶çš„è¡¨ç°
<img src="https://github.com/LZS911/LZS911.github.io/assets/42765421/d6084364-3e6b-4beb-a012-02efede30366" alt="image">
<img src="https://github.com/LZS911/LZS911.github.io/assets/42765421/0434db6d-3f2e-4ed1-aa37-c81b7bf6cd7f" alt="image"></p>
<p>å¯ä»¥å‘ç°ï¼Œå‰ç«¯è·å–åˆ°çš„ csv æ–‡ä»¶åˆä¸¢å¤±æ‰äº†åç«¯é™„åŠ çš„ BOM å­—èŠ‚ï¼Œå¯¼è‡´åœ¨ Microsoft Excel ä¸­å‡ºç°äº†ä¹±ç ã€‚</p>
<p>æ‰€ä»¥ï¼Œå¯ä»¥å¾—å‡ºç»“è®ºï¼š</p>
<p>å½“æœåŠ¡ç«¯ç«¯åœ¨è¿”å›æ•°æ®é¦–éƒ¨æ·»åŠ å­—èŠ‚<code>BOMï¼ˆByte Order Markï¼‰</code>æ—¶ï¼Œå‰ç«¯å¦‚æœæ²¡æœ‰ç‰¹åˆ«è®¾ç½® <code>XMLHttpRequestçš„responseType</code> ä¸º <code>'blob'</code>ï¼Œä¼šä¸¢å¤±BOMå­—èŠ‚ã€‚</p>
<p>è¿™æ˜¯å› ä¸º<code>XMLHttpRequest</code>çš„é»˜è®¤<code>responseType</code>æ˜¯ <code>'text'</code>ï¼Œå½“è®¾ç½®ä¸º<code>'text'</code>æ—¶ï¼Œæµè§ˆå™¨ä¼šå°è¯•å°†å“åº”ä½“è§£ç ä¸ºå­—ç¬¦ä¸²æ–‡æœ¬ã€‚</p>
<h2 id="å¦‚ä½•é¿å…bomå­—èŠ‚çš„ä¸¢å¤±"><a aria-hidden="true" tabindex="-1" href="#å¦‚ä½•é¿å…bomå­—èŠ‚çš„ä¸¢å¤±"><span class="icon icon-link"></span></a>å¦‚ä½•é¿å…BOMå­—èŠ‚çš„ä¸¢å¤±</h2>
<h3 id="åç«¯å¤„ç†"><a aria-hidden="true" tabindex="-1" href="#åç«¯å¤„ç†"><span class="icon icon-link"></span></a>åç«¯å¤„ç†</h3>
<p>åœ¨å‰ç«¯ä¸è¿›è¡Œä»»ä½•é¢å¤–çš„å¤„ç†æƒ…å†µä¸‹ï¼Œåç«¯å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²é¦–éƒ¨æ·»åŠ å­—èŠ‚ <code>\ufeff</code> çš„æ–¹å¼ã€‚ è§ä»£ç ï¼š<a href="https://github.com/LZS911/csv-bom-excel-example/blob/main/server.js#L5">https://github.com/LZS911/csv-bom-excel-example/blob/main/server.js#L5</a>ã€‚å½“ç„¶ï¼Œæœ€åä»£ç èƒ½ä¸èƒ½è¿‡ review å°±ä¸å¥½è¯´äº†ğŸ¤ªã€‚</p>
<h3 id="å‰ç«¯å¤„ç†"><a aria-hidden="true" tabindex="-1" href="#å‰ç«¯å¤„ç†"><span class="icon icon-link"></span></a>å‰ç«¯å¤„ç†</h3>
<ol>
<li>å‰ç«¯æ‰‹åŠ¨æ·»åŠ  <code>{responseType: 'blob'}</code>ï¼Œ å­˜åœ¨ä¸€å®šçš„å¿ƒæ™ºè´Ÿæ‹…ã€‚</li>
<li>ç»Ÿä¸€åœ¨è¯·æ±‚åœ¨ <code>context-type</code> ä¸º 'text/csv' çš„æƒ…å†µä¸‹ï¼Œåœ¨è¿”å›çš„dataå‰éƒ¨åŠ ä¸Š <code>\ufeff</code>ã€‚ åŒæ ·éœ€è¦ç»è¿‡ä»£ç  review çš„è€ƒéªŒã€‚</li>
</ol>
<h3 id="æœ€ä½³å®è·µ"><a aria-hidden="true" tabindex="-1" href="#æœ€ä½³å®è·µ"><span class="icon icon-link"></span></a>æœ€ä½³å®è·µ</h3>
<p>ç›®å‰å¯¹æ¯”ä¸‹æ¥ï¼Œä¸Šè¿°çš„å‡ ç§æ–¹æ¡ˆéƒ½ä¸æ˜¯ç‰¹åˆ«å®Œç¾ã€‚ä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»¼åˆåˆ©ç”¨é¡¹ç›®ä¸­ç°æœ‰çš„å·¥å…·å’Œæµç¨‹æ¥æ‰¾å¯»åˆ°æœ€ä½³å®è·µã€‚</p>
<p>æˆ‘ä»¬çš„å‰ç«¯é¡¹ç›®ä½¿ç”¨äº† <code>Typescript</code>ï¼Œå¹¶ä¸” api å®šä¹‰éƒ¨åˆ†ä½¿ç”¨ä¸€æ®µè„šæœ¬é€šè¿‡è·å–åç«¯çš„ swagger.json æ–‡ä»¶æ¥è‡ªåŠ¨ç”Ÿæˆï¼Œä¾‹å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼š<a href="https://github.com/actiontech/dms-ui/blob/08f7de1a9e724008e18f73e498eaa9aca456ed1d/packages/shared/lib/api/sqle/service/task/index.ts#L206">https://github.com/actiontech/dms-ui/blob/08f7de1a9e724008e18f73e498eaa9aca456ed1d/packages/shared/lib/api/sqle/service/task/index.ts#L206</a></p>
<p><img src="https://github.com/LZS911/LZS911.github.io/assets/42765421/0ca221f5-4417-4d12-b257-08c90d5ab709" alt="image"></p>
<p>äºæ˜¯æˆ‘ä»¬å¯ä»¥æ ¹æ®åç«¯çš„ swagger å®šä¹‰ï¼Œç¡®å®šéœ€è¦è®¾ç½® {responseType: 'blob'} çš„æ¥å£ï¼Œç„¶ååœ¨ api æ¨¡æ¿éƒ¨åˆ†è‡ªåŠ¨æ·»åŠ ä¸Šè¯¥å‚æ•°ï¼Œä¾¿èƒ½å‡å°‘å¿ƒæ™ºè´Ÿæ‹…ï¼Œç¡®ä¿è¯¥å‚æ•°çš„å­˜åœ¨ã€‚</p>
<h2 id="ç»“è¯­4"><a aria-hidden="true" tabindex="-1" href="#ç»“è¯­4"><span class="icon icon-link"></span></a>ç»“è¯­<sup><a href="#user-content-fn-4" id="user-content-fnref-4" data-footnote-ref aria-describedby="footnote-label">4</a></sup></h2>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æ·±å…¥æ¢è®¨äº†åœ¨ Web å¼€å‘è¿‡ç¨‹ä¸­å¤„ç†CSVæ–‡ä»¶æ—¶å¯èƒ½ä¼šé‡åˆ°çš„ä¸€ä¸ªæ£˜æ‰‹é—®é¢˜â€”â€”ä¹±ç ï¼Œä»¥åŠä¸ä¹‹ç›¸å…³çš„æŠ€æœ¯ç»†èŠ‚ã€‚æˆ‘ä»¬åˆ†æäº†ä¹±ç äº§ç”Ÿçš„åŸå› ï¼Œä¸»è¦é›†ä¸­åœ¨å­—ç¬¦ç¼–ç çš„ä¸åŒ¹é…ï¼Œå°¤å…¶æ˜¯å½“ CSV æ–‡ä»¶ä½¿ç”¨ UTF-8 ç¼–ç ä¸”å¸¦æœ‰BOMå­—èŠ‚ï¼Œè€Œå‰ç«¯æˆ– Excel ç­‰ç”µå­è¡¨æ ¼è½¯ä»¶æœªèƒ½æ­£ç¡®è¯†åˆ«å’Œå¤„ç†è¿™äº›å­—èŠ‚æ—¶ã€‚
é€šè¿‡æä¾›ä¸€ç³»åˆ—çš„è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬åœ¨æœåŠ¡ç«¯æ­£ç¡®è®¾ç½® HTTP å“åº”çš„<code>Content-Type</code>å¤´éƒ¨ï¼Œä»¥åŠåœ¨å‰ç«¯é€šè¿‡<code>XMLHttpRequest</code>ä»¥é€‚å½“çš„<code>responseType</code>æ¥æ”¶äºŒè¿›åˆ¶æ•°æ®ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•æœ‰æ•ˆåœ°é¿å…æ•°æ®åœ¨ä¼ è¾“å’ŒåŠ è½½è¿‡ç¨‹ä¸­å‡ºç°ä¹±ç ã€‚</p>
<h2 id="é™„å½•"><a aria-hidden="true" tabindex="-1" href="#é™„å½•"><span class="icon icon-link"></span></a>é™„å½•</h2>
<blockquote>
<p>é€šè¿‡ <a href="https://kimi.moonshot.cn/">Kimi</a> è¾…åŠ©ç”Ÿæˆæ–‡ç« æ ‡é¢˜ä»¥åŠå…·ä½“å¤§çº²ï¼Œå¹¶ä¸”è¿›è¡Œç»†èŠ‚ä¼˜åŒ–ã€‚</p>
</blockquote>
<section data-footnotes class="footnotes"><h2 class="sr-only" id="footnote-label"><a aria-hidden="true" tabindex="-1" href="#footnote-label"><span class="icon icon-link"></span></a>Footnotes</h2>
<ol>
<li id="user-content-fn-1">
<p><a href="https://zhuanlan.zhihu.com/p/148209693">CSVæ–‡ä»¶ä¸Excelçš„å·®å¼‚</a> <a href="#user-content-fnref-1" data-footnote-backref="" aria-label="Back to reference 1" class="data-footnote-backref">â†©</a></p>
</li>
<li id="user-content-fn-2">
<p><a href="https://github.com/LZS911/csv-bom-excel-example">ç¤ºä¾‹ä»£ç ç”± Kimi ç”Ÿæˆ</a> <a href="#user-content-fnref-2" data-footnote-backref="" aria-label="Back to reference 2" class="data-footnote-backref">â†©</a></p>
</li>
<li id="user-content-fn-3">
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/responseType">ResponseType</a> <a href="#user-content-fnref-3" data-footnote-backref="" aria-label="Back to reference 3" class="data-footnote-backref">â†©</a></p>
</li>
<li id="user-content-fn-4">
<p><a href="https://kimi.moonshot.cn/">æ¥è‡ª Kimi</a> <a href="#user-content-fnref-4" data-footnote-backref="" aria-label="Back to reference 4" class="data-footnote-backref">â†©</a></p>
</li>
</ol>
</section>7:["$","article",null,{"children":[["$","div",null,{"className":"flex justify-center font-[Arial] max-w-[864px] text-center","children":["$","h1",null,{"className":"text-[2.5rem] font-bold bg-lime-300 px-5 py-2 rounded-sm text-shadow-lg leading-[1.1]","children":"è§£æå‰ç«¯æ•°æ®åŠ è½½ï¼šBOMå­—èŠ‚ã€Response-Typeä¸Excelæ–‡ä»¶å…¼å®¹æ€§"}]}],["$","time",null,{"dateTime":"2024-04-10","className":"text-center block my-4 text-sm opacity-60","children":"April\t10, 2024"}],[null,["$","$L17",null,{"theme":"fancy"}],["$","section",null,{"className":"markdown-body-fancy max-w-3xl","dangerouslySetInnerHTML":{"__html":"$18"}}]],null]}]
11:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
b:null
16:{"metadata":[["$","title","0",{"children":"Ai.Haibara codes"}],["$","meta","1",{"name":"description","content":"LZS Blog"}],["$","link","2",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"96x96"}]],"error":null,"digest":"$undefined"}
e:{"metadata":"$16:metadata","error":null,"digest":"$undefined"}
