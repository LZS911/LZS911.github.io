<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#000000"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><meta property="og:image" content="https://og-image.vercel.app/Next.js%20Blog%20Starter%20Example.png?theme=light&amp;md=1&amp;fontSize=100px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg"/><title>如何将 Next.js 项目部署至Github Pages | Ai.Haibara codes</title><meta name="next-head-count" content="14"/><link rel="preload" href="/_next/static/css/8681f744d5932be6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8681f744d5932be6.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-8fa1640cc84ba8fe.js" defer=""></script><script src="/_next/static/chunks/framework-3b5a00d5d7e8d93b.js" defer=""></script><script src="/_next/static/chunks/main-59a90320855f5cf5.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f46e289d7ac5e197.js" defer=""></script><script src="/_next/static/chunks/799-575b46febca3af7d.js" defer=""></script><script src="/_next/static/chunks/399-cac0cd8ed02bf02a.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-e2afa3a98c674f72.js" defer=""></script><script src="/_next/static/qBu5lBFKXaCDYaF8pFjY5/_buildManifest.js" defer=""></script><script src="/_next/static/qBu5lBFKXaCDYaF8pFjY5/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen"><header class="text-white bg-black drop-shadow-2xl"><div class="mx-auto my-0 max-w-[960px] py-6 px-4 flex items-center"><div class="flex items-center"><img alt="Ai.Haibara" src="/assets/blog/authors/haibara_2.jpg" width="100" height="100" decoding="async" data-nimg="1" class=" rounded-full" loading="lazy" style="color:transparent"/></div><div class="ml-6"><a class=" font-bold text-3xl" href="/">Ai.Haibara codes</a><div class="mt-2"><a class="p-1 rounded-sm text-xl mr-2 hover:border-b-2 border-indigo" href="/">Home</a><a class="p-1 rounded-sm text-xl mr-2 hover:border-b-2 border-indigo" href="/projects">Projects</a><a class="p-1 rounded-sm text-xl mr-2 hover:border-b-2 border-indigo" href="/talks">Talks</a><a class="p-1 rounded-sm text-xl mr-2 hover:border-b-2 border-indigo" href="/blogs">Blogs</a></div></div></div></header><main class="p-6 flex justify-center"><article><div class="flex justify-center font-[Arial] max-w-[864px] text-center"><h1 class="text-5xl font-bold bg-indigo px-5 py-2 rounded-sm text-shadow-lg leading-[1.1]">如何将 Next.js 项目部署至Github Pages</h1></div><time dateTime="2022-12-06" class="text-center block my-4 text-sm opacity-60">December	6, 2022</time><section><div class="markdown-body-fancy max-w-3xl"><h2 id="1-创建-github-仓库"><a aria-hidden="true" tabindex="-1" href="#1-创建-github-仓库"><span class="icon icon-link"></span></a>1. 创建 Github 仓库</h2>
<p>新建仓库名称约束: <code>username.github.io</code>, 其中 <code>username</code> 为 <code>Github</code> 上的用户名(或组织名称).</p>
<p><img src="/assets/github-pages/example-1.png" alt="alt"></p>
<h2 id="2-创建-nextjs-项目"><a aria-hidden="true" tabindex="-1" href="#2-创建-nextjs-项目"><span class="icon icon-link"></span></a>2. 创建 Next.js 项目</h2>
<pre><code class="language-ssh">npx create-next-app@latest --typescript
# or
yarn create next-app --typescript
# or
pnpm create next-app --typescript
</code></pre>
<h2 id="3-打开-packagejson-并添加脚本"><a aria-hidden="true" tabindex="-1" href="#3-打开-packagejson-并添加脚本"><span class="icon icon-link"></span></a>3. 打开 package.json 并添加脚本</h2>
<pre><code class="language-json"> "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint",
    "export": "next export" //add
    ""
  },
</code></pre>
<h2 id="4-添加-github-actions"><a aria-hidden="true" tabindex="-1" href="#4-添加-github-actions"><span class="icon icon-link"></span></a>4. 添加 github Actions</h2>
<p>关于 <code>GitHub Pages</code> 站点的发布源: <a href="https://docs.github.com/cn/pages/getting-started-with-github-pages/configuring-a-publishing-source-for-your-github-pages-site">https://docs.github.com/cn/pages/getting-started-with-github-pages/configuring-a-publishing-source-for-your-github-pages-site</a></p>
<p>鉴于 <code>Next.js</code> 的源码文件格式并不能直接作为发布源, 我们需要对项目进行打包处理, 同时也可以做一些代码 <code>check</code>, 所以我们需要添加 <code>github Actions</code>.</p>
<p>添加文件: <code>.github/workflows/gh-pages.yml</code></p>
<pre><code class="language-yml">name: GitHub Pages

on:
  push:
    branches:
      - main
  pull_request:

jobs:
  deploy:
    runs-on: ubuntu-22.04
    permissions:
      contents: write
    concurrency:
      group: ${{ github.workflow }}-${{ github.ref }}
    steps:
      - uses: actions/checkout@v3

      - name: Setup Node
        uses: actions/setup-node@v3
        with:
          node-version: "14"

      - name: Get yarn cache
        id: yarn-cache
        run: echo "::set-output name=dir::$(yarn cache dir)"

      - name: Cache dependencies
        uses: actions/cache@v2
        with:
          path: ${{ steps.yarn-cache.outputs.dir }}
          key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
          restore-keys: |
            ${{ runner.os }}-yarn-

      - run: yarn install --frozen-lockfile
      - run: yarn lint
      - run: yarn build
      - run: yarn export

      - name: Deploy
        uses: peaceiris/actions-gh-pages@v3
        if: ${{ github.ref == 'refs/heads/main' }}
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./out

</code></pre>
<p>了解更多详细信息请前往: <a href="https://github.com/peaceiris/actions-gh-pages">https://github.com/peaceiris/actions-gh-pages</a></p>
<h2 id="5-将代码推送至仓库"><a aria-hidden="true" tabindex="-1" href="#5-将代码推送至仓库"><span class="icon icon-link"></span></a>5. 将代码推送至仓库</h2>
<pre><code class="language-ssh">rm -rf .git
git add .
git commit -m "init"
git branch -M main
git remote add origin git@github.com:LZS911/LZS911.github.io.git //注意改成在第一步创建的仓库
git push -u origin main
</code></pre>
<h2 id="6-修改仓库设置"><a aria-hidden="true" tabindex="-1" href="#6-修改仓库设置"><span class="icon icon-link"></span></a>6. 修改仓库设置</h2>
<p>将 <code>Branch</code> 选项设置为 <code>gh-pages</code></p>
<p><img src="/assets/github-pages/example-2.png" alt="alt"></p>
<h2 id="7-等待-actions-成功"><a aria-hidden="true" tabindex="-1" href="#7-等待-actions-成功"><span class="icon icon-link"></span></a>7. 等待 Actions 成功</h2>
<p><img src="/assets/github-pages/example-3.png" alt="alt"></p>
<p>最后, 打开  <a href="https://lzs911.github.io/">https://lzs911.github.io/</a> 便可以访问到创建的 <code>Next</code> 项目. 后续更新只需要推送代码至 <code>main</code> 分支即可.</p></div></section></article></main><footer class="bg-neutral-50 border-t border-neutral-200 text-center text-xs opacity-50 py-4">© 2022,<!-- --> <a rel="noopener noreferrer" class="hover:underline hover:bg-indigo" href="https://github.com/LZS911" target="_blank">LZS_911</a>, build with<!-- --> <a rel="noopener noreferrer" class="underline hover:bg-indigo" href="https://nextjs.org/" target="_blank">Next.js</a> <!-- -->and<!-- --> <a rel="noopener noreferrer" class="underline hover:bg-indigo" href="https://pages.github.com/?(null)" target="_blank">GitHub Pages</a></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"如何将 Next.js 项目部署至Github Pages","date":"2022-12-06","slug":"如何将 Next.js 项目部署至Github Pages","author":"Ai.Haibara","content":"\u003ch2 id=\"1-创建-github-仓库\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#1-创建-github-仓库\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003e1. 创建 Github 仓库\u003c/h2\u003e\n\u003cp\u003e新建仓库名称约束: \u003ccode\u003eusername.github.io\u003c/code\u003e, 其中 \u003ccode\u003eusername\u003c/code\u003e 为 \u003ccode\u003eGithub\u003c/code\u003e 上的用户名(或组织名称).\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/github-pages/example-1.png\" alt=\"alt\"\u003e\u003c/p\u003e\n\u003ch2 id=\"2-创建-nextjs-项目\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#2-创建-nextjs-项目\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003e2. 创建 Next.js 项目\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"language-ssh\"\u003enpx create-next-app@latest --typescript\n# or\nyarn create next-app --typescript\n# or\npnpm create next-app --typescript\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"3-打开-packagejson-并添加脚本\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#3-打开-packagejson-并添加脚本\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003e3. 打开 package.json 并添加脚本\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"language-json\"\u003e \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\",\n    \"lint\": \"next lint\",\n    \"export\": \"next export\" //add\n    \"\"\n  },\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"4-添加-github-actions\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#4-添加-github-actions\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003e4. 添加 github Actions\u003c/h2\u003e\n\u003cp\u003e关于 \u003ccode\u003eGitHub Pages\u003c/code\u003e 站点的发布源: \u003ca href=\"https://docs.github.com/cn/pages/getting-started-with-github-pages/configuring-a-publishing-source-for-your-github-pages-site\"\u003ehttps://docs.github.com/cn/pages/getting-started-with-github-pages/configuring-a-publishing-source-for-your-github-pages-site\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e鉴于 \u003ccode\u003eNext.js\u003c/code\u003e 的源码文件格式并不能直接作为发布源, 我们需要对项目进行打包处理, 同时也可以做一些代码 \u003ccode\u003echeck\u003c/code\u003e, 所以我们需要添加 \u003ccode\u003egithub Actions\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003e添加文件: \u003ccode\u003e.github/workflows/gh-pages.yml\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-yml\"\u003ename: GitHub Pages\n\non:\n  push:\n    branches:\n      - main\n  pull_request:\n\njobs:\n  deploy:\n    runs-on: ubuntu-22.04\n    permissions:\n      contents: write\n    concurrency:\n      group: ${{ github.workflow }}-${{ github.ref }}\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Setup Node\n        uses: actions/setup-node@v3\n        with:\n          node-version: \"14\"\n\n      - name: Get yarn cache\n        id: yarn-cache\n        run: echo \"::set-output name=dir::$(yarn cache dir)\"\n\n      - name: Cache dependencies\n        uses: actions/cache@v2\n        with:\n          path: ${{ steps.yarn-cache.outputs.dir }}\n          key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}\n          restore-keys: |\n            ${{ runner.os }}-yarn-\n\n      - run: yarn install --frozen-lockfile\n      - run: yarn lint\n      - run: yarn build\n      - run: yarn export\n\n      - name: Deploy\n        uses: peaceiris/actions-gh-pages@v3\n        if: ${{ github.ref == 'refs/heads/main' }}\n        with:\n          github_token: ${{ secrets.GITHUB_TOKEN }}\n          publish_dir: ./out\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e了解更多详细信息请前往: \u003ca href=\"https://github.com/peaceiris/actions-gh-pages\"\u003ehttps://github.com/peaceiris/actions-gh-pages\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"5-将代码推送至仓库\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#5-将代码推送至仓库\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003e5. 将代码推送至仓库\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"language-ssh\"\u003erm -rf .git\ngit add .\ngit commit -m \"init\"\ngit branch -M main\ngit remote add origin git@github.com:LZS911/LZS911.github.io.git //注意改成在第一步创建的仓库\ngit push -u origin main\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"6-修改仓库设置\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#6-修改仓库设置\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003e6. 修改仓库设置\u003c/h2\u003e\n\u003cp\u003e将 \u003ccode\u003eBranch\u003c/code\u003e 选项设置为 \u003ccode\u003egh-pages\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/github-pages/example-2.png\" alt=\"alt\"\u003e\u003c/p\u003e\n\u003ch2 id=\"7-等待-actions-成功\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#7-等待-actions-成功\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003e7. 等待 Actions 成功\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"/assets/github-pages/example-3.png\" alt=\"alt\"\u003e\u003c/p\u003e\n\u003cp\u003e最后, 打开  \u003ca href=\"https://lzs911.github.io/\"\u003ehttps://lzs911.github.io/\u003c/a\u003e 便可以访问到创建的 \u003ccode\u003eNext\u003c/code\u003e 项目. 后续更新只需要推送代码至 \u003ccode\u003emain\u003c/code\u003e 分支即可.\u003c/p\u003e","theme":"fancy","tag":[null]}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"如何将 Next.js 项目部署至Github Pages"},"buildId":"qBu5lBFKXaCDYaF8pFjY5","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>