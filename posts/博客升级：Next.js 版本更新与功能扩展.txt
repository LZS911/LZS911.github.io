1:"$Sreact.fragment"
2:I[7555,[],""]
3:I[1901,["874","static/chunks/874-16716eedeadde879.js","39","static/chunks/app/error-d036ecfd03716e30.js"],"default"]
4:I[1295,[],""]
5:I[9543,["874","static/chunks/874-16716eedeadde879.js","345","static/chunks/app/not-found-2113bbd7a2f55e8f.js"],"default"]
8:I[9665,[],"MetadataBoundary"]
a:I[9665,[],"OutletBoundary"]
d:I[4911,[],"AsyncMetadataOutlet"]
f:I[8460,["209","static/chunks/app/loading-b73dd9bd22c3caa2.js"],"default"]
10:I[9665,[],"ViewportBoundary"]
12:I[6614,[],""]
:HL["/_next/static/media/569ce4b8f30dc480-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/media/93f479601ee12b01-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/css/8aef079a875c7130.css","style"]
0:{"P":null,"b":"ABcqSmLsDzXDgCnQFQi-5","p":"","c":["","posts","%E5%8D%9A%E5%AE%A2%E5%8D%87%E7%BA%A7%EF%BC%9ANext.js%20%E7%89%88%E6%9C%AC%E6%9B%B4%E6%96%B0%E4%B8%8E%E5%8A%9F%E8%83%BD%E6%89%A9%E5%B1%95"],"i":false,"f":[[["",{"children":["(article)",{"children":["posts",{"children":[["slug","%E5%8D%9A%E5%AE%A2%E5%8D%87%E7%BA%A7%EF%BC%9ANext.js%20%E7%89%88%E6%9C%AC%E6%9B%B4%E6%96%B0%E4%B8%8E%E5%8A%9F%E8%83%BD%E6%89%A9%E5%B1%95","d"],{"children":["__PAGE__",{}]}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/8aef079a875c7130.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","children":["$","body",null,{"className":"__variable_5cfdac __variable_9a8899 antialiased","children":["$","$L2",null,{"parallelRouterKey":"children","error":"$3","errorStyles":[],"errorScripts":[],"template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","$L5",null,{}],[]],"forbidden":"$undefined","unauthorized":"$undefined"}]}]}]]}],{"children":["(article)",["$","$1","c",{"children":[null,"$L6"]}],{"children":["posts",["$","$1","c",{"children":[null,["$","$L2",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":[["slug","%E5%8D%9A%E5%AE%A2%E5%8D%87%E7%BA%A7%EF%BC%9ANext.js%20%E7%89%88%E6%9C%AC%E6%9B%B4%E6%96%B0%E4%B8%8E%E5%8A%9F%E8%83%BD%E6%89%A9%E5%B1%95","d"],["$","$1","c",{"children":[null,["$","$L2",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":["$L7",["$","$L8",null,{"children":"$L9"}],null,["$","$La",null,{"children":["$Lb","$Lc",["$","$Ld",null,{"promise":"$@e"}]]}]]}],{},null,false]},null,false]},null,false]},null,false]},[["$","$Lf","l",{}],[],[]],false],["$","$1","h",{"children":[null,["$","$1","R8YvRW2Ibr3cyzZxZahnw",{"children":[["$","$L10",null,{"children":"$L11"}],["$","meta",null,{"name":"next-size-adjust","content":""}]]}],null]}],false]],"m":"$undefined","G":["$12","$undefined"],"s":false,"S":true}
13:I[8565,["874","static/chunks/874-16716eedeadde879.js","766","static/chunks/766-eeb113df4f56c105.js","651","static/chunks/app/(article)/layout-18bcffe355ed9a9b.js"],"default"]
14:"$Sreact.suspense"
15:I[4911,[],"AsyncMetadata"]
6:["$","html",null,{"lang":"en","children":["$","body",null,{"className":"__variable_5cfdac __variable_9a8899 antialiased","children":[["$","div",null,{"className":"min-h-screen","children":[["$","$L13",null,{}],["$","main",null,{"className":"p-6 flex justify-center","children":["$","$L2",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]}],["$","footer",null,{"className":"bg-neutral-50 border-t border-neutral-200 text-center text-xs opacity-50 py-4","children":["Â© 2022 - ",2025,["$","a",null,{"rel":"noopener noreferrer","className":"hover:underline hover:bg-indigo","href":"https://github.com/LZS911","target":"_blank","children":", LZS_911"}],", build with"," ",["$","a",null,{"rel":"noopener noreferrer","className":"underline hover:bg-indigo","href":"https://nextjs.org/","target":"_blank","children":"Next.js"}]," ","and"," ",["$","a",null,{"rel":"noopener noreferrer","className":"underline hover:bg-indigo","href":"https://pages.github.com/?(null)","target":"_blank","children":"GitHub Pages"}]]}]]}],false]}]}]
9:["$","$14",null,{"fallback":null,"children":["$","$L15",null,{"promise":"$@16"}]}]
c:null
17:I[5099,["766","static/chunks/766-eeb113df4f56c105.js","62","static/chunks/62-36d7af331e30e687.js","520","static/chunks/app/(article)/posts/%5Bslug%5D/page-2ec56518ac6621da.js"],"ThemeLoader"]
18:T751d,<h2 id="å¼•è¨€"><a aria-hidden="true" tabindex="-1" href="#å¼•è¨€"><span class="icon icon-link"></span></a>å¼•è¨€</h2>
<h3 id="ä¸ºä»€ä¹ˆé€‰æ‹©å‡çº§"><a aria-hidden="true" tabindex="-1" href="#ä¸ºä»€ä¹ˆé€‰æ‹©å‡çº§"><span class="icon icon-link"></span></a>ä¸ºä»€ä¹ˆé€‰æ‹©å‡çº§ï¼Ÿ</h3>
<h4 id="åšå®¢æ—§ç‰ˆæœ¬çš„ç—›ç‚¹"><a aria-hidden="true" tabindex="-1" href="#åšå®¢æ—§ç‰ˆæœ¬çš„ç—›ç‚¹"><span class="icon icon-link"></span></a>åšå®¢æ—§ç‰ˆæœ¬çš„ç—›ç‚¹</h4>
<ol>
<li>åŠŸèƒ½å•ä¸€æ€§ï¼šçº¯é™æ€HTML+CSSæ„å»ºï¼Œä¾èµ–æ‰‹åŠ¨æ›´æ–°Markdownæ–‡ä»¶ï¼Œç¼ºä¹åŠ¨æ€äº¤äº’èƒ½åŠ›</li>
<li>éƒ¨ç½²é™åˆ¶ï¼šGitHub Pagesä»…æ”¯æŒé™æ€èµ„æºï¼Œæ— æ³•å®ç°æœåŠ¡ç«¯é€»è¾‘ï¼ˆå¦‚APIè·¯ç”±ã€èº«ä»½éªŒè¯ï¼‰</li>
</ol>
<h4 id="nextjs-æ–°ç‰ˆæœ¬çš„æ ¸å¿ƒå¸å¼•åŠ›"><a aria-hidden="true" tabindex="-1" href="#nextjs-æ–°ç‰ˆæœ¬çš„æ ¸å¿ƒå¸å¼•åŠ›"><span class="icon icon-link"></span></a>Next.js æ–°ç‰ˆæœ¬çš„æ ¸å¿ƒå¸å¼•åŠ›</h4>
<ol>
<li>App Routerï¼šåŸºäºæ–‡ä»¶ç³»ç»Ÿçš„å¸ƒå±€åµŒå¥—ã€æµå¼æ¸²æŸ“å’Œç®€åŒ–çš„æ•°æ®è·å–</li>
<li>æ··åˆæ¸²æŸ“æ¨¡å¼ï¼šæ”¯æŒSSG/SSR/ISRè‡ªç”±ç»„åˆï¼Œè§£å†³é™æ€åšå®¢çš„åŠ¨æ€éœ€æ±‚</li>
</ol>
<h4 id="ä¸ªäººå­¦ä¹ åŠ¨æœº"><a aria-hidden="true" tabindex="-1" href="#ä¸ªäººå­¦ä¹ åŠ¨æœº"><span class="icon icon-link"></span></a>ä¸ªäººå­¦ä¹ åŠ¨æœº</h4>
<blockquote>
<p>è¿™æ¬¡å‡çº§æºäºæˆ‘å¯¹ç°ä»£Webå¼€å‘æŠ€æœ¯æ ˆçš„æ·±åº¦æ¢ç´¢éœ€æ±‚ï¼Œå°¤å…¶æ˜¯ä»¥ä¸‹ä¸¤ä¸ªæ ¸å¿ƒç›®æ ‡ï¼š</p>
</blockquote>
<ol>
<li>
<p>æŒæ¡Vercelçš„å…¨æ ˆå¼€å‘èƒ½åŠ›</p>
<ul>
<li>
<p>æ·±å…¥å¹³å°ç‰¹æ€§ï¼š</p>
<ol>
<li>å­¦ä¹ Vercelçš„Serverless Functionå†·å¯åŠ¨ä¼˜åŒ–æ–¹æ¡ˆ</li>
<li>å®è·µEdge Networkçš„å…¨çƒä½å»¶è¿Ÿéƒ¨ç½²</li>
<li>æ¢ç´¢Vercel Analyticsä¸Speed Insightsçš„å®æ—¶æ€§èƒ½ç›‘æ§é›†æˆ</li>
</ol>
</li>
<li>
<p>å·¥ä½œæµé©æ–°ï¼š</p>
<ol>
<li>å®ç°GitHubä»£ç æäº¤ â†’ Vercelè‡ªåŠ¨é¢„è§ˆéƒ¨ç½² â†’ ç”Ÿäº§ç¯å¢ƒç°åº¦å‘å¸ƒçš„å®Œæ•´CI/CDæµæ°´çº¿</li>
<li>å°è¯•Vercel Storageï¼ˆå¦‚Postgres/KVï¼‰æ›¿ä»£ä¼ ç»Ÿè‡ªå»ºæ•°æ®åº“</li>
</ol>
</li>
</ul>
</li>
<li>
<p>æ„å»ºå®Œæ•´çš„å…¨æ ˆæŠ€æœ¯é—­ç¯</p>
<ul>
<li>
<p>å‰ç«¯æ·±åº¦å®è·µï¼š</p>
<ol>
<li>ä»"é™æ€é¡µé¢æ¸²æŸ“"å‡çº§åˆ°"æŒ‰éœ€åŠ¨æ€æ¸²æŸ“"ï¼ˆå¦‚åšå®¢ç¼–è¾‘é¡µçš„æƒé™æ•æ„Ÿè·¯ç”±ï¼‰</li>
<li>ä½“éªŒReact Server Componentsçš„æ•°æ®è·å–æ¨¡å¼ä¸ä¼ ç»ŸCSRçš„å·®å¼‚</li>
</ol>
</li>
<li>
<p>åç«¯èƒ½åŠ›å¼ºåŒ–ï¼š</p>
<ol>
<li>é€šè¿‡Next.js APIè·¯ç”±å®ç°GitHub OAuthç™»å½•+Discussions APIä»£ç†</li>
<li>å¼€å‘æ— çŠ¶æ€æœåŠ¡ï¼šJWTéªŒè¯ä¸­é—´ä»¶ + æœåŠ¡ç«¯ç¼“å­˜ç­–ç•¥ï¼ˆå¦‚redis+stale-while-revalidateï¼‰</li>
</ol>
</li>
<li>
<p>æ¶æ„æ€ç»´åŸ¹å…»ï¼š</p>
<ol>
<li>åœ¨é™æ€å¯¼å‡ºï¼ˆGitHub Pagesï¼‰ä¸å…¨åŠ¨æ€ï¼ˆVercelï¼‰ä¹‹é—´è®¾è®¡å…¼å®¹æ–¹æ¡ˆ</li>
</ol>
</li>
</ul>
</li>
</ol>
<blockquote>
<p>é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘å¸Œæœ›å»ºç«‹èµ·ä»ä»£ç ç¼–å†™åˆ°äº‘ç«¯éƒ¨ç½²çš„å®Œæ•´æŠ€æœ¯è®¤çŸ¥ï¼Œæœ€ç»ˆå½¢æˆå¯å¤ç”¨çš„å…¨æ ˆå¼€å‘æ–¹æ³•è®ºã€‚</p>
</blockquote>
<h2 id="nextjs-å‡çº§å®æˆ˜"><a aria-hidden="true" tabindex="-1" href="#nextjs-å‡çº§å®æˆ˜"><span class="icon icon-link"></span></a>Next.js å‡çº§å®æˆ˜</h2>
<h3 id="ç‰ˆæœ¬è¿ç§»å…³é”®æ­¥éª¤"><a aria-hidden="true" tabindex="-1" href="#ç‰ˆæœ¬è¿ç§»å…³é”®æ­¥éª¤"><span class="icon icon-link"></span></a>ç‰ˆæœ¬è¿ç§»å…³é”®æ­¥éª¤</h3>
<h4 id="ä»-page-router-åˆ°-app-router-çš„è¿‡æ¸¡"><a aria-hidden="true" tabindex="-1" href="#ä»-page-router-åˆ°-app-router-çš„è¿‡æ¸¡"><span class="icon icon-link"></span></a>ä» <code>page router</code> åˆ° <code>app router</code> çš„è¿‡æ¸¡</h4>
<ol>
<li>
<p>è·¯ç”±ç»“æ„æ”¹é€ ï¼š</p>
<pre><code class="hljs language-md">/pages/posts/[slug].tsx â†’ /app/posts/[slug]/page.tsx
</code></pre>
</li>
<li>
<p>æ•°æ®è·å–è¿ç§»ï¼š</p>
<ul>
<li>åŸ<code>getStaticProps</code> â†’ æ”¹ç”¨<code>fetch + generateStaticParams</code></li>
<li>åŸ<code>getServerSideProps</code> â†’ æ”¹ç”¨æœåŠ¡ç«¯ç»„ä»¶ç›´æ¥å¼‚æ­¥åŠ è½½</li>
</ul>
</li>
</ol>
<h3 id="é™æ€éƒ¨ç½²ä¸æœåŠ¡éƒ¨ç½²çš„å†²çªä»¥åŠè§£å†³æ–¹æ¡ˆ"><a aria-hidden="true" tabindex="-1" href="#é™æ€éƒ¨ç½²ä¸æœåŠ¡éƒ¨ç½²çš„å†²çªä»¥åŠè§£å†³æ–¹æ¡ˆ"><span class="icon icon-link"></span></a>é™æ€éƒ¨ç½²ä¸æœåŠ¡éƒ¨ç½²çš„å†²çªä»¥åŠè§£å†³æ–¹æ¡ˆ</h3>
<h4 id="github-pages-éƒ¨ç½²é™åˆ¶"><a aria-hidden="true" tabindex="-1" href="#github-pages-éƒ¨ç½²é™åˆ¶"><span class="icon icon-link"></span></a>GitHub Pages éƒ¨ç½²é™åˆ¶</h4>
<p>ä»…æ”¯æŒçº¯é™æ€å¯¼å‡º <code>output: 'export'</code>ï¼Œæ— æ³•ä½¿ç”¨APIè·¯ç”±ä»¥åŠå„ç§ä¸­é—´ä»¶</p>
<h4 id="vercel-éƒ¨ç½²ä¼˜åŠ¿"><a aria-hidden="true" tabindex="-1" href="#vercel-éƒ¨ç½²ä¼˜åŠ¿"><span class="icon icon-link"></span></a>Vercel éƒ¨ç½²ä¼˜åŠ¿</h4>
<p>åŸç”Ÿæ”¯æŒServerless Functionsã€Edge Networkã€ISR</p>
<h4 id="è§£å†³æ–¹æ¡ˆ"><a aria-hidden="true" tabindex="-1" href="#è§£å†³æ–¹æ¡ˆ"><span class="icon icon-link"></span></a>è§£å†³æ–¹æ¡ˆ</h4>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">NextConfig</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'next'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-attr">nextConfig</span>: <span class="hljs-title class_">NextConfig</span> = {
 <span class="hljs-comment">/**
 * next configs
 */</span>
};

<span class="hljs-keyword">if</span> (process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">'production'</span>) {
  <span class="hljs-keyword">if</span> (process.<span class="hljs-property">env</span>.<span class="hljs-property">GITHUB_ACTION</span>) {
    nextConfig.<span class="hljs-property">pageExtensions</span> = [<span class="hljs-string">'jsx'</span>, <span class="hljs-string">'tsx'</span>];
    nextConfig.<span class="hljs-property">output</span> = <span class="hljs-string">'export'</span>;
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> nextConfig;

</code></pre>
<h3 id="nextjs-æŠ€æœ¯ç‚¹é—ç•™é—®é¢˜"><a aria-hidden="true" tabindex="-1" href="#nextjs-æŠ€æœ¯ç‚¹é—ç•™é—®é¢˜"><span class="icon icon-link"></span></a>Next.js æŠ€æœ¯ç‚¹é—ç•™é—®é¢˜</h3>
<ol>
<li>ISR</li>
<li>æœåŠ¡ç«¯ç»„ä»¶ä¸å®¢æˆ·ç«¯ç»„ä»¶çš„è¾¹ç•Œåˆ’åˆ†</li>
<li>Next.js API æœ€ä½³å®è·µ</li>
</ol>
<h2 id="æ–°å¢åŠŸèƒ½è¯¦è§£"><a aria-hidden="true" tabindex="-1" href="#æ–°å¢åŠŸèƒ½è¯¦è§£"><span class="icon icon-link"></span></a>æ–°å¢åŠŸèƒ½è¯¦è§£</h2>
<h3 id="åŸºäº-github-discussions-çš„è¯„è®ºç³»ç»Ÿ"><a aria-hidden="true" tabindex="-1" href="#åŸºäº-github-discussions-çš„è¯„è®ºç³»ç»Ÿ"><span class="icon icon-link"></span></a>åŸºäº github Discussions çš„è¯„è®ºç³»ç»Ÿ</h3>
<ol>
<li>
<p>åŠŸèƒ½æ¦‚è¿°</p>
<ul>
<li>åˆ©ç”¨ GitHub Discussions API å®ç°åšå®¢è¯„è®ºåŠŸèƒ½</li>
<li>ç”¨æˆ·é€šè¿‡ GitHub OAuth ç™»å½•ï¼Œç¡®ä¿è¯„è®ºå¯è¿½æº¯</li>
<li>æ”¯æŒ è¯»å–/å‘å¸ƒ/å›å¤è¯„è®ºï¼Œæ•°æ®å­˜å‚¨åœ¨GitHubä»“åº“çš„Discussionsæ¿å—</li>
</ul>
</li>
<li>
<p>æŠ€æœ¯å®ç°
(1) GitHub API æ¥å…¥
ğŸ”¹ æ•°æ®è¯»å–ï¼ˆGETï¼‰</p>
</li>
</ol>
<p>ä½¿ç”¨ fetch è°ƒç”¨GitHub GraphQL API è·å–æŒ‡å®šDiscussionçš„è¯„è®º</p>
<pre><code class="hljs language-typescript"><span class="hljs-comment">/**
 * æ ¹æ®æ–‡ç«  slug è·å–å¯¹åº”çš„ Discussion
 * <span class="hljs-doctag">@param</span> slug æ–‡ç« çš„ slug
 * <span class="hljs-doctag">@param</span> title æ–‡ç« æ ‡é¢˜
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getDiscussionBySlug</span>(<span class="hljs-params">
  <span class="hljs-attr">slug</span>: <span class="hljs-built_in">string</span>
</span>): <span class="hljs-title class_">Promise</span>&#x3C;<span class="hljs-title class_">DiscussionInfo</span> | <span class="hljs-literal">null</span>> {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// æ„å»ºGraphQLæŸ¥è¯¢ï¼ŒæŸ¥æ‰¾æ˜¯å¦å·²å­˜åœ¨å¯¹åº”slugçš„discussionï¼ŒåªæŸ¥æ‰¾opençŠ¶æ€çš„</span>
    <span class="hljs-keyword">const</span> findQuery = <span class="hljs-string">`
      query {
        repository(owner: "<span class="hljs-subst">${REPO_OWNER}</span>", name: "<span class="hljs-subst">${REPO_NAME}</span>") {
          discussions(first: 100, states: OPEN) {
            nodes {
              id
              number
              title
            }
          }
        }
      }
    `</span>;
    <span class="hljs-comment">// æ‰§è¡ŒæŸ¥è¯¢</span>
    <span class="hljs-keyword">const</span> findResponse = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://api.github.com/graphql'</span>, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
      <span class="hljs-attr">headers</span>: {
        <span class="hljs-title class_">Authorization</span>: <span class="hljs-string">`bearer <span class="hljs-subst">${GITHUB_TOKEN || <span class="hljs-string">''</span>}</span>`</span>,
        <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
      },
      <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">query</span>: findQuery })
    });

    <span class="hljs-keyword">const</span> findData = <span class="hljs-keyword">await</span> findResponse.<span class="hljs-title function_">json</span>();
    <span class="hljs-keyword">const</span> discussions = findData?.<span class="hljs-property">data</span>?.<span class="hljs-property">repository</span>?.<span class="hljs-property">discussions</span>?.<span class="hljs-property">nodes</span> || [];

    <span class="hljs-comment">// æŸ¥æ‰¾æ ‡é¢˜åŒ…å«slugçš„discussion</span>
    <span class="hljs-keyword">const</span> existingDiscussion = discussions.<span class="hljs-title function_">find</span>(
      <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">d</span>: <span class="hljs-built_in">any</span></span>) =></span> d.<span class="hljs-property">title</span> === <span class="hljs-title function_">generateDiscussionInfoTitle</span>(slug)
    );
    <span class="hljs-keyword">if</span> (existingDiscussion) {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">id</span>: existingDiscussion.<span class="hljs-property">id</span>,
        <span class="hljs-attr">number</span>: existingDiscussion.<span class="hljs-property">number</span>
      };
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è·å–æˆ–åˆ›å»ºè®¨è®ºå¼‚å¸¸:'</span>, error);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }
}

<span class="hljs-comment">/**
 * è·å– Discussion çš„è¯„è®º
 * <span class="hljs-doctag">@param</span> discussionId Discussion çš„ ID
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getCommentsByDiscussionId</span>(<span class="hljs-params"><span class="hljs-attr">discussionId</span>: <span class="hljs-built_in">string</span></span>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> query = <span class="hljs-string">`
      query {
        node(id: "<span class="hljs-subst">${discussionId}</span>") {
          ... on Discussion {
            comments(first: 100) {
              nodes {
                id
                author {
                  login
                  avatarUrl
                  url
                }
                body
                bodyHTML
                createdAt
                replyToId: replyTo {
                  id
                }
                replies(first: 100) {
                  nodes {
                    id
                    author {
                      login
                      avatarUrl
                      url
                    }
                    body
                    bodyHTML
                    createdAt
                  }
                }
              }
            }
          }
        }
      }
    `</span>;

    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://api.github.com/graphql'</span>, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
      <span class="hljs-attr">headers</span>: {
        <span class="hljs-title class_">Authorization</span>: <span class="hljs-string">`bearer <span class="hljs-subst">${GITHUB_TOKEN || <span class="hljs-string">''</span>}</span>`</span>,
        <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
      },
      <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ query })
    });

    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
    <span class="hljs-keyword">const</span> comments = data?.<span class="hljs-property">data</span>?.<span class="hljs-property">node</span>?.<span class="hljs-property">comments</span>?.<span class="hljs-property">nodes</span> || [];
    <span class="hljs-keyword">return</span> comments.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">comment</span>: <span class="hljs-built_in">any</span></span>) =></span> ({
      <span class="hljs-attr">id</span>: comment.<span class="hljs-property">id</span>,
      <span class="hljs-attr">author</span>: {
        <span class="hljs-attr">login</span>: comment.<span class="hljs-property">author</span>?.<span class="hljs-property">login</span> || <span class="hljs-string">'åŒ¿åç”¨æˆ·'</span>,
        <span class="hljs-attr">avatarUrl</span>: comment.<span class="hljs-property">author</span>?.<span class="hljs-property">avatarUrl</span>,
        <span class="hljs-attr">url</span>: comment.<span class="hljs-property">author</span>?.<span class="hljs-property">url</span>
      },
      <span class="hljs-attr">content</span>: comment.<span class="hljs-property">body</span>,
      <span class="hljs-attr">bodyHTML</span>: comment.<span class="hljs-property">bodyHTML</span>,
      <span class="hljs-attr">createdAt</span>: comment.<span class="hljs-property">createdAt</span>,
      <span class="hljs-attr">replyToId</span>: comment.<span class="hljs-property">replyToId</span>?.<span class="hljs-property">id</span>,
      <span class="hljs-attr">replies</span>: comment.<span class="hljs-property">replies</span>?.<span class="hljs-property">nodes</span>?.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">reply</span>: <span class="hljs-built_in">any</span></span>) =></span> ({
        <span class="hljs-attr">id</span>: reply.<span class="hljs-property">id</span>,
        <span class="hljs-attr">author</span>: {
          <span class="hljs-attr">login</span>: reply.<span class="hljs-property">author</span>?.<span class="hljs-property">login</span> || <span class="hljs-string">'åŒ¿åç”¨æˆ·'</span>,
          <span class="hljs-attr">avatarUrl</span>: reply.<span class="hljs-property">author</span>?.<span class="hljs-property">avatarUrl</span>,
          <span class="hljs-attr">url</span>: reply.<span class="hljs-property">author</span>?.<span class="hljs-property">url</span>
        },
        <span class="hljs-attr">content</span>: reply.<span class="hljs-property">body</span>,
        <span class="hljs-attr">bodyHTML</span>: reply.<span class="hljs-property">bodyHTML</span>,
        <span class="hljs-attr">createdAt</span>: reply.<span class="hljs-property">createdAt</span>
      })),
      <span class="hljs-attr">reactions</span>:
        comment.<span class="hljs-property">reactionGroups</span>?.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">group</span>: <span class="hljs-built_in">any</span></span>) =></span> ({
          <span class="hljs-attr">type</span>: group.<span class="hljs-property">content</span>,
          <span class="hljs-attr">count</span>: group.<span class="hljs-property">users</span>.<span class="hljs-property">totalCount</span>
        })) || []
    }));
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è·å–è¯„è®ºå¼‚å¸¸:'</span>, error);
    <span class="hljs-keyword">return</span> [];
  }
}

</code></pre>
<p>ğŸ”¹ è¯„è®ºå‘å¸ƒï¼ˆPOSTï¼‰</p>
<p>ç”¨æˆ·æäº¤è¯„è®ºåï¼Œè°ƒç”¨APIåˆ›å»ºDiscussionæˆ–å›å¤</p>
<p>éœ€è¦ GitHub Token æˆæƒï¼ˆé€šè¿‡OAuthè·å–ï¼‰</p>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createDiscussionBySlug</span>(<span class="hljs-params">
  <span class="hljs-attr">slug</span>: <span class="hljs-built_in">string</span>
</span>): <span class="hljs-title class_">Promise</span>&#x3C;<span class="hljs-title class_">DiscussionInfo</span> | <span class="hljs-literal">null</span>> {
  <span class="hljs-comment">// å¦‚æœä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°çš„discussion</span>
  <span class="hljs-comment">// é¦–å…ˆè·å–è®¨è®ºåˆ†ç±»ID</span>
  <span class="hljs-keyword">const</span> categoryQuery = <span class="hljs-string">`
      query {
        repository(owner: "<span class="hljs-subst">${REPO_OWNER}</span>", name: "<span class="hljs-subst">${REPO_NAME}</span>") {
          discussionCategories(first: 10) {
            nodes {
              id
              name
            }
          }
        }
      }
    `</span>;

  <span class="hljs-keyword">const</span> categoryResponse = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://api.github.com/graphql'</span>, {
    <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
    <span class="hljs-attr">headers</span>: {
      <span class="hljs-title class_">Authorization</span>: <span class="hljs-string">`bearer <span class="hljs-subst">${GITHUB_TOKEN || <span class="hljs-string">''</span>}</span>`</span>,
      <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
    },
    <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">query</span>: categoryQuery })
  });

  <span class="hljs-keyword">const</span> categoryData = <span class="hljs-keyword">await</span> categoryResponse.<span class="hljs-title function_">json</span>();
  <span class="hljs-keyword">const</span> categories =
    categoryData?.<span class="hljs-property">data</span>?.<span class="hljs-property">repository</span>?.<span class="hljs-property">discussionCategories</span>?.<span class="hljs-property">nodes</span> || [];

  <span class="hljs-comment">// ä½¿ç”¨ç¬¬ä¸€ä¸ªåˆ†ç±»ï¼Œæˆ–è€…ç‰¹å®šåç§°çš„åˆ†ç±»</span>
  <span class="hljs-keyword">const</span> category = categories[<span class="hljs-number">0</span>];

  <span class="hljs-keyword">if</span> (!category) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ— æ³•è·å–è®¨è®ºåˆ†ç±»'</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }

  <span class="hljs-comment">// è·å–ä»“åº“ID</span>
  <span class="hljs-keyword">const</span> repoIdQuery = <span class="hljs-string">`
      query {
        repository(owner: "<span class="hljs-subst">${REPO_OWNER}</span>", name: "<span class="hljs-subst">${REPO_NAME}</span>") {
          id
        }
      }
    `</span>;

  <span class="hljs-keyword">const</span> repoIdResponse = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://api.github.com/graphql'</span>, {
    <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
    <span class="hljs-attr">headers</span>: {
      <span class="hljs-title class_">Authorization</span>: <span class="hljs-string">`bearer <span class="hljs-subst">${GITHUB_TOKEN || <span class="hljs-string">''</span>}</span>`</span>,
      <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
    },
    <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">query</span>: repoIdQuery })
  });

  <span class="hljs-keyword">const</span> repoIdData = <span class="hljs-keyword">await</span> repoIdResponse.<span class="hljs-title function_">json</span>();
  <span class="hljs-keyword">const</span> repositoryId = repoIdData?.<span class="hljs-property">data</span>?.<span class="hljs-property">repository</span>?.<span class="hljs-property">id</span>;

  <span class="hljs-keyword">if</span> (!repositoryId) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ— æ³•è·å–ä»“åº“ID:'</span>, repoIdData?.<span class="hljs-property">errors</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }

  <span class="hljs-comment">// åˆ›å»ºæ–°çš„discussion</span>
  <span class="hljs-keyword">const</span> createQuery = <span class="hljs-string">`
      mutation {
        createDiscussion(input: {
          repositoryId: "<span class="hljs-subst">${repositoryId}</span>",
          categoryId: "<span class="hljs-subst">${category.id}</span>",
          body: "è¿™æ˜¯æ–‡ç«  <span class="hljs-subst">${slug}</span> çš„è¯„è®ºåŒº",
          title: "<span class="hljs-subst">${generateDiscussionInfoTitle(slug)}</span>"
        }) {
          discussion {
            id
            number
          }
        }
      }
    `</span>;

  <span class="hljs-keyword">const</span> createResponse = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://api.github.com/graphql'</span>, {
    <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
    <span class="hljs-attr">headers</span>: {
      <span class="hljs-title class_">Authorization</span>: <span class="hljs-string">`bearer <span class="hljs-subst">${GITHUB_TOKEN || <span class="hljs-string">''</span>}</span>`</span>,
      <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
    },
    <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">query</span>: createQuery })
  });

  <span class="hljs-keyword">const</span> createData = <span class="hljs-keyword">await</span> createResponse.<span class="hljs-title function_">json</span>();
  <span class="hljs-keyword">const</span> newDiscussion = createData?.<span class="hljs-property">data</span>?.<span class="hljs-property">createDiscussion</span>?.<span class="hljs-property">discussion</span>;

  <span class="hljs-keyword">if</span> (newDiscussion) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">id</span>: newDiscussion.<span class="hljs-property">id</span>,
      <span class="hljs-attr">number</span>: newDiscussion.<span class="hljs-property">number</span>
    };
  }

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åˆ›å»ºè®¨è®ºå¤±è´¥:'</span>, createData?.<span class="hljs-property">errors</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åˆ›å»ºè®¨è®ºè¯·æ±‚è¯¦æƒ…:'</span>, {
    repositoryId,
    <span class="hljs-attr">categoryId</span>: category.<span class="hljs-property">id</span>,
    <span class="hljs-attr">title</span>: <span class="hljs-title function_">generateDiscussionInfoTitle</span>(slug)
  });

  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}

<span class="hljs-comment">/**
 * æ·»åŠ è¯„è®ºåˆ° Discussion
 * <span class="hljs-doctag">@param</span> discussionId Discussion çš„ ID
 * <span class="hljs-doctag">@param</span> content è¯„è®ºå†…å®¹
 * <span class="hljs-doctag">@param</span> token ç”¨æˆ·çš„ GitHub è®¿é—®ä»¤ç‰Œ
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">addCommentByDiscussionId</span>(<span class="hljs-params">
  <span class="hljs-attr">discussionId</span>: <span class="hljs-built_in">string</span>,
  <span class="hljs-attr">content</span>: <span class="hljs-built_in">string</span>,
  <span class="hljs-attr">token</span>: <span class="hljs-built_in">string</span>,
  <span class="hljs-attr">replyToId</span>?: <span class="hljs-built_in">string</span>
</span>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> mutation = <span class="hljs-string">`
      mutation {
        addDiscussionComment(input: {
          discussionId: "<span class="hljs-subst">${discussionId}</span>",
          body: "<span class="hljs-subst">${content.replace(/<span class="hljs-string">"/g, '\\"</span><span class="hljs-string">')}"
          ${replyToId ? `, replyToId: "${replyToId}"` : '</span><span class="hljs-string">'}
        }) {
          comment {
            id
            author {
              login
              avatarUrl
              url
            }
            body
            createdAt
            replyTo {
              id
            }
          }
        }
      }
    `;

    const response = await fetch('</span>https://api.github.com/graphql<span class="hljs-string">', {
      method: '</span>POST<span class="hljs-string">',
      headers: {
        Authorization: `bearer ${token}`,
        '</span>Content-Type<span class="hljs-string">': '</span>application/json<span class="hljs-string">'
      },
      body: JSON.stringify({ query: mutation })
    });

    const data = await response.json();

    if (data.errors) {
      console.error('</span>æ·»åŠ è¯„è®ºé”™è¯¯:<span class="hljs-string">', data.errors);
      return null;
    }

    const comment = data?.data?.addDiscussionComment?.comment;

    if (comment) {
      return {
        id: comment.id,
        author: {
          login: comment.author?.login || '</span>åŒ¿åç”¨æˆ·<span class="hljs-string">',
          avatarUrl: comment.author?.avatarUrl,
          url: comment.author?.url
        },
        content: comment.body,
        createdAt: comment.createdAt,
        replyToId: comment.replyTo?.id
      };
    }

    return null;
  } catch (error) {
    console.error('</span>æ·»åŠ è¯„è®ºå¼‚å¸¸:<span class="hljs-string">', error);
    return null;
  }
}
</span></span></span></code></pre>
<h4 id="ç”¨æˆ·ç™»å½•ç³»ç»Ÿ"><a aria-hidden="true" tabindex="-1" href="#ç”¨æˆ·ç™»å½•ç³»ç»Ÿ"><span class="icon icon-link"></span></a>ç”¨æˆ·ç™»å½•ç³»ç»Ÿ</h4>
<p>æŠ€æœ¯æ ˆï¼šGitHub OAuth App + Cookie</p>
<h4 id="ä¼˜åŒ–ç‚¹"><a aria-hidden="true" tabindex="-1" href="#ä¼˜åŒ–ç‚¹"><span class="icon icon-link"></span></a>ä¼˜åŒ–ç‚¹</h4>
<ol>
<li>ä½¿ç”¨ NextAuth.js é›†æˆGitHub OAuth</li>
<li>ä½¿ç”¨ SWR ç¼“å­˜ç­–ç•¥ï¼Œè‡ªåŠ¨é‡æ–°è·å–æœ€æ–°è¯„è®º</li>
<li>æƒé™æ§åˆ¶ï¼šä»…å…è®¸æˆæƒç”¨æˆ·è¯„è®ºï¼ˆé¿å…Spamï¼‰</li>
<li>APIé™æµï¼šGitHub API æ¯åˆ†é’Ÿ5000æ¬¡è¯·æ±‚é™åˆ¶</li>
<li>æ•æ„Ÿè¯è¿‡æ»¤ï¼šæœåŠ¡ç«¯æ ¡éªŒè¯„è®ºå†…å®¹</li>
<li>GitHub Discussionsæ–¹æ¡ˆæ›¿ä»£</li>
</ol>
<h3 id="åœ¨çº¿æ–°å¢åšå®¢åŠŸèƒ½"><a aria-hidden="true" tabindex="-1" href="#åœ¨çº¿æ–°å¢åšå®¢åŠŸèƒ½"><span class="icon icon-link"></span></a>åœ¨çº¿æ–°å¢åšå®¢åŠŸèƒ½</h3>
<p>å®ç°é€»è¾‘ï¼š</p>
<ol>
<li>
<p>ç”¨æˆ·é€šè¿‡GitHubç™»å½•åï¼Œæ ¡éªŒç”¨æˆ·åæ˜¯å¦åœ¨ç™½åå•</p>
</li>
<li>
<p>ä½¿ç”¨GitHub API æäº¤ PR åˆ°é¡¹ç›®ä»“åº“</p>
</li>
<li>
<p>ä»£ç åˆå¹¶åé€šè¿‡è‡ªåŠ¨è¿›è¡Œé‡æ–°éƒ¨ç½²</p>
</li>
</ol>
<h2 id="æœªæ¥ä¼˜åŒ–æ–¹å‘"><a aria-hidden="true" tabindex="-1" href="#æœªæ¥ä¼˜åŒ–æ–¹å‘"><span class="icon icon-link"></span></a>æœªæ¥ä¼˜åŒ–æ–¹å‘</h2>
<h3 id="ç”¨æˆ·ä½“éªŒæå‡"><a aria-hidden="true" tabindex="-1" href="#ç”¨æˆ·ä½“éªŒæå‡"><span class="icon icon-link"></span></a>ç”¨æˆ·ä½“éªŒæå‡</h3>
<ol>
<li>
<p>æš—é»‘æ¨¡å¼ï¼šåŸºäº tailwindcss å®ŒæˆåŠ¨æ€ä¸»é¢˜åˆ‡æ¢</p>
</li>
<li>
<p>å…¨æ–‡æœç´¢ï¼šAlgoliaé›†æˆæˆ–æœ¬åœ°Fuse.jsæ–¹æ¡ˆå¯¹æ¯”</p>
</li>
<li>
<p>äº¤äº’å¢å¼ºï¼šTOCï¼ˆç›®å½•ï¼‰è‡ªåŠ¨ç”Ÿæˆä¸æ»šåŠ¨è¿½è¸ª</p>
</li>
</ol>
<h3 id="æŠ€æœ¯å¼ºåŒ–"><a aria-hidden="true" tabindex="-1" href="#æŠ€æœ¯å¼ºåŒ–"><span class="icon icon-link"></span></a>æŠ€æœ¯å¼ºåŒ–</h3>
<ol>
<li>
<p>å¢é‡é™æ€å†ç”Ÿï¼ˆISRï¼‰ï¼šåŠ¨æ€å†…å®¹æ›´æ–°ç­–ç•¥</p>
</li>
<li>
<p>Edge Runtimeï¼šå…³é”®APIçš„è¾¹ç¼˜åŒ–éƒ¨ç½²</p>
</li>
<li>
<p>æ€§èƒ½ç›‘æ§ï¼šæ¥å…¥Vercel Analyticsæˆ–è‡ªå®šä¹‰Lighthouseæ£€æŸ¥</p>
</li>
</ol>
<h3 id="å†…å®¹ç”Ÿæ€æ‰©å±•"><a aria-hidden="true" tabindex="-1" href="#å†…å®¹ç”Ÿæ€æ‰©å±•"><span class="icon icon-link"></span></a>å†…å®¹ç”Ÿæ€æ‰©å±•</h3>
<ol>
<li>MDXæ”¯æŒï¼šåœ¨åšæ–‡ä¸­åµŒå…¥Reactç»„ä»¶</li>
</ol>
<h2 id="ç»“è¯­"><a aria-hidden="true" tabindex="-1" href="#ç»“è¯­"><span class="icon icon-link"></span></a>ç»“è¯­</h2>
<p>è¿™æ¬¡å‡çº§ä¸ä»…æ˜¯æŠ€æœ¯çš„è¿­ä»£ï¼Œæ›´æ˜¯å¼€å‘æ€ç»´çš„è½¬å˜â€”â€”ä»é™æ€å†…å®¹å‘å¸ƒè€…åˆ°åŠ¨æ€åº”ç”¨è®¾è®¡è€…çš„è§’è‰²è¿›åŒ–ã€‚</p>7:["$","article",null,{"children":[["$","div",null,{"className":"flex justify-center font-[Arial] max-w-[864px] text-center","children":["$","h1",null,{"className":"text-[2.5rem] font-bold bg-lime-300 px-5 py-2 rounded-sm text-shadow-lg leading-[1.1]","children":"åšå®¢å‡çº§ï¼šNext.js ç‰ˆæœ¬æ›´æ–°ä¸åŠŸèƒ½æ‰©å±•"}]}],["$","time",null,{"dateTime":"2025-04-21","className":"text-center block my-4 text-sm opacity-60","children":"April\t21, 2025"}],[null,["$","$L17",null,{"theme":"fancy"}],["$","section",null,{"className":"markdown-body-fancy max-w-3xl","dangerouslySetInnerHTML":{"__html":"$18"}}]],null]}]
11:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
b:null
16:{"metadata":[["$","title","0",{"children":"Ai.Haibara codes"}],["$","meta","1",{"name":"description","content":"LZS Blog"}],["$","link","2",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"96x96"}]],"error":null,"digest":"$undefined"}
e:{"metadata":"$16:metadata","error":null,"digest":"$undefined"}
